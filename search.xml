<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Qtæ¥å®ç°MFCçš„OnIdleæ•ˆæœ</title>
      <link href="/2020/06/30/qt-on-idle/"/>
      <url>/2020/06/30/qt-on-idle/</url>
      
        <content type="html"><![CDATA[<h1 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h1><p>å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œå››å¹´ä»¥å‰ï¼Œæˆ‘è¿˜æ˜¯winä¸Šçš„å¼€å‘ï¼Œå‰ä¸œå®¶è‡ªå·±å®ç°äº†ä¸€å¥—ç•Œé¢åº“ï¼Œä½¿ç”¨äº†MFC + Win32API æ¥å®ç°çš„ã€‚ é‚£æ—¶å€™è¿˜æ²¡æœ‰æ¥è§¦è¿‡Qtï¼Œå°±åªèƒ½è‡ªå·±ç»´æŠ¤äº†ï¼Œå½“æ—¶æ˜¯çœ‹åˆ°äº†MFCçš„OnIdleå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯åˆ©ç”¨cpuçš„ç©ºä½™æ—¶é—´æ¥åšä¸€äº›äº‹å„¿ã€‚ç°åœ¨è½¬åˆ°Qtäº†ï¼Œè¿˜æ˜¯å¸Œæœ›æœ‰è¿™ä¸ªä¸œè¥¿ã€‚ç„¶åæœç´¢èµ„æ–™è¿˜æ˜¯å‘ç°ä¸€äº›ä¸œè¥¿çš„ã€‚</p><h1 id="å®ç°1"><a href="#å®ç°1" class="headerlink" title="å®ç°1"></a>å®ç°1</h1><p>æœ€ç®€å•çš„æ–¹å¼å½“ç„¶æ˜¯ç”¨ä¸€ä¸ªå®šæ—¶å™¨æ¥å®æ—¶åˆ·æ–°æŸä¸ªæŒ‰é’®çš„çŠ¶æ€äº†ã€‚è¿™æ˜¯å…¶ä¸­ä¸€ä¸ªæ–¹æ³•ã€‚è¿™é‡Œå°±ä¸å¤šè¯´äº†</p><h1 id="å®ç°2"><a href="#å®ç°2" class="headerlink" title="å®ç°2"></a>å®ç°2</h1><p>åˆšè½¬Qtçš„æ—¶å€™ï¼Œgoogleçš„æ—¶å€™å‘ç°stackoverflowä¸Šå·²ç»æœ‰äººå®ç°äº†ï¼Œè¿™é‡Œè´´ä¸Šå…·ä½“çš„æ–¹æ³•<br>è¿™ä¸¤ä¸ªå‡½æ•°åŸºæœ¬ä¸Šæ˜¯æœ€ç»ˆçš„å®ç°æ–¹æ³•äº†ã€‚ é¼ æ ‡åœ¨applcationä¸­ä¼šæœ‰å¯¹åº”çš„äº‹ä»¶å“åº”ã€‚å¯ä»¥è‡ªå·±çœ‹ä¸‹logï¼Œæˆ‘è¿™é‡Œè´´ä¸Šä»£ç </p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ui_mainwindow.h"</span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QAbstractEventDispatcher></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QDebug></span></span>MainWindow<span class="token operator">::</span><span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token operator">::</span>MainWindow<span class="token punctuation">)</span><span class="token punctuation">{</span> ui<span class="token operator">-</span><span class="token operator">></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> dispatcher <span class="token operator">=</span> QAbstractEventDispatcher<span class="token operator">::</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">connect</span><span class="token punctuation">(</span>dispatcher<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">connect</span><span class="token punctuation">(</span>dispatcher<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">aboutToBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">aboutToBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>MainWindow<span class="token operator">::</span><span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">delete</span> ui<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> MainWindow<span class="token operator">::</span><span class="token function">awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> lastAwake <span class="token operator">=</span> QTime<span class="token operator">::</span><span class="token function">currentTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Slept for "</span> <span class="token operator">&lt;&lt;</span> lastBlock<span class="token punctuation">.</span><span class="token function">msecsTo</span><span class="token punctuation">(</span>lastAwake<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" msec"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> MainWindow<span class="token operator">::</span><span class="token function">aboutToBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> lastBlock <span class="token operator">=</span> QTime<span class="token operator">::</span><span class="token function">currentTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Worked for "</span> <span class="token operator">&lt;&lt;</span> lastAwake<span class="token punctuation">.</span><span class="token function">msecsTo</span><span class="token punctuation">(</span>lastBlock<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" msec"</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QtæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu 20.04çš„é•œåƒ</title>
      <link href="/2020/06/29/ubuntu-20-04-de-jing-xiang/"/>
      <url>/2020/06/29/ubuntu-20-04-de-jing-xiang/</url>
      
        <content type="html"><![CDATA[<p><a href="https://mirror.bjtu.edu.cn/ubuntu-releases/20.04/" target="_blank" rel="noopener">https://mirror.bjtu.edu.cn/ubuntu-releases/20.04/</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹Qtå…³äºfctixè¾“å…¥æ³•çš„é—®é¢˜</title>
      <link href="/2020/06/29/linux-xia-qt-guan-yu-fctix-shu-ru-fa-de-wen-ti/"/>
      <url>/2020/06/29/linux-xia-qt-guan-yu-fctix-shu-ru-fa-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç”±äºæˆ‘è¿™é‡Œä¸€ç›´åœ¨ç”¨ibusè¾“å…¥æ³•ï¼Œè¿˜ç”¨çš„Qt5.12å®‰è£…åŒ…è‡ªå¸¦çš„qtcreatorï¼ˆ4.9.2ï¼‰ï¼Œä¸€ç›´æ²¡é—®é¢˜ï¼Œæœ€è¿‘åˆ‡äº†ä¸ªæœç‹—è¾“å…¥æ³•ï¼Œç„¶åå‘ç°QtCreatorä¹Ÿè¾“å…¥ä¸äº†ä¸­æ–‡äº†ã€‚å°±è¿™é‡Œæ€»ç»“ä¸‹è‡ªå·±çš„è§£å†³æ–¹æ¡ˆ</p><h1 id="QtCreatorè¾“å…¥ä¸­æ–‡"><a href="#QtCreatorè¾“å…¥ä¸­æ–‡" class="headerlink" title="QtCreatorè¾“å…¥ä¸­æ–‡"></a>QtCreatorè¾“å…¥ä¸­æ–‡</h1><p>å…¶å®æ–¹æ¡ˆç½‘ä¸Šæœ‰å¾ˆå¤šäº†ï¼Œæˆ‘è¿™é‡Œæ€»ç»“ä¸‹<br>é¦–å…ˆè¦è£…ä¸ªåŒ…</p><pre class=" language-shell"><code class="language-shell">sudo apt-get install fcitx-frontend-qt5</code></pre><p>ç„¶åæŠŠå®‰è£…çš„åŒ…ï¼Œæ‹·è´åˆ°å¯¹åº”çš„QtCreatorçš„ç›®å½•</p><pre class=" language-shell"><code class="language-shell">cp /usr/lib/x86_64-linux-gnu/qt5/plugins/platforminputcontexts/* ~/qtcreator-4.9.2/lib/Qt/plugins/platforminputcontexts</code></pre><p>ç„¶åé‡å¯QtCreatorï¼Œæˆ‘ç‰¹ä¹ˆå‘ç°è¿˜æ˜¯è¾“å…¥ä¸äº†ä¸­æ–‡ã€‚</p><p>å°´å°¬</p><p>çŒœæµ‹æˆ‘çš„æºé‡Œçš„åŒ…çš„ç‰ˆæœ¬ä¸å¤ªå¯¹ï¼Œå› ä¸ºå¾ˆä¹…ä¹‹å‰æ›´æ–°çš„æ¸…åçš„æºäº†ã€‚ äºæ˜¯ä»åŒäº‹é‚£é‡Œæ‹·è´è¿‡æ¥ä¸€çœ‹ï¼Œæœç„¶æ¯”æˆ‘æœ¬åœ°çš„è¦å¤§å¾ˆå¤šï¼Œæ›¿æ¢ï¼ŒæˆåŠŸè§£å†³</p><p>QtCreatorå¯ä»¥è¾“å…¥ä¸­æ–‡äº†ã€‚</p><h1 id="Qt5åˆ›å»ºçš„æ§ä»¶æ— æ³•è¾“å…¥ä¸­æ–‡"><a href="#Qt5åˆ›å»ºçš„æ§ä»¶æ— æ³•è¾“å…¥ä¸­æ–‡" class="headerlink" title="Qt5åˆ›å»ºçš„æ§ä»¶æ— æ³•è¾“å…¥ä¸­æ–‡"></a>Qt5åˆ›å»ºçš„æ§ä»¶æ— æ³•è¾“å…¥ä¸­æ–‡</h1><p>æˆ‘è¿™è¾¹åˆ›å»ºäº†ä¸ªwebengineviewï¼ŒåŸæ¥ç”¨ibusè¾“å…¥æ³•ä¸€ç›´æ˜¯å¯ä»¥çš„ã€‚ç°åœ¨åˆ‡åˆ°fctixï¼Œä¹Ÿæ˜¯è¾“å…¥ä¸äº†ä¸­æ–‡ã€‚ç„¶åå‘ç°æˆ‘çš„qtçš„å®‰è£…åŒ…çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å±…ç„¶å·²ç»æœ‰äº†ibusçš„æ’ä»¶ï¼Œï¼ˆæˆ‘è¯´å’‹ibusè¾“å…¥æ³•æ²¡é—®é¢˜å‘¢ï¼‰ã€‚ç„¶åç›´æ¥æŠŠä¸Šé¢ç»™Qtçš„æ’ä»¶æ‹·è´åˆ°å®‰è£…ç‰ˆqtçš„å¯¹åº”ç›®å½•ä¸­å°±å¯ä»¥äº†ã€‚</p><p>ç›®å½•åœ¨è¿™é‡Œï¼Œå¯ä»¥å‚è€ƒä¸‹</p><pre class=" language-shell"><code class="language-shell">/home/zhangpf/qtcreator-4.9.2/lib/Qt/plugins/platforminputcontexts/</code></pre><p>æŠŠä¸Šé¢è£…çš„åŒ…é‡Œï¼Œæœ‰ä¸ªfctixçš„.so.æ‹·è´åˆ°è¿™é‡Œå°±å¯ä»¥äº†ã€‚</p><p>å¯ä»¥åœ¨ä¸Šé¢æ„‰å¿«çš„ç”¨æœç‹—è¾“å…¥æ³•äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Linux </tag>
            
            <tag> è¾“å…¥æ³• </tag>
            
            <tag> fctix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtä¸­ UIæ–‡ä»¶æ˜¯å¦‚ä½•è½¬æˆC++æ–‡ä»¶çš„â€”UICå·¥ç¨‹(Qtæºç å‰–æ)</title>
      <link href="/2020/06/29/qt-zhong-ui-wen-jian-shi-ru-he-zhuan-cheng-c-wen-jian-de-uic-gong-cheng-qt-yuan-ma-pou-xi/"/>
      <url>/2020/06/29/qt-zhong-ui-wen-jian-shi-ru-he-zhuan-cheng-c-wen-jian-de-uic-gong-cheng-qt-yuan-ma-pou-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h1><p>UIæ–‡ä»¶ä¸ºæ ‡å‡†çš„XML<br>hæ–‡ä»¶ä¸ºæ ‡å‡†çš„Qtè¯­æ³•çš„æ–‡ä»¶ã€‚<br>å…ˆæ€è€ƒä¸€åˆ†é’Ÿï¼šå¦‚ä½•è®©ä½ æ¥è®¾è®¡ï¼Œä½ å¦‚ä½•åšè½¬åŒ–ï¼Ÿ</p><h1 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h1><p>å…¶å®è¿‡ç¨‹å¾ˆç®€å•<br>è¯»å–uiæ–‡ä»¶ï¼ˆå³xmlï¼‰ -&gt; ç»è¿‡ä¸€äº›è§„åˆ™çš„å˜åŒ–-&gt; è¾“å‡º.hæ–‡ä»¶</p><p>å®é™…ä¸Š<br>åªæ˜¯å•çº¯çš„è§„åˆ™å˜åŒ– - å­—ç¬¦ä¸²å˜åŒ–ï¼Œè¿™ä¸ªå§‘ä¸”è®¤ä¸ºæ˜¯è¯æ³•åˆ†æçš„ä¸€ä¸ªç®€å•ç‰ˆæœ¬å§ã€‚ï¼ˆåº”è¯¥ç®—åº”è¯¥ç®—</p><h1 id="Qtä»£ç ä»¥åŠä½ç½®"><a href="#Qtä»£ç ä»¥åŠä½ç½®" class="headerlink" title="Qtä»£ç ä»¥åŠä½ç½®"></a>Qtä»£ç ä»¥åŠä½ç½®</h1><p>Qtå¯¹åº”çš„å·¥ç¨‹åå­—ä¸ºUIC</p><p>ä»£ç ä½ç½®</p><pre class=" language-cpp"><code class="language-cpp">C<span class="token operator">:</span>\Qt\Qt5<span class="token number">.14</span><span class="token punctuation">.</span><span class="token number">1</span>\<span class="token number">5.14</span><span class="token punctuation">.</span><span class="token number">1</span>\Src\qtbase\src\tools\uic</code></pre><p>æ˜¯ä¸€ä¸ªç®€å•çš„proæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ç”¨QtCreatoræ‰“å¼€</p><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><blockquote><p>å¦‚æœå¹³æ—¶æœ‰æ³¨æ„Qtçš„æ–‡ä»¶ç¼–è¯‘çš„æ—¶å€™ä¼šå‘ç°uicçš„ç¼–è¯‘è¿‡ç¨‹çš„ã€‚å»ºè®®æœ‰æ—¶é—´å¤šè§‚å¯Ÿä¸‹Qtä»£ç çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œå¯¹æ¯”C++çš„ç¼–è¯‘è¿‡ç¨‹</p></blockquote><h2 id="ä¸¾ä¸ªæ —å­"><a href="#ä¸¾ä¸ªæ —å­" class="headerlink" title="ä¸¾ä¸ªæ —å­"></a>ä¸¾ä¸ªæ —å­</h2><p>æˆ‘ä»¬æŠŠ form.ui è½¬åŒ–æˆ ui_form.h<br>éœ€è¦åœ¨å·¥ç¨‹é…ç½®ä¸­<br>åœ¨Command line argumentsé‡ŒæŠŠå¯¹åº”çš„å‘½ä»¤åŠ ä¸Š<br>å¯ä»¥çœ‹ä¸‹æˆ‘çš„é…ç½®<br><img src="/2020/06/29/qt-zhong-ui-wen-jian-shi-ru-he-zhuan-cheng-c-wen-jian-de-uic-gong-cheng-qt-yuan-ma-pou-xi/uic.png" alt></p><p>æ ¼å¼å°±æ˜¯<br>æºæ–‡ä»¶(.ui) -o ç›®æ ‡æ–‡ä»¶(.h)</p><p>ç„¶åå¯ä»¥ç›´æ¥ç‚¹å‡»è°ƒè¯•æ¥è°ƒè¯•Qtçš„uicçš„æºç äº†ã€‚</p><h2 id="forn-ui"><a href="#forn-ui" class="headerlink" title="forn.ui"></a>forn.ui</h2><p>è¿™é‡Œå…ˆè´´ä¸Šform.uiçš„æè¿°</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ui</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">></span></span>wpsObject<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>widget</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>QWidget<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>wpsObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>windowModality<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enum</span><span class="token punctuation">></span></span>Qt::ApplicationModal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enum</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>geometry<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x</span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>y</span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>y</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>width</span><span class="token punctuation">></span></span>481<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>width</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>height</span><span class="token punctuation">></span></span>394<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>height</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>windowTitle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">></span></span>wpsTitle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>widget</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">/></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>connections</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ui</span><span class="token punctuation">></span></span></code></pre><h2 id="è§£æè¿‡ç¨‹"><a href="#è§£æè¿‡ç¨‹" class="headerlink" title="è§£æè¿‡ç¨‹"></a>è§£æè¿‡ç¨‹</h2><p>æ¯”å¦‚å¦‚ä½•è§£æUIæ–‡ä»¶ä¸­çš„widgetçš„ä¸€éƒ¨åˆ†ä¿¡æ¯çš„ä»£ç </p><pre class=" language-xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>widget</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>QWidget<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>wpsObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>windowModality<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enum</span><span class="token punctuation">></span></span>Qt::ApplicationModal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enum</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span></code></pre><p>ä»£ç åœ¨</p><pre class=" language-shell"><code class="language-shell">C:\Qt\Qt5.14.1\5.14.1\Src\qtbase\src\tools\uic\ui4.cpp</code></pre><p>ä¸­çš„</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>reader<span class="token punctuation">.</span><span class="token function">hasError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> QXmlStreamReader<span class="token operator">::</span>StartElement <span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> QStringRef tag <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">setElementAuthor</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readElementText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"comment"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">setElementComment</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readElementText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"exportmacro"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">setElementExportMacro</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readElementText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">setElementClass</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readElementText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"widget"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">auto</span> <span class="token operator">*</span>v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DomWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                v<span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">setElementWidget</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span></code></pre><p>é‡ç‚¹æ˜¯è§£æwidgetè¿™å¥</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"widget"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">auto</span> <span class="token operator">*</span>v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DomWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v<span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setElementWidget</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>çœ‹é‡Œé¢<code>DomWidget</code>çš„å®ç°</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>reader<span class="token punctuation">.</span><span class="token function">hasError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> QXmlStreamReader<span class="token operator">::</span>StartElement <span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> QStringRef tag <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                m_class<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">readElementText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"property"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">auto</span> <span class="token operator">*</span>v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DomProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                v<span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>                m_property<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">qWarning</span><span class="token punctuation">(</span><span class="token string">"Omitting deprecated element &lt;script>."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                reader<span class="token punctuation">.</span><span class="token function">skipCurrentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"widgetdata"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">qWarning</span><span class="token punctuation">(</span><span class="token string">"Omitting deprecated element &lt;widgetdata>."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                reader<span class="token punctuation">.</span><span class="token function">skipCurrentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"attribute"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">auto</span> <span class="token operator">*</span>v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DomProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                v<span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>                m_attribute<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span></code></pre><p>é‡ç‚¹æ˜¯è¿™ä¸€å¥</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"attribute"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>CaseInsensitive<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">auto</span> <span class="token operator">*</span>v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DomProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v<span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>    m_attribute<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>å›å¤´å†çœ‹çœ‹æˆ‘ä»¬è¦è§£æçš„uiæ–‡ä»¶çš„é‚£éƒ¨åˆ†</p><pre class=" language-xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>widget</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>QWidget<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>wpsObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>windowModality<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enum</span><span class="token punctuation">></span></span>Qt::ApplicationModal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enum</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span></code></pre><p>widgetä¸­çš„propertyå…ƒç´ å°±æ˜¯åœ¨è¿™é‡Œè§£æçš„ã€‚ </p><p>æ˜¯ä¸æ˜¯è¶…çº§ç®€å•ï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼ï¼</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™éƒ¨åˆ†ä»£ç ä¸ªäººè§‰å¾—è¿ç¼–è¯‘è¿‡ç¨‹ä¸­çš„è¯­æ³•è§£æéƒ½ç®—ä¸ä¸Šã€‚åªæ˜¯æŒ‰ç…§è§„åˆ™ï¼Œå°†XMLè½¬åŒ–æˆäº†CPPè¯­æ³•çš„æ–‡ä»¶ã€‚å¥½å§ï¼Œå¬èµ·æ¥ä¹Ÿç®—æ˜¯è¯­æ³•è§£æã€‚ä¸è¿‡è¿™æ¬¡ç®—æ˜¯æˆ‘ä»¬è‚‰çœ¼èƒ½å¤Ÿçœ‹åˆ°çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
          <category> Qtæºç å‰–æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
            <tag> Qtæºç å‰–æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]Deepinå¼€å‘è§£å†³ç³»ç»Ÿå­—ä½“bugçš„è¿‡ç¨‹</title>
      <link href="/2020/06/29/zhuan-deepin-kai-fa-jie-jue-xi-tong-zi-ti-bug-de-guo-cheng/"/>
      <url>/2020/06/29/zhuan-deepin-kai-fa-jie-jue-xi-tong-zi-ti-bug-de-guo-cheng/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åˆè¢« fontconfig å‘åˆ°äº†â€¦â€¦ä»”ç»†æƒ³æƒ³ï¼ŒåŠå¹´åˆ°ä¸€å¹´å‰æˆ‘è¿˜å¯¹ fontconfig ç‹—å±ä¸é€šå‘¢ï¼Œè€Œç°åœ¨æˆ‘å·²ç»è¢« fontconfit å‘äº†æœ‰å‡ æ¬¡äº†ï¼Œè¿™å°è¯äº†ä¸€ä¸ªçœŸç†ï¼šâ€œåªè¦ä½ è¶³å¤Ÿè¿Ÿé’ï¼Œä¸–ç•Œå°±æ˜¯ç¾å¥½çš„ï¼Œä¸€æ—¦ä½ æœ‰äº†æŸç§èƒ½åŠ›ï¼Œéº»çƒ¦å°±ä¼šæ‰¾åˆ°ä½ â€â€”â€”è¿™åªæ˜¯ä¸ªç©ç¬‘ï¼Œäº‹å®ä¸Šä¸ç®¡ä½ æœ‰æ²¡æœ‰èƒ½åŠ›ï¼Œç°å®éƒ½ä¸ä¼šè®©ä½ å¥½è¿‡ ğŸ˜ˆ</p><p>åœ¨è¿™äº›å‘é‡Œé¢ï¼Œæœ‰ä¸¤ä¸ªæ˜¯è·Ÿä»Šå¤©ä¸»é¢˜ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯å…³äºWPSä¸­å­—ä½“åç§°çš„ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>WPS å­—ä½“åˆ—è¡¨ä¸­ä¸­æ–‡å­—ä½“åœ¨ä¸­æ–‡ç¯å¢ƒä¸‹ä¸æ˜¾ç¤ºä¸­æ–‡åï¼ˆæ¯”å¦‚ç³»ç»Ÿé‡Œé¢æœ‰å®‹ä½“ï¼Œåˆ—è¡¨é‡Œé¢æ˜¾ç¤º SimSunï¼‰ï¼›</li><li>WPS è®¾ç½®æ®µè½å­—ä½“ï¼ˆä¸­æ–‡å­—ä½“ï¼‰åï¼Œå·¥å…·æ æ˜¾ç¤ºçš„å­—ä½“ä¸ºè‹±æ–‡åï¼ˆæ¯”å¦‚ä½ è®¾ç½®ä¸€æ®µæ–‡å­—æ˜¯å®‹ä½“ï¼Œä½†æ˜¯æ ‡é¢˜æ æ˜¾ç¤ºçš„ä»ç„¶æ˜¯SimSunï¼‰</li></ul><p>è¿™ä¸¤ä¸ªé—®é¢˜æœ‰ç‚¹åƒï¼Œä½†æ˜¯å´ä¸æ˜¯åŒä¸€ä¸ªé—®é¢˜ï¼ˆä¹Ÿä¸åªæ˜¯WPSæœ‰é—®é¢˜ï¼Œè€Œæ˜¯WPSå¯¹å­—ä½“çš„éœ€æ±‚æ¯”è¾ƒå¤šï¼‰ï¼š</p><p>ç¬¬ä¸€ä¸ªé—®é¢˜åŸå…ˆæ˜¯ è®ºå›ç”¨æˆ·æŠ¥å‘Š çš„ï¼ˆå®é™…ä¸Šåˆ˜è€å¤§ä¹ŸæŠ¥è¿‡ï¼Œä¸è¿‡è¢«è‡ªåŠ¨å¿½ç•¥äº†ğŸ˜‚ï¼‰ï¼Œè®ºå›ç”¨æˆ·åˆæŠ¥è¿‡æ¥ä»¥åï¼Œå¤§å®¶çœ‹ç”¨æˆ·çš„æŠ¥å‘Šå¤ªè¯¦ç»†äº†ï¼Œæ„ŸåŠ¨å¾—ä¸€å¡Œç³Šæ¶‚ï¼Œé¡¿æ—¶è§£å†³é—®é¢˜çš„åŠ¨åŠ›éƒ½æœ‰äº†ã€‚æˆ‘ä¹ŸæŠ˜è…¾äº†å¤§åŠå¤©ï¼Œä¸è¿‡è„‘è¢‹é‡Œé¢ä¸€ç›´æœ‰ä¸€ä¸ªåŒäº‹çš„å£°éŸ³ï¼šé‚£æ˜¯å­—ä½“æœ‰é—®é¢˜ï¼æˆ‘ä¹ŸæŒºèµåŒçš„ï¼šç›—ç‰ˆçš„å­—ä½“ï¼Œä¸é è°±å¾ˆæ­£å¸¸â€¦â€¦æ‰€ä»¥ï¼Œæˆ‘å°±è€ƒè™‘èƒ½ä¸èƒ½ç»™å­—ä½“åšä¸€äº›åˆ«åå•¥çš„ï¼Œæ¯”å¦‚ SimSun å°±å« å®‹ä½“â€¦â€¦å½“ç„¶äº†æœ€åå°±æ˜¯ç©äº†ä¸€ä¸‹ fontconfig çš„é…ç½®ä»¥åï¼Œé»˜é»˜å°±æ”¾å¼ƒäº†ã€‚</p><p>æœ€åç»è¿‡ @felixonmars åŒå­¦çš„æ’æŸ¥ï¼Œå‘ç°æ˜¯ä¸Šæ¸¸çš„ä¸€ä¸ª bug ï¼Œè€Œä¸”å·²ç»ä¿®å¤ï¼Œæ‰€ä»¥èµ¶ç´§æ›´äº†ä¸€æ³¢ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>æœ¬ä»¥ä¸ºçš†å¤§æ¬¢å–œäº†ï¼Œä»Šå¤©åˆæœ‰å®¢æˆ·æŠ¥è¿‡æ¥ bugï¼Œè¯´ Windows ä¸Šå†™å¥½çš„æ–‡æ¡£ï¼Œè°ƒæ•´å¥½çš„å­—ä½“ï¼Œè·‘åˆ°deepinä¸‹å­—ä½“å°±ä¸å¯¹äº†ï¼ŒåºŸäº†è€å¤§çš„åŠ²å„¿æ‰åˆè°ƒå¥½ï¼Œå…¶ä¸­å°±æåˆ°äº†é€‰æ‹©æ–¹æ­£å­—åº“é‡Œé¢çš„å­—ä½“ï¼Œæ˜¾ç¤ºçš„ä¸æ˜¯ä¸­æ–‡å­—ä½“åç§°çš„é—®é¢˜ã€‚</p><p>æ€ä¹ˆè¯´å‘¢ï¼Œå¹¸äºæˆ‘è„‘å­ä¸å¥½ï¼Œä¸è®°å¾—ä¹‹å‰å·²ç»è§£å†³è¿‡ä¸­æ–‡å­—ä½“åæ˜¾ç¤ºä¸ºè‹±æ–‡çš„é—®é¢˜ï¼Œè¦ä¸ç„¶å¾—è·Ÿå®¢æˆ·å’Œè€æ¿æ°æ‰¯ä¸€ä¼šå„¿ï¼Œæˆ‘åªè®°å¾—å­—ä½“çš„ä¸­è‹±æ–‡åå­—å¥½åƒæ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œæ‰€ä»¥é»˜é»˜èµ¶ç´§å»çœ‹äº†ä¸€ä¸‹ï¼Œè¿˜çœŸçœŸçš„æœ‰é—®é¢˜ã€‚</p><p>å› ä¸º DDE å¹¶æ²¡æœ‰è®¾ç½®è¿‡å¤šçš„ fontconfig é…ç½®ï¼Œæ‰€ä»¥æˆ‘ç›¸ä¿¡è¿™ä¸æ˜¯ DDE çš„é—®é¢˜ï¼Œä½†æ˜¯åˆè§‰å¾—å¯¹äºä¸€ä¸ªæ–‡å­—å¤„ç†è½¯ä»¶æ¥è¯´ï¼Œå¦‚æœè¿™ä¹ˆé‡è¦çš„åŠŸèƒ½éƒ½æœ‰ BUGï¼Œæˆ‘çœŸä¸ä¿¡ WPS çš„äººè¿˜èƒ½åå¾—ä½ï¼Œæ‰€ä»¥å°±æƒ³è¯•ä¸€ä¸‹åœ¨ Ubuntu ä¸‹ WPS çš„è¿™ä¸ªè¡Œä¸ºæ˜¯å¦æ­£ç¡®ã€‚åˆšå¥½å¹´å‰ ElementryOS å‘æ–°ç‰ˆçš„æ—¶å€™å°é²œè£…äº†ä¸€ä¸ªåœ¨æµ‹è¯•æœºå™¨ä¸Šï¼Œæ‰€ä»¥å¾ˆå¿«åˆ‡è¿›å»ä¸‹äº†ä¸€ä¸ª WPS å®‰è£…ä¸Šï¼Œä»ä¸€ä¸ªæ­£ç‰ˆçš„ç½‘ç«™ä¸Šä¸‹è½½äº†ä¸€ä¸ªç›—ç‰ˆçš„å®‹ä½“ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œæœç„¶è¸é©¬çš„æ˜¯å¥½çš„â€¦â€¦</p><p>ç†æ€§çš„æˆ‘ç”¨äº‹å®è¯æ˜äº†æ„Ÿæ€§çš„æˆ‘æ˜¯é”™è¯¯çš„ï¼Œæ°”æ°›ä¸€åº¦å¾ˆå°´å°¬ã€‚</p><p>æ›´è®©äººå°´å°¬çš„æ˜¯ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¿™æ˜¯æ€ä¹ˆå›äº‹ã€‚ä½†æ˜¯ï¼Œæ— å·§ä¸æˆä¹¦ï¼Œå°±åœ¨è¿™ç§å°´å°¬æ°›å›´çš„ç¬¼ç½©ä¸‹ï¼Œæˆ‘é¬¼ä½¿ç¥å·®åœ°åœ¨ ElementryOS ï¼ˆå¤ªé•¿äº†ï¼Œä¸‹é¢ç®€ç§° EOS ï¼‰ä¸Šè¿è¡Œäº† fc-match å®‹ä½“ è¿™ä¸ªå‘½ä»¤ï¼Œè€Œä¸”å¾ˆç¥å¥‡çš„å‘ç°è¾“å‡ºçš„ simsun.ttf: â€œå®‹ä½“â€ â€œRegularâ€ è·Ÿ deepin ä¸‹åŒæ ·å‘½ä»¤è¾“å‡ºçš„ simsun.ttf: â€œSimSunâ€ â€œRegularâ€ ä¸å¤ªä¸€æ ·ï¼Œè¿™å¯æŠŠæˆ‘ä¹åäº†â€”â€”è¦çŸ¥é“ä¸€ä¸ªç¨å¾®å¤æ‚ç‚¹çš„å›¾å½¢è½¯ä»¶ï¼Œæ‰“å¼€ fontconfig çš„è°ƒè¯•ä»¥åï¼Œè¾“å‡ºå°±æ˜¯å¾ˆå¯æ€•çš„ï¼Œæ›´åˆ«è¯´ WPSï¼åˆ«é—®æˆ‘æ˜¯æ€ä¹ˆçŸ¥é“çš„ï¼Œå›å¿†èµ·æ¥éƒ½æ˜¯æ³ªã€‚ä½†æ˜¯ç°åœ¨ä½¿ç”¨ fc-match å°±èƒ½é‡ç°çš„é—®é¢˜ï¼ˆæˆ‘æ‰“å¿ƒåº•è®¤ä¸ºè¿™ä¿©æ˜¯åŒä¸€ä¸ªé—®é¢˜ï¼‰ï¼Œè°ƒè¯•èµ·æ¥å°±æ¯”è¾ƒç®€å•äº†ã€‚</p><p>fontconfig æœ¬èº«ä¸ºäº†æ–¹ä¾¿ç¨‹åºè°ƒè¯•ï¼Œå†…å»ºäº†ä¸€äº›è°ƒè¯•é¡¹ï¼Œå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ FC_DEBUG æ§åˆ¶ï¼š</p><pre class=" language-cpp"><code class="language-cpp">Name Value Meaning  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>  MATCH <span class="token number">1</span> Brief information about font matching  MATCHV <span class="token number">2</span> Extensive font matching information  EDIT <span class="token number">4</span> Monitor match<span class="token operator">/</span>test<span class="token operator">/</span>edit execution  FONTSET <span class="token number">8</span> Track loading of font information at startup  CACHE <span class="token number">16</span> Watch cache files being written  CACHEV <span class="token number">32</span> Extensive cache file writing information  PARSE <span class="token function">64</span> <span class="token punctuation">(</span>no longer in use<span class="token punctuation">)</span>  SCAN <span class="token number">128</span> Watch font files being scanned to build caches  SCANV <span class="token number">256</span> Verbose font file scanning information  MEMORY <span class="token number">512</span> Monitor fontconfig memory usage  CONFIG <span class="token number">1024</span> Monitor which config files are loaded  LANGSET <span class="token number">2048</span> Dump <span class="token keyword">char</span> sets used to construct lang values  MATCH2 <span class="token number">4096</span> Display font<span class="token operator">-</span>matching transformation in patterns</code></pre><p>æˆ‘ä»¬åªéœ€è¦æœ€ç®€ç•¥çš„åŒ¹é…ä¿¡æ¯å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥ï¼š</p><pre class=" language-cpp"><code class="language-cpp">$ FC_DEBUG<span class="token operator">=</span><span class="token number">1</span> fc<span class="token operator">-</span>match å®‹ä½“FC_DEBUG<span class="token operator">=</span><span class="token number">1</span>Match Pattern has <span class="token number">25</span> <span class="token function">elts</span> <span class="token punctuation">(</span>size <span class="token number">32</span><span class="token punctuation">)</span>    family<span class="token operator">:</span> <span class="token string">"å®‹ä½“"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"Noto Sans CJK SC"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"Noto Sans"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    familylang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"en-us"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    stylelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"en-us"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fullnamelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"en-us"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    slant<span class="token operator">:</span> <span class="token function">0</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    weight<span class="token operator">:</span> <span class="token function">80</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    width<span class="token operator">:</span> <span class="token function">100</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    size<span class="token operator">:</span> <span class="token function">12</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    pixelsize<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">.</span><span class="token function">5</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    hintstyle<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    hinting<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    verticallayout<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    autohint<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    globaladvance<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    dpi<span class="token operator">:</span> <span class="token function">75</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    scale<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    lang<span class="token operator">:</span> <span class="token string">"zh-CN"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fontversion<span class="token operator">:</span> <span class="token function">2147483647</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    embeddedbitmap<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    decorative<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    lcdfilter<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    namelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    prgname<span class="token operator">:</span> <span class="token string">"fc-match"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    symbol<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    variable<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>Best score <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1e+99</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2.14735e+12</span>Pattern has <span class="token number">25</span> <span class="token function">elts</span> <span class="token punctuation">(</span>size <span class="token number">25</span><span class="token punctuation">)</span>    family<span class="token operator">:</span> <span class="token string">"SimSun"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token string">"å®‹ä½“"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    familylang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token string">"zh-cn"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    style<span class="token operator">:</span> <span class="token string">"Regular"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    stylelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fullname<span class="token operator">:</span> <span class="token string">"SimSun"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token string">"å®‹ä½“"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fullnamelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token string">"zh-cn"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    slant<span class="token operator">:</span> <span class="token function">0</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    weight<span class="token operator">:</span> <span class="token function">80</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    width<span class="token operator">:</span> <span class="token function">100</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    spacing<span class="token operator">:</span> <span class="token function">90</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    foundry<span class="token operator">:</span> <span class="token string">"ZYEC"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    file<span class="token operator">:</span> <span class="token string">"/home/hualet/.fonts/simsun.ttf"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    index<span class="token operator">:</span> <span class="token function">0</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    outline<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    scalable<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    charset<span class="token operator">:</span>     <span class="token number">0000</span><span class="token operator">:</span> <span class="token number">00000000</span> ffffffff ffffffff ffffffff <span class="token number">00000000</span> ffffffff ffffffff ffffffff    <span class="token number">0001</span><span class="token operator">:</span> <span class="token number">08080002</span> <span class="token number">00000800</span> 000c2110 <span class="token number">01000803</span> <span class="token number">00040000</span> <span class="token number">00000000</span> <span class="token number">15554000</span> <span class="token number">00000000</span>    <span class="token number">0002</span><span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00020000</span> <span class="token number">00000002</span> <span class="token number">00000000</span> <span class="token number">00000000</span> 12000ec0 <span class="token number">00000000</span>    <span class="token number">0003</span><span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> fffe0000 fffe03fb 000003fb <span class="token number">00000000</span>    <span class="token number">0004</span><span class="token operator">:</span> ffff0002 ffffffff <span class="token number">0002ffff</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0020</span><span class="token operator">:</span> <span class="token number">77790000</span> 0e2d0067 <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00001000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0021</span><span class="token operator">:</span> <span class="token number">00400228</span> <span class="token number">00000006</span> <span class="token number">00000000</span> 03ff0fff 03cf0000 <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0022</span><span class="token operator">:</span> e4228100 20f04fa9 <span class="token number">00041100</span> 0000c0f3 <span class="token number">02200000</span> <span class="token number">80000020</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0023</span><span class="token operator">:</span> <span class="token number">00040000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0024</span><span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> fff003ff <span class="token number">0fffffff</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0025</span><span class="token operator">:</span> ffffffff ffffffff ffff0fff <span class="token number">000fffff</span> 0038fffe 300c0003 0000c8c0 0000003c    <span class="token number">0026</span><span class="token operator">:</span> <span class="token number">00000260</span> <span class="token number">00000000</span> <span class="token number">00000005</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0030</span><span class="token operator">:</span> 60ffffef 000003fe fffffffe ffffffff <span class="token number">780fffff</span> fffffffe ffffffff <span class="token number">707fffff</span>    <span class="token number">0031</span><span class="token operator">:</span> ffffffe0 <span class="token number">000003ff</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0032</span><span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">000203ff</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000008</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">0033</span><span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> 7000c000 <span class="token number">00000002</span> <span class="token number">00264010</span> <span class="token number">00000000</span>    004e<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">004f</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0050</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0051</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0052</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0053</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0054</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0055</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0056</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0057</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0058</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0059</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    005a<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    005b<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    005c<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    005d<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    005e<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">005f</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0060</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0061</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0062</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0063</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0064</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0065</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0066</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0067</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0068</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0069</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    006a<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    006b<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    006c<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    006d<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    006e<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">006f</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0070</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0071</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0072</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0073</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0074</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0075</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0076</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0077</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0078</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0079</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    007a<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    007b<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    007c<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    007d<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    007e<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">007f</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0080</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0081</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0082</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0083</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0084</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0085</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0086</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0087</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0088</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0089</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    008a<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    008b<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    008c<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    008d<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    008e<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">008f</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0090</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0091</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0092</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0093</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0094</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0095</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0096</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0097</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0098</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">0099</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    009a<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    009b<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    009c<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    009d<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    009e<span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff    <span class="token number">009f</span><span class="token operator">:</span> ffffffff ffffffff ffffffff ffffffff ffffffff <span class="token number">0000003f</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">00e7</span><span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000180</span> 000fff80    <span class="token number">00e8</span><span class="token operator">:</span> ffe00000 ffffffff ffffffff <span class="token number">0000001f</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    00f9<span class="token operator">:</span> <span class="token number">00000000</span> <span class="token number">00001000</span> <span class="token number">00000000</span> <span class="token number">02000000</span> <span class="token number">00200000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00020080</span>    00fa<span class="token operator">:</span> 811af000 0000039b <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    00fe<span class="token operator">:</span> <span class="token number">00000000</span> fffb0000 fef7fe1f 00000f7f <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span>    <span class="token number">00ff</span><span class="token operator">:</span> fffffffe ffffffff <span class="token number">7fffffff</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token number">00000000</span> <span class="token function">0000003f</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    lang<span class="token operator">:</span> aa<span class="token operator">|</span>ay<span class="token operator">|</span>bg<span class="token operator">|</span>bi<span class="token operator">|</span>br<span class="token operator">|</span>ch<span class="token operator">|</span>co<span class="token operator">|</span>da<span class="token operator">|</span>de<span class="token operator">|</span>en<span class="token operator">|</span>es<span class="token operator">|</span>eu<span class="token operator">|</span>fj<span class="token operator">|</span>fo<span class="token operator">|</span>fr<span class="token operator">|</span>fur<span class="token operator">|</span>fy<span class="token operator">|</span>gd<span class="token operator">|</span>gl<span class="token operator">|</span>gv<span class="token operator">|</span>ho<span class="token operator">|</span>ia<span class="token operator">|</span>id<span class="token operator">|</span>ie<span class="token operator">|</span>io<span class="token operator">|</span>is<span class="token operator">|</span>it<span class="token operator">|</span>kum<span class="token operator">|</span>lb<span class="token operator">|</span>mg<span class="token operator">|</span>nb<span class="token operator">|</span>nds<span class="token operator">|</span>nl<span class="token operator">|</span>nn<span class="token operator">|</span>no<span class="token operator">|</span>nr<span class="token operator">|</span>nso<span class="token operator">|</span>oc<span class="token operator">|</span>om<span class="token operator">|</span>os<span class="token operator">|</span>pt<span class="token operator">|</span>rm<span class="token operator">|</span>ru<span class="token operator">|</span>sel<span class="token operator">|</span>sma<span class="token operator">|</span>smj<span class="token operator">|</span>so<span class="token operator">|</span>sq<span class="token operator">|</span>ss<span class="token operator">|</span>st<span class="token operator">|</span>sv<span class="token operator">|</span>sw<span class="token operator">|</span>tl<span class="token operator">|</span>tn<span class="token operator">|</span>ts<span class="token operator">|</span>uz<span class="token operator">|</span>vo<span class="token operator">|</span>wa<span class="token operator">|</span>xh<span class="token operator">|</span>yap<span class="token operator">|</span>zh<span class="token operator">-</span>cn<span class="token operator">|</span>zh<span class="token operator">-</span>sg<span class="token operator">|</span>zu<span class="token operator">|</span>an<span class="token operator">|</span>fil<span class="token operator">|</span>ht<span class="token operator">|</span>jv<span class="token operator">|</span>kj<span class="token operator">|</span>kwm<span class="token operator">|</span>li<span class="token operator">|</span>ms<span class="token operator">|</span>ng<span class="token operator">|</span>pap<span class="token operator">-</span>an<span class="token operator">|</span>pap<span class="token operator">-</span>aw<span class="token operator">|</span>rn<span class="token operator">|</span>rw<span class="token operator">|</span>sc<span class="token operator">|</span>sg<span class="token operator">|</span>sn<span class="token operator">|</span>su<span class="token operator">|</span><span class="token function">za</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fontversion<span class="token operator">:</span> <span class="token function">131072</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    capability<span class="token operator">:</span> <span class="token string">"otlayout:hani"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fontformat<span class="token operator">:</span> <span class="token string">"TrueType"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    decorative<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    postscriptname<span class="token operator">:</span> <span class="token string">"SimSun"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    color<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    symbol<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    variable<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>simsun<span class="token punctuation">.</span>ttf<span class="token operator">:</span> <span class="token string">"SimSun"</span> <span class="token string">"Regular"</span></code></pre><p>å› ä¸ºä»¥å‰è°ƒ fontconfig çš„ç»éªŒï¼Œæˆ‘æ¨¡æ¨¡ç³Šç³ŠçŸ¥é“é‚£ä¸ª familylang æ˜¯æ§åˆ¶ family ä¹Ÿå°±æ˜¯å­—ä½“åæ˜¾ç¤ºçš„è¯­è¨€çš„ï¼Œæ‰€ä»¥çœ‹åˆ°</p><pre class=" language-shell"><code class="language-shell">familylang: "en"(s) "en-us"(w)</code></pre><p>è¿™è¡Œä»¥åï¼Œå¤§è‡´èƒ½ç¡®å®šåº”è¯¥æ˜¯ç³»ç»ŸæŸä¸ªé…ç½®å‡ºäº†é—®é¢˜è®© fontconfig è¯¯ä»¥ä¸ºè¯­è¨€ç¯å¢ƒæ˜¯è‹±æ–‡ã€‚çœ‹äº†ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œæ²¡å‘ç°å“ªä¸ªæ˜¯è®¾ç½®è‹±æ–‡çš„ï¼Œæ‰€ä»¥åªèƒ½å»çœ‹ä»£ç äº†ã€‚<br>ä¸‹äº† fontconfig çš„æºç ï¼Œæœäº†ä¸€ä¸‹å…³é”®å­— familylang ï¼ŒçŒœæµ‹è¿™ä¸ªå±æ€§åº”è¯¥æ˜¯é€šè¿‡æ“çºµ FC_FAMILYLANG_OBJECT ï¼Œå†æ¬¡æœç´¢ï¼š</p><pre class=" language-shell"><code class="language-shell"> $ rg -i FC_FAMILYLANG_OBJECTsrc/fcmatch.c380: case FC_FAMILYLANG_OBJECT:551: if (fe->object == FC_FAMILYLANG_OBJECT ||565: FC_ASSERT_STATIC ((FC_FAMILY_OBJECT + 1) == FC_FAMILYLANG_OBJECT);695: pe->object != FC_FAMILYLANG_OBJECT &&src/fclist.c430: familyidx = FcGetDefaultObjectLangIndex (font, FC_FAMILYLANG_OBJECT, lang);src/fcfreetype.c1671: while (FcPatternObjectGetString (pat, FC_FAMILYLANG_OBJECT, n, &familylang) == FcResultMatch)src/fcdefault.c316: if (!FcPatternFindObjectIter (pattern, &iter, FC_FAMILYLANG_OBJECT))318: FcPatternObjectAdd (pattern, FC_FAMILYLANG_OBJECT, namelang, FcTrue);319: FcPatternObjectAddWithBinding (pattern, FC_FAMILYLANG_OBJECT, v2, FcValueBindingWeak, FcTrue);</code></pre><p>å‘ç°å…¶ä¸­åªæœ‰ fcdefault.c é‡Œé¢æœ‰æ‰§è¡Œ FcPatternObjectAdd è¿™ä¸ªæ“ä½œåƒæ˜¯åœ¨ä¿®æ”¹è¿™ä¸ªå±æ€§ï¼Œå…¶ä»–åœ°æ–¹æ˜æ˜¾éƒ½åªæ˜¯è¯»å–ï¼Œåˆšå¥½ fc-match/fc-match.c é‡Œé¢ä¹Ÿæœ‰è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä»”ç»†çœ‹äº†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œä»é€»è¾‘ä¸Šçœ‹æ„æ€æ˜¯ familylang å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œå°±ä¼šä» namelang å±æ€§ç»§æ‰¿ï¼Œç„¶åæˆ‘å¿½ç„¶å‘ç° fc-match çš„å¸®åŠ©é‡Œé¢å†™å¾—ä½ç½®å‚æ•°æ¦‚å¿µä¸Šå« pattern ï¼Œéš¾é“å°±å¯¹åº” FcPatternï¼Œé‚£å®ƒåº”è¯¥ä¹Ÿå¯ä»¥æŒ‡å®š familylang å’¯ï¼Ÿç½‘ä¸Šæœå¯»äº†ä¸€ç•ªï¼Œå‘ç°å¯ä»¥ fc-match å®‹ä½“:familylang=zh-cnï¼Œæœç„¶è¾“å‡ºæ­£å¸¸çš„ä¸­æ–‡åã€‚è¿™ç®—æ˜¯ä¸€ä¸ªå°æ’æ›²å§ã€‚</p><p>æ¥ç€ namelang å±æ€§è¯´ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä»ä¸€ä¸ªå« FcGetDefaultLang çš„å‡½æ•°å¤„è·å–ï¼Œæˆ‘å¿ƒæƒ³æ€»ç®—æ˜¯è¦åˆ°å¤´äº†ï¼Œç„¶è€Œå‘ç°ä»å‡½æ•°çš„å®ç°æ¥çœ‹ï¼Œè¿™ä¸ªå‡½æ•°ä¼šä» FC_LANGã€LC_ALLã€LC_CTYPEå’ŒLANGè¿™äº›ç¯å¢ƒå˜é‡é‡Œé¢æŒ¨ä¸ªè¯»å–é»˜è®¤çš„è¯­è¨€ï¼ˆåæ¥å‘ç°ç›´æ¥ man FcGetDefaultlangs å°±å¯ä»¥çœ‹åˆ°ï¼‰ï¼Œçœ‹èµ·æ¥æ²¡æ¯›ç—…å‘€ã€‚</p><p>å†™äº†ä¸ªæµ‹è¯•ç¨‹åºï¼š</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fontconfig/fontconfig.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    FcStrSet <span class="token operator">*</span>langs <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    langs <span class="token operator">=</span> <span class="token function">FcGetDefaultLangs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>langs<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        FcChar8 <span class="token operator">*</span>lang <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        FcStrList <span class="token operator">*</span>lang_list <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        lang_list <span class="token operator">=</span> <span class="token function">FcStrListCreate</span><span class="token punctuation">(</span>langs<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">FcStrListFirst</span><span class="token punctuation">(</span>lang_list<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>lang <span class="token operator">=</span> <span class="token function">FcStrListNext</span><span class="token punctuation">(</span>lang_list<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> lang<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç¼–è¯‘æ‰§è¡Œï¼Œè¾“å‡º zh-CN ï¼Œ666</p><p>ä¸­é—´å°è¯•äº†ä½¿ç”¨ gdb åœ¨ fc-match.cä¸­è°ƒç”¨ FcDefaultSubstitute çš„éƒ¨åˆ†åŠ æ–­ç‚¹ï¼Œä½†æ˜¯æ­»æ´»æ— æ³•è·³å…¥å‡½æ•°ä½“é‡Œé¢ï¼Œç›´æ¥åœ¨å‡½æ•°é‡Œé¢å“åº”çš„è¡Œæ•°å¤„æ–­ç‚¹ï¼Œç›´æ¥æ— æ•ˆâ€¦â€¦æ’é¬¼äº†</p><p>æ²¡åŠæ³•äº†ï¼Œåªèƒ½æ”¹ä»£ç äº†ï¼Œæ‰¾äº†æ‰¾ä»£ç é‡Œé¢çš„ log æ¨¡å—å« fcdbg.c ï¼Œæˆ‘æœ¬æ¥è¿˜è¯´ä» FcPattern é‡Œé¢è¯»å–å±æ€§æœ‰ç‚¹éº»çƒ¦ï¼Œåˆä¸ç†Ÿæ‚‰ä»£ç ï¼Œä½†æ˜¯æ„å¤–åœ°æ‰¾åˆ°ä¸€ä¸ª FcPatternPrint ï¼Œè¿™ä¸‹è¿ç»§ç»­ç ”ç©¶ä¸‹å»çš„åŠ¨åŠ›éƒ½æ²¡æœ‰äº†ï¼Œèµ¶ç´§åŠ ä»£ç æ‰“å°ï¼Œåˆ†åˆ«åœ¨ FcConfigSubstitute å’Œ FcDefaultSubstitute å‰ååŠ äº†æ‰“å°çœ‹å¯¹ pat çš„ä»£ç ï¼š</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token function">FcPatternPrint</span><span class="token punctuation">(</span>pat<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FcConfigSubstitute</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> pat<span class="token punctuation">,</span> FcMatchPattern<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FcPatternPrint</span><span class="token punctuation">(</span>pat<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FcDefaultSubstitute</span> <span class="token punctuation">(</span>pat<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FcPatternPrint</span><span class="token punctuation">(</span>pat<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¾“å…¥</p><pre class=" language-cpp"><code class="language-cpp">$ <span class="token punctuation">.</span><span class="token operator">/</span>fc<span class="token operator">-</span>match å®‹ä½“Pattern has <span class="token number">1</span> <span class="token function">elts</span> <span class="token punctuation">(</span>size <span class="token number">16</span><span class="token punctuation">)</span>    family<span class="token operator">:</span> <span class="token string">"å®‹ä½“"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>Pattern has <span class="token number">6</span> <span class="token function">elts</span> <span class="token punctuation">(</span>size <span class="token number">16</span><span class="token punctuation">)</span>    family<span class="token operator">:</span> <span class="token string">"å®‹ä½“"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"Noto Sans CJK SC"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"Noto Sans"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    hintstyle<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    lang<span class="token operator">:</span> <span class="token string">"zh-CN"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    lcdfilter<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    namelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    prgname<span class="token operator">:</span> <span class="token string">"fc-match"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>Pattern has <span class="token number">25</span> <span class="token function">elts</span> <span class="token punctuation">(</span>size <span class="token number">32</span><span class="token punctuation">)</span>    family<span class="token operator">:</span> <span class="token string">"å®‹ä½“"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"Noto Sans CJK SC"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"Noto Sans"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    familylang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"en-us"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    stylelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"en-us"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fullnamelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">"en-us"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    slant<span class="token operator">:</span> <span class="token function">0</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    weight<span class="token operator">:</span> <span class="token function">80</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    width<span class="token operator">:</span> <span class="token function">100</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    size<span class="token operator">:</span> <span class="token function">12</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    pixelsize<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">.</span><span class="token function">5</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    hintstyle<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    hinting<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    verticallayout<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    autohint<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    globaladvance<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    dpi<span class="token operator">:</span> <span class="token function">75</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    scale<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    lang<span class="token operator">:</span> <span class="token string">"zh-CN"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    fontversion<span class="token operator">:</span> <span class="token function">2147483647</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    embeddedbitmap<span class="token operator">:</span> <span class="token function">True</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    decorative<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    lcdfilter<span class="token operator">:</span> <span class="token function">1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    namelang<span class="token operator">:</span> <span class="token string">"en"</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>    prgname<span class="token operator">:</span> <span class="token string">"fc-match"</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    symbol<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    variable<span class="token operator">:</span> <span class="token function">False</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>simsun<span class="token punctuation">.</span>ttf<span class="token operator">:</span> <span class="token string">"SimSun"</span> <span class="token string">"Regular"</span></code></pre><p>å¯ä»¥ç¡®è®¤æ˜¯ FcConfigSubstitute å‡½æ•°é‡Œé¢ç»™ pat è®¾ç½®äº† en çš„ namelangï¼Œé‚£ä¹‹ååœ¨ FcDefaultSubstitute ä¸­ familylang å°±ä» namelang ç»§æ‰¿äº† en ï¼ŒåˆåŠ ä¸Šäº† en-us ï¼Œå˜æˆäº†æˆ‘ä»¬çœ‹åˆ°çš„ â€œenâ€ï¼Œâ€en-usâ€ ã€‚çœ‹å‡½æ•°åï¼Œ FcConfigSubstitute åº”è¯¥å°±æ˜¯è¯»å–äº†é…ç½®æ–‡ä»¶ï¼Œç„¶ååšäº†ä»€ä¹ˆä¿®æ”¹ï¼Œè‡³äºæ€ä¹ˆæ”¹çš„æˆ‘ä¹Ÿä¸çŸ¥é“ã€‚</p><p>è¿™æ—¶å€™æˆ‘å·æ‡’ç—‡çŠ¯äº†ï¼Œæ²¡æœ‰å»çœ‹ä»£ç äº†ï¼ˆçœ‹ç€ç•¥å¤æ‚ï¼‰ï¼Œæˆ‘å‘ç°æ–°ç‰ˆ fontconfig å¤šäº†ä¸€ä¸ªå·¥å…·å« fc-conflist èƒ½åˆ—å‡ºæ¥ fontconfig åŠ è½½çš„æ‰€æœ‰é…ç½®æ–‡ä»¶åˆ—è¡¨ï¼Œé€šè¿‡è¿™ä¸ªå‘½ä»¤æˆ‘å‘ç°ç³»ç»Ÿé‡Œé¢çš„é…ç½®æ–‡ä»¶ä¸»è¦æ”¾åœ¨ /etc/fonts å’Œ /usr/share/fontconfig ï¼Œç„¶åå°±ç”¨ rg å»é‡Œé¢æœå…³é”®å­— lang äº†ï¼Œæ’é™¤å…¶ä¸­ <test> çš„è¡Œï¼Œè¿˜çœŸå‘ç°ä¸€ä¸ªå« /usr/share/conf.avail/15-assign-lang-en.conf çš„æ–‡ä»¶é‡Œé¢æœ‰ edit namelang è¿™ä¸ªå±æ€§ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘éƒ½ä¸çŸ¥é“è¿˜æœ‰ edit è¿™ç§æ“ä½œâ€¦â€¦æˆ‘ä¹Ÿæ›´ä¸ä¿¡è¿™ä¸ªé—®é¢˜ä¼šå‡ºåœ¨ fontconfig çš„é…ç½®ä¸Šã€‚</test></p><pre class=" language-shell"><code class="language-shell">$ dpkg -S conf.avail/15-assign-lang-en.confdeepin-default-settings: /usr/share/fontconfig/conf.avail/15-assign-lang-en.conf</code></pre><p>äº‹å®è¯æ˜ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶è¿˜çœŸæ˜¯ deepin æä¾›çš„â€¦â€¦</p><p>æœ¬æ¥æƒ³ææ¸…æ¥šä¹‹å‰ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªçš„ï¼Œä½†æ˜¯æäº¤ä¿¡æ¯å¤ªç®€å•äº†ï¼Œæ²¡æœ‰æä¾›ç›¸å…³çº¿ç´¢ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯ä»¥å‰æœ‰äº›å­—ä½“åç§°ä¼šä¹±ç â€”â€”å­—ä½“åç§°éœ€è¦ç‰¹æ®Šå­—ä½“çš„æ”¯æŒï¼Œç„¶è€Œç³»ç»Ÿï¼ˆç»ˆç«¯ï¼‰çš„å­—ä½“ä¸æ”¯æŒè¿™ç§å­—ä½“çš„å­—ä½“åï¼Œä¸ºäº†è§£å†³ä¹±ç ï¼Œé»˜è®¤ä½¿ç”¨è‹±æ–‡è¾“å‡ºå­—ä½“åç§° ğŸ˜…</p><p>ä¸è¿‡æœ‰äº† Noto è¿™ç§é—®é¢˜åº”è¯¥å°±å¾ˆå°‘äº†ï¼Œæ‰€ä»¥ç‹ å¿ƒåˆ æ‰äº†è¿™ä¸ªé…ç½®ï¼šæäº¤ã€‚</p><p>ç»“åˆè¿™ä¸¤ä¸ªé—®é¢˜ï¼ŒçŒœæµ‹ WPS å­—ä½“è®¾ç½®åˆ†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ä»ç³»ç»Ÿè·å–å­—ä½“åˆ—è¡¨ï¼Œè¿™ä¸ªéƒ¨åˆ†æ˜¯ä» Qt æ‹¿çš„ï¼Œç”¨çš„ Qt æä¾›çš„å­—ä½“åï¼ˆä¸­æ–‡ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ä»è¿™ä¸ªå­—ä½“åæ‹¿åˆ°ç³»ç»Ÿä¸­åŒ¹é…åº¦æœ€é«˜çš„å­—ä½“ï¼Œåº”è¯¥æ˜¯é€šè¿‡ libfontconfig ç›´æ¥åšå¾—ï¼ˆdeepinä¸‹è‹±æ–‡ï¼‰ï¼Œç„¶åå†æŠŠè¿™ä¸ªå­—ä½“è®¾ç½®ç»™å®é™…çš„æ–‡æ¡£ï¼Œå·¥å…·æ ä¸­æ˜¾ç¤ºçš„ä¹Ÿå°±æ˜¯è¿™ä¸ªåå­—ã€‚æ€»ä¹‹ï¼Œäººå®¶åˆä¸å¼€æºï¼ŒççŒœä¸€ä¸‹å›¾ä¸ªå¼€å¿ƒå’¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> deepin </tag>
            
            <tag> freetype </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtçš„åŸºæœ¬æ¦‚å¿µ-WIKI</title>
      <link href="/2020/06/29/qt-de-ji-ben-gai-nian-wiki/"/>
      <url>/2020/06/29/qt-de-ji-ben-gai-nian-wiki/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h1><h2 id="wiki"><a href="#wiki" class="headerlink" title="wiki"></a>wiki</h2><p>Qtï¼ˆ/ËˆkjuËt/ï¼Œå‘éŸ³åŒâ€œcuteâ€[4][5][6]ï¼‰æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„C++åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚å¹¿æ³›ç”¨äºå¼€å‘GUIç¨‹åºï¼Œè¿™ç§æƒ…å†µä¸‹åˆè¢«ç§°ä¸ºéƒ¨ä»¶å·¥å…·ç®±ã€‚ä¹Ÿå¯ç”¨äºå¼€å‘éGUIç¨‹åºï¼Œæ¯”å¦‚æ§åˆ¶å°å·¥å…·å’ŒæœåŠ¡å™¨ã€‚Qtä½¿ç”¨äºOPIEã€Skypeã€VLC media playerã€Adobe Photoshop Elementsã€VirtualBoxä¸Mathematica[7]ä»¥åŠè¢«Autodesk [8][9]ã€æ¬§æ´²ç©ºé—´å±€[10]ã€æ¢¦å·¥å‚[11][12]ã€Googleã€HP[13]ã€KDEã€å¢å¡æ–¯å½±ä¸š[14]ã€è¥¿é—¨å­å…¬å¸[15]ã€æ²ƒå°”æ²ƒé›†å›¢[16], åç‰¹è¿ªå£«å°¼åŠ¨ç”»åˆ¶ä½œå…¬å¸[17]ã€ä¸‰æ˜Ÿé›†å›¢[18]ã€é£åˆ©æµ¦[19]ã€Panasonic [20]æ‰€ä½¿ç”¨ã€‚</p><p>å®ƒæ˜¯Digiaå…¬å¸çš„äº§å“ã€‚Qtä½¿ç”¨æ ‡å‡†çš„C++å’Œç‰¹æ®Šçš„ä»£ç ç”Ÿæˆæ‰©å±•ï¼ˆç§°ä¸ºå…ƒå¯¹è±¡ç¼–è¯‘å™¨ï¼ˆMeta Object Compiler, mocï¼‰ï¼‰ä»¥åŠä¸€äº›å®ã€‚é€šè¿‡è¯­è¨€ç»‘å®šï¼Œå…¶ä»–çš„ç¼–ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥ä½¿ç”¨Qtã€‚</p><p>Qtæ˜¯è‡ªç”±ä¸”å¼€æ”¾æºä»£ç çš„è½¯ä»¶ï¼Œåœ¨GNUå®½é€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆLGPLï¼‰æ¡æ¬¾ä¸‹å‘å¸ƒã€‚æ‰€æœ‰ç‰ˆæœ¬éƒ½æ”¯æŒå¹¿æ³›çš„ç¼–è¯‘å™¨ï¼ŒåŒ…æ‹¬GCCçš„C++ç¼–è¯‘å™¨å’ŒVisual Studioã€‚</p><h2 id="å†å²"><a href="#å†å²" class="headerlink" title="å†å²"></a>å†å²</h2><p>Haavard Nordå’ŒEirik Chambe-Engäº1991å¹´å¼€å§‹å¼€å‘â€œQtâ€ï¼Œ1994å¹´3æœˆ4æ—¥åˆ›ç«‹å…¬å¸ï¼Œæœ€æ—©åä¸ºQuasar Technologiesï¼Œç„¶åæ›´åä¸ºTroll Techï¼Œç„¶åå†æ”¹ä¸ºTrolltechï¼Œä¸­æ–‡åæ˜¯â€œå¥‡è¶£ç§‘æŠ€â€ï¼Œ2008å¹´6æœˆ17æ—¥è¢«NOKIAå…¬å¸æ”¶è´­ï¼Œä»¥å¢å¼ºè¯¥å…¬å¸åœ¨è·¨å¹³å°è½¯ä»¶ç ”å‘æ–¹é¢çš„å®åŠ›ï¼Œæ›´åQt Softwareã€‚</p><p>è¯¥å·¥å…·åŒ…åä¸ºQtæ˜¯å› ä¸ºå­—æ¯Qåœ¨Haavardçš„Emacså­—ä½“ç‰¹åˆ«æ¼‚äº®ï¼Œè€Œâ€œtâ€ä»£è¡¨â€œtoolkitâ€ï¼Œçµæ„Ÿæ¥è‡ªXtï¼ŒX toolkit[21]ã€‚</p><p>2009å¹´5æœˆ11æ—¥ï¼Œè¯ºåŸºäºšQt Softwareå®£å¸ƒQtæºä»£ç ç®¡ç†ç³»ç»Ÿé¢å‘å…¬ä¼—å¼€æ”¾ï¼ŒQtå¼€å‘äººå‘˜å¯é€šè¿‡ä¸ºQtä»¥åŠä¸Qtç›¸å…³çš„é¡¹ç›®è´¡çŒ®ä»£ç ã€ç¿»è¯‘ã€ç¤ºä¾‹ä»¥åŠå…¶ä»–å†…å®¹ï¼ŒååŠ©å¼•å¯¼å’Œå¡‘é€ Qtæœªæ¥çš„å‘å±•ã€‚ä¸ºäº†ä¾¿äºè¿™äº›å†…å®¹çš„ç®¡ç†ï¼ŒQt Softwareå¯ç”¨äº†åŸºäºGitå’ŒGitoriouså¼€æºé¡¹ç›®çš„Webæºä»£ç ç®¡ç†ç³»ç»Ÿã€‚</p><p>åœ¨æ¨å‡ºå¼€æ”¾å¼Qtä»£ç åº“çš„åŒæ—¶ï¼ŒQt Softwareåœ¨å…¶ç½‘ç«™å‘å¸ƒäº†å…¶äº§å“è§„åˆ’ï¼ˆRoadmapï¼‰ã€‚å…¶ä¸­æ¦‚è¿°äº†ç ”å‘é¡¹ç›®ä¸­çš„æœ€æ–°åŠŸèƒ½ï¼Œå±•ç°äº†ç°é˜¶æ®µå¯¹Qtæœªæ¥å‘å±•æ–¹å‘çš„è§‚ç‚¹ï¼Œä»¥æœŸé¼“åŠ±ç¤¾åŒºæä¾›åé¦ˆå’Œè´¡çŒ®ä»£ç ï¼Œå…±åŒå¼•å¯¼å’Œå¡‘é€ Qtçš„æœªæ¥ã€‚2012å¹´8æœˆ9æ—¥ï¼ŒDigiaå®£å¸ƒå·²å®Œæˆå¯¹è¯ºåŸºäºšQtä¸šåŠ¡åŠè½¯ä»¶æŠ€æœ¯çš„å…¨é¢æ”¶è´­ï¼Œå¹¶è®¡åˆ’å°†Qtåº”ç”¨åˆ°Androidã€iOSåŠWindows 8å¹³å°ä¸Šã€‚[22]</p><h2 id="æ”¯æŒå¹³å°"><a href="#æ”¯æŒå¹³å°" class="headerlink" title="æ”¯æŒå¹³å°"></a>æ”¯æŒå¹³å°</h2><p>ä½¿ç”¨Qtå¼€å‘çš„è½¯ä»¶ï¼Œç›¸åŒçš„ä»£ç å¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„å¹³å°ä¸Šç¼–è¯‘ä¸è¿è¡Œï¼Œè€Œä¸éœ€è¦ä¿®æ”¹æºä»£ç ã€‚ä¼šè‡ªåŠ¨ä¾å¹³å°çš„ä¸åŒï¼Œè¡¨ç°å¹³å°ç‰¹æœ‰çš„å›¾å½¢ç•Œé¢é£æ ¼ã€‚</p><ul><li>Linux/X11ï¼šç”¨äºX Window Systemï¼ˆå¦‚Solarisã€AIXã€HP-UXã€Linuxã€BSDï¼‰ã€‚æ”¯æŒKDevelopå’ŒEclipse IDEé›†æˆ</li><li>Macï¼šç”¨äºApple Mac OS Xã€‚åŸºäºCocoaæ¡†æ¶ã€‚æ”¯æŒUniversal Binaryã€‚æ”¯æŒä»¥Xcodeç¼–è¾‘ã€ç¼–è¯‘å’Œæµ‹è¯•ã€‚</li><li>Windowsï¼šç”¨äºMicrosoft Windowsã€‚æ”¯æŒVisual Studioé›†æˆï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨MinGWç¼–è¯‘</li><li>Embedded Linuxï¼šç”¨äºåµŒå…¥å¼Linuxã€‚å¯ä»¥é€è¿‡ç¼–è¯‘ç§»é™¤ä¸å¸¸ä½¿ç”¨çš„ç»„ä»¶ä¸åŠŸèƒ½ã€‚é€è¿‡è‡ªå·±çš„è§†çª—ç³»ç»ŸQWSï¼Œä¸éœ€ä¾èµ–X Window Systemï¼Œç›´æ¥å†™å…¥Linuxå¸§ç¼“å†²ã€‚å¯ä»¥å‡å°‘å­˜å‚¨å™¨æ¶ˆè€—ã€‚å¹¶æä¾›è™šæ‹Ÿå¸§ç¼“å†²QVFbï¼Œæ–¹ä¾¿åœ¨æ¡Œé¢ç³»ç»Ÿä¸Šè¿›è¡ŒåµŒå…¥å¼æµ‹è¯•ã€‚</li><li>Windows CE / Mobile ï¼šç”¨äºWindows CE</li><li>Symbianï¼šç”¨äºSymbian platform</li><li>Maemo/MeeGoï¼šç”¨äºMaemo</li><li>Wayland â€“ç”¨äºWaylandæ˜¾ç¤ºæœåŠ¡å™¨ï¼ŒQtåº”ç”¨ç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶åˆ‡æ¢å›¾å½¢åç«¯ï¼Œå¦‚Xä¸Waylandã€‚[23][24]</li></ul><h2 id="æˆæƒæ¨¡å¼"><a href="#æˆæƒæ¨¡å¼" class="headerlink" title="æˆæƒæ¨¡å¼"></a>æˆæƒæ¨¡å¼</h2><p>Qtå¼€æ”¾æºä»£ç ï¼Œå¹¶ä¸”æä¾›è‡ªç”±è½¯ä»¶çš„ç”¨æˆ·åè®®ã€‚ä½¿å¾—å®ƒå¯ä»¥è¢«å¹¿æ³›åœ°åº”ç”¨åœ¨å„å¹³å°ä¸Šçš„å¼€æ”¾æºä»£ç è½¯ä»¶å¼€å‘ä¸­ã€‚</p><p>Qtæä¾›ä¸‰ç§æˆæƒæ–¹å¼ã€‚ä¸‰ç§æˆæƒæ–¹å¼çš„åŠŸèƒ½ã€æ€§èƒ½éƒ½æ²¡æœ‰åŒºåˆ«ï¼Œä»…åœ¨äºæˆæƒåè®®çš„ä¸åŒã€‚LGPLå’ŒGPLæ˜¯å…è´¹å‘å¸ƒï¼Œå•†ä¸šç‰ˆåˆ™éœ€æ”¶å–æˆæƒè´¹ã€‚[33]ï¼š</p><ul><li><p>Qtå•†ä¸šç‰ˆ - Qtå•†ä¸šæˆæƒé€‚ç”¨äºå¼€å‘ä¸“å±å’Œ/æˆ–å•†ä¸šè½¯ä»¶ã€‚æ­¤ç‰ˆæœ¬é€‚ç”¨äºä¸å¸Œæœ›ä¸ä»–äººå…±äº«æºä»£ç ï¼Œæˆ–è€…éµå¾ªGNUå®½é€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆLGPLï¼‰2.1ç‰ˆæˆ–GNU GPL 3.0ç‰ˆæ¡æ¬¾çš„å¼€å‘äººå‘˜ã€‚æä¾›äº†æŠ€æœ¯æ”¯æŒæœåŠ¡ã€‚å¯ä»¥ä»»æ„çš„ä¿®æ”¹Qtçš„æºä»£ç ï¼Œè€Œä¸éœ€è¦å…¬å¼€ã€‚</p></li><li><p>GNU LGPL v. 2.1- Qt 4.5.0åŠä»¥åçš„ç‰ˆæœ¬å¼€å§‹éµå¾ªGNU LGPLã€‚LGPLå…è®¸é“¾æ¥åˆ°å®ƒçš„è½¯ä»¶ä½¿ç”¨ä»»æ„çš„è®¸å¯è¯ï¼Œå¯ä»¥è¢«ä¸“å±è½¯ä»¶ä½œä¸ºç±»åº“å¼•ç”¨ã€å‘å¸ƒå’Œé”€å”®ã€‚å¯ä»¥è´­ä¹°æ”¯æŒæœåŠ¡ã€‚</p></li><li><p>GNU GPL v. 3.0 - å¦‚æœæ‚¨å¸Œæœ›å°†Qtåº”ç”¨ç¨‹åºä¸å—GNUé€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆGPLï¼‰3.0ç‰ˆæœ¬æ¡æ¬¾é™åˆ¶çš„è½¯ä»¶ä¸€åŒä½¿ç”¨ï¼Œæˆ–è€…æ‚¨å¸Œæœ›Qtåº”ç”¨ç¨‹åºéµå¾ªè¯¥GNUè®¸å¯è¯ç‰ˆæœ¬çš„æ¡æ¬¾ï¼Œåˆ™æ­¤ç‰ˆæœ¬Qté€‚ç”¨äºå¼€å‘æ­¤ç±»Qtåº”ç”¨ç¨‹åºã€‚å¯ä»¥è´­ä¹°æ”¯æŒæœåŠ¡ã€‚</p></li></ul><h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><p>Qtç»è¿‡å¤šå¹´å‘å±•ï¼ŒQtä¸ä½†æ‹¥æœ‰äº†å®Œå–„çš„C++å›¾å½¢åº“ï¼Œè€Œä¸”è¿‘å¹´æ¥çš„ç‰ˆæœ¬é€æ¸é›†æˆäº†æ•°æ®åº“ã€OpenGLåº“ã€å¤šåª’ä½“åº“ã€ç½‘ç»œã€è„šæœ¬åº“ã€XMLåº“ã€WebKitåº“ç­‰ç­‰ï¼Œå…¶æ ¸å¿ƒåº“ä¹ŸåŠ å…¥äº†è¿›ç¨‹é—´é€šä¿¡ã€å¤šçº¿ç¨‹ç­‰æ¨¡å—ï¼Œæå¤§çš„ä¸°å¯Œäº†Qtå¼€å‘å¤§è§„æ¨¡å¤æ‚è·¨å¹³å°åº”ç”¨ç¨‹åºçš„èƒ½åŠ›ï¼ŒçœŸæ­£æ„ä¹‰ä¸Šå®ç°äº†å…¶ç ”å‘å®—æ—¨â€œCode Less; Create More; Deploy Anywhere.â€ã€‚</p><p>ç”±äºå„å®¶ç¼–è¯‘å™¨è§„æ ¼ä¸åŒï¼ŒQtæœ¬èº«ä¸ºäº†è·¨å¹³å°å…¼å®¹æ€§ï¼Œåªèƒ½ä»¥â€œæœ€ä½å…¼å®¹è§„æ ¼â€æ¥è®¾è®¡ã€‚å› æ­¤Qtå¿…é¡»å…·å¤‡RTTIã€åŠ¨æ€åˆ›å»ºã€Persistence/Serializationçš„åŸºç¡€å»ºè®¾ï¼Œä»¥åŠå»ºæ„å‡ºè‡ªå·±çš„å®¹å™¨ç»„ä»¶ã€‚</p><p>ä¸‹åˆ—æ¨¡å—æä¾›ä¸€èˆ¬çš„è½¯ä»¶å¼€å‘</p><ul><li>QtCoreâ€”QtCoreæ¨¡å—æ˜¯æ‰€æœ‰åŸºäºQtçš„åº”ç”¨ç¨‹åºçš„åŸºç¡€ï¼Œæä¾›ä¿¡å·ä¸æ§½çš„å¯¹è±¡é—´é€šä¿¡æœºåˆ¶ã€IOã€äº‹ä»¶å’Œå¯¹è±¡å¤„ç†ã€å¤šçº¿ç¨‹</li><li>QtGuiâ€”åŒ…å«äº†å¼€å‘å›¾å½¢ç”¨æˆ·ç•Œé¢åº”ç”¨ç¨‹åºæ‰€éœ€çš„åŠŸèƒ½ã€‚ä½¿ç”¨å…¶æ”¯æŒçš„å„ä¸ªå¹³å°çš„åŸç”Ÿå›¾å½¢APIã€‚æ”¯æŒåé”¯é½¿ã€å‘é‡å½¢å˜ã€‚æ”¯æŒARGBé¡¶å±‚widget</li><li>QtMultimediaâ€”æä¾›äº†ç”¨äºå¤šåª’ä½“å†…å®¹å¤„ç†çš„QMLç±»å‹é›†å’ŒC++ç±»é›†ã€‚åŒæ—¶æä¾›è®¿é—®æ‘„åƒå¤´åŠéŸ³é¢‘åŠŸèƒ½çš„APIã€‚åŒ…å«çš„QtéŸ³é¢‘å¼•æ“æ”¯æŒä¸‰ç»´éŸ³é¢‘å›æ”¾åŠç®¡ç†ã€‚</li><li>QtNetworkâ€”æä¾›äº†ç½‘ç»œç¨‹åºè®¾è®¡åŠŸèƒ½ã€‚æ”¯æŒé€šç”¨åè®®ï¼Œå¦‚HTTPã€FTPå’ŒDNSï¼ŒåŒ…æ‹¬å¯¹å¼‚æ­¥HTTP 1.1çš„æ”¯æŒã€‚ä¸è¾ƒä½å±‚çš„TCP/IPå’ŒUDPåè®®ï¼Œå¦‚QTcpSocketã€QTcpServerå’ŒQUdpSocket</li><li>QtOpenGLâ€”æä¾›åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨OpenGLå’ŒOpenGL ESåŠ å…¥3Då›¾å½¢ã€‚åœ¨Windowså¹³å°ä¸Šäº¦æ”¯æŒDirect3D</li><li>QtOpenVG-æä¾›OpenVGç»˜å›¾æ”¯æŒçš„ä¸€ä¸ªæ’ä»¶</li><li>QtScriptâ€”åŒ…å«å®Œå…¨é›†æˆçš„ECMAæ ‡å‡†è„šæœ¬å¼•æ“ã€‚æä¾›ä¿¡å·ä¸æ§½æœºåˆ¶ç®€åŒ–å¯¹è±¡é—´é€šä¿¡å’ŒQtScriptè°ƒè¯•å™¨ã€‚</li><li>QtScriptToolsâ€”é¢å¤–çš„Qt Scriptç»„ä»¶</li><li>QtSqlâ€”å°†æ•°æ®åº“é›†æˆè‡³åº”ç”¨ç¨‹åºã€‚æ”¯æŒæ‰€æœ‰ä¸»è¦çš„æ•°æ®åº“é©±åŠ¨åŒ…æ‹¬ODBCã€MySQLã€PSQLã€SQLiteã€ibaseã€Oracleã€Sybaseã€DB2ã€‚</li><li>QtSvgâ€”æ”¯æŒSVGæ ¼å¼</li><li>QtWebKitâ€”é›†æˆWebKitï¼Œæä¾›äº†HTMLæµè§ˆå™¨å¼•æ“ï¼Œä¾¿äºåœ¨åŸç”Ÿåº”ç”¨ç¨‹åºä¸­åµŒå…¥ç½‘ç»œå†…å®¹å’ŒæœåŠ¡ã€‚</li><li>QtXmlâ€”æä¾›äº†XMLæ–‡æ¡£çš„é˜…è¯»å™¨å’Œç¼–å†™å™¨ã€æ”¯æŒSAXå’ŒDOMã€‚</li><li>QtXmlPatternslâ€”æä¾›äº†XQueryå’ŒXPathå¼•æ“æ”¯æŒã€‚</li><li>Phononâ€”é›†æˆPhononï¼Œæ”¯æŒè·¨å¹³å°åº”ç”¨ç¨‹åºæ’­æ”¾éŸ³é¢‘å’Œè§†é¢‘å†…å®¹ã€‚Qt5å¼€å§‹ä¸æ”¯æŒPhononã€‚</li><li>Qt3Supportâ€”æ¨¡å—æä¾›å…¼å®¹Qt 3.Ñ….Ñ…ç‰ˆæœ¬çš„ç¨‹åºåº“</li><li>QtDeclarative [34] - engine for declaratively building fluid user interfaces in QML</li></ul><p>ä½œä¸šäºQté™„å¸¦å·¥å…·çš„æ¨¡å—</p><ul><li>QtDesignerâ€”æä¾›æ‰©å±•Qt Designerçš„ç±»åˆ«ã€‚</li><li>QtUiTools</li><li>QtHelpâ€”ååŠ©é›†æˆåœ¨çº¿æ–‡ä»¶åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</li><li>QtTestâ€”æä¾›å•å…ƒæµ‹è¯•æ¡†æ¶å’Œé¼ æ ‡å’Œé”®ç›˜æ¨¡æ‹ŸåŠŸèƒ½ã€‚é›†æˆVisual Studioå’ŒKDevelopã€‚</li></ul><p>ä¸‹åˆ—æ¨¡å—ç”¨äºUnixå¼€å‘</p><ul><li>QtDBus</li></ul><p>ä¸‹åˆ—æ¨¡å—ç”¨äºWindowså¼€å‘</p><ul><li>QAxContainer</li><li>QAxServer</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥ä¸Šå†…å®¹å…¨éƒ¨æ‘˜è‡ªwikiï¼ŒåŸæ–‡é“¾æ¥åœ°å€<a href="https://zh.wikipedia.org/zh/Qtã€‚" target="_blank" rel="noopener">https://zh.wikipedia.org/zh/Qtã€‚</a></p><p>æˆ‘å°±æ˜¯æ‡’å¾—æ‰“é‚£ä¹ˆå¤šå­—ä»‹ç»äº†ã€‚ä¸‹é¢å¼€å§‹æ­£å¼è®²è§£Qtäº†</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
          <category> QtåŸºç¡€æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ­å»ºQt5.14å¼€å‘ç¯å¢ƒ-å‚»ç“œå¼</title>
      <link href="/2020/06/29/qt-linux-lazy/"/>
      <url>/2020/06/29/qt-linux-lazy/</url>
      
        <content type="html"><![CDATA[<h1 id="0-å®‰è£…c-å¼€å‘ç¯å¢ƒ"><a href="#0-å®‰è£…c-å¼€å‘ç¯å¢ƒ" class="headerlink" title="0 å®‰è£…c++å¼€å‘ç¯å¢ƒ"></a>0 å®‰è£…c++å¼€å‘ç¯å¢ƒ</h1><p>ä¸€èˆ¬çš„ç³»ç»Ÿåº”è¯¥éƒ½é»˜è®¤è£…äº†=ã€‚=</p><pre class=" language-shell"><code class="language-shell">sudo apt-get updatesudo apt-get install gcc g++ </code></pre><h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><p>è¾“å…¥ç½‘å€ <a href="http://download.qt.io/archive/qt/5.14/5.14.0/" target="_blank" rel="noopener">http://download.qt.io/archive/qt/5.14/5.14.0/</a> </p><blockquote><p>ä¸Šé¢çš„ç½‘ç«™ï¼Œä¼°è®¡ä¸‹è½½å¾ˆæ…¢ï¼Œè¿™é‡Œè´´ä¸Šä¸€ä¸ªæ¸…åæºçš„ã€‚<a href="https://mirrors.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.14/5.14.0/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.14/5.14.0/</a></p></blockquote><p>ä¸‹è½½runæ–‡ä»¶ï¼Œè¿™æ˜¯Linuxä¸Šçš„ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„æ ¼å¼</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt1.jpg" alt></p><h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><p>ä¸‹è½½å®Œæˆï¼Œè¿›å…¥ä¸‹è½½ç›®å½•ï¼Œå³é”®-ç»ˆç«¯ã€‚æ‰§è¡Œå‘½ä»¤ï¼Œç»™å¯æ‰§è¡Œæƒé™</p><pre class=" language-shell"><code class="language-shell">chmod a+x ./qt-opensource-linux-x64-5.14.0.run</code></pre><p>ç„¶åç»ˆç«¯è¿è¡Œï¼Œå¼€å§‹å®‰è£…</p><pre class=" language-shell"><code class="language-shell">./qt-opensource-linux-x64-5.14.0.run</code></pre><p><img src="/2020/06/29/qt-linux-lazy/linux_qt2.jpg" alt> </p><p>ä¸€ç›´ä¸‹ä¸€æ­¥ or nextï¼Œè‡ªå·±é€‰æ‹©å®‰è£…ç›®å½•ï¼ˆè¿™ä¸ªä¸è®²ç©¶ï¼Œéšä¾¿ä¸€ä¸ªå°±è¡Œï¼Œæˆ‘è¿™é‡Œé€‰æ‹©é»˜è®¤çš„</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt3.jpg" alt> </p><p>next</p><hr><p><img src="/2020/06/29/qt-linux-lazy/linux_qt4.jpg" alt> </p><p>çº¢æ¡†ä¸­çš„ä¸¤ä¸ªæ˜¯å¿…é€‰çš„ï¼Œç„¶åæˆ‘ä¸€ä¸ªä¸ªè§£é‡Š</p><ul><li>Desktop gcc 64-bit è¿™æ˜¯Qté¢„ç¼–è¯‘å¥½çš„64ä½çš„Qtåº“ã€‚</li><li>Developer and Designer Tools è¿™å°±æ˜¯æˆ‘ä»¬çš„ä¸»è§’QtCreator</li><li>Qt WebEngine è¿™æ˜¯Qtæ›¿ä»£Webkitçš„åº“ï¼Œè¿™ä¸ªè£…ä¸è£…éƒ½è¡Œã€‚</li></ul><hr><p>æ¥ä¸‹æ¥å°±åŒæ„äººå®¶åè®®å‘—ï¼Œä¸åŒæ„ä¸ç»™ç”¨ã€‚é€‰LGPLï¼ˆè¿™ä¸ªåŠ¨æ€é“¾æ¥ä¸èŠ±é’±</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt5.jpg" alt> </p><hr><p>å®‰è£…å‘—</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt6.jpg" alt> </p><hr><p>æŒºå¿«çš„</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt7.jpg" alt> </p><hr><p>ç‚¹å‡»å®Œæˆï¼Œæ‰“å¼€QtCreator </p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt8.jpg" alt> </p><p>ç‚¹å‡»å·¥å…·èœå•ä¸‹çš„é€‰é¡¹ï¼Œæ‰“å¼€</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt9.jpg" alt> </p><p>è§‚å¯ŸKitçš„é€‰æ‹©ï¼Œå‘ç°Qtçš„ç‰ˆæœ¬å·²ç»å®‰è£…å¥½äº†ï¼Œå¯¹åº”çš„è·¯å¾„ä¹Ÿåœ¨ä¸Šé¢ï¼ˆè£…ä¸Šå°±æ˜¯é…ç½®å¥½çš„</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt10.jpg" alt> </p><p>ç‚¹å¼€ç¼–è¯‘å™¨ å‘ç°ç³»ç»Ÿè‡ªå¸¦çš„GCCä¹Ÿå·²ç»è¯†åˆ«å‡ºæ¥äº†ã€‚ï¼ˆæˆ‘è¿™é‡Œä¹Ÿæ˜¯ä»€ä¹ˆéƒ½æ²¡åŠ¨</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt11.jpg" alt> </p><p>ç„¶åç‚¹å¼€Kitï¼Œå‘ç°ç¼–è¯‘å™¨å·²ç»é€‰å¥½äº†ï¼ŒQtVersionä¹Ÿå·²ç»å¥½äº†ã€‚ï¼ˆè¿™é‡Œä¹Ÿä»€ä¹ˆéƒ½æ²¡åŠ¨<br>è¿™è¯´æ˜ç¯å¢ƒå·²ç»æ­å»ºå¥½äº†ã€‚ç„¶åç‚¹å‡»ç¡®å®š</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt12.jpg" alt> </p><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><h2 id="æ–°å»ºé¡¹ç›®"><a href="#æ–°å»ºé¡¹ç›®" class="headerlink" title="æ–°å»ºé¡¹ç›®"></a>æ–°å»ºé¡¹ç›®</h2><p>ç‚¹å‡»NewæŒ‰é’®ï¼Œç„¶åè·Ÿç€å›¾ä¸€æ­¥æ­¥æ¥</p><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt13.jpg" alt> </p><h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt14.jpg" alt> </p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt15.jpg" alt> </p><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt16.jpg" alt> </p><h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt17.jpg" alt> </p><h3 id="7"><a href="#7" class="headerlink" title="7"></a>7</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt18.jpg" alt> </p><h3 id="8"><a href="#8" class="headerlink" title="8"></a>8</h3><p>ç„¶åé€‰å’±ä»¬åˆšæ‰é…å¥½çš„Kitï¼ˆå®é™…ä¸Šå•¥éƒ½æ²¡å¹²ã€‚<br><img src="/2020/06/29/qt-linux-lazy/linux_qt19.jpg" alt> </p><h3 id="9"><a href="#9" class="headerlink" title="9"></a>9</h3><p><img src="/2020/06/29/qt-linux-lazy/linux_qt20.jpg" alt> </p><p>ç‚¹å‡»å®Œæˆ<br>é¡¹ç›®å°±å»ºç«‹å¥½äº†ã€‚</p><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><h3 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h3><p>å³é”®é¡¹ç›®å…ˆ æ‰§è¡Œqmake -&gt; æ„å»º</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt21.jpg" alt> </p><h3 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h3><p>å‘ç°æŠ¥é”™</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt22.jpg" alt> </p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>ç¼ºå°‘åº“è€Œå·²ã€‚è£…ä¸Šå°±è¡Œ</p><pre class=" language-shell"><code class="language-shell">sudo apt-get install libgl1-mesa-dev libglu1-mesa-dev</code></pre><p><img src="/2020/06/29/qt-linux-lazy/linux_qt23.jpg" alt> </p><h3 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h3><p>ç„¶åå†æ„å»º<br>å‘ç°é€šè¿‡ã€‚</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt24.jpg" alt> </p><h3 id="5-succeed"><a href="#5-succeed" class="headerlink" title="5 succeed"></a>5 succeed</h3><p>ç‚¹å‡»è¿è¡Œï¼Œå‘ç°è¿è¡ŒæˆåŠŸï¼</p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt25.jpg" alt> </p><p><img src="/2020/06/29/qt-linux-lazy/linux_qt26.jpg" alt> </p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>è‡³æ­¤ï¼ŒLinuxä¸Šçš„Qtç¯å¢ƒçš„æ­å»ºå·²ç»å®Œæˆï¼Œè¿™ä¸ªæ˜¯æ–¹å¼æ˜¯ç›¸å½“ç®€å•çš„ï¼ŒåŸºæœ¬ä¸Šä¸€ç›´ä¸‹ä¸€æ­¥å°±å¯ä»¥äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
          <category> QtåŸºç¡€æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MFCã€WTLã€WPFã€wxWidgetsã€Qtã€GTK å„æœ‰ä»€ä¹ˆç‰¹ç‚¹</title>
      <link href="/2020/06/28/mfc-wtl-wpf-wxwidgets-qt-gtk-ge-you-shi-me-te-dian/"/>
      <url>/2020/06/28/mfc-wtl-wpf-wxwidgets-qt-gtk-ge-you-shi-me-te-dian/</url>
      
        <content type="html"><![CDATA[<p>ä½œè€…ï¼šå§šå†¬<br>é“¾æ¥ï¼š<a href="https://www.zhihu.com/question/23480014/answer/24809080" target="_blank" rel="noopener">https://www.zhihu.com/question/23480014/answer/24809080</a><br>æ¥æºï¼šçŸ¥ä¹<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>è°¢é‚€ï¼ˆç»ˆäºç”¨ä¸Šè¿™ä¸ªé«˜å¤§ä¸Šçš„è¯æ±‡äº†ï¼ŒçœŸçš„æœ‰ç‚¹å°æ¿€åŠ¨å‘¢ï¼‰</p><h1 id="WTL"><a href="#WTL" class="headerlink" title="WTL"></a>WTL</h1><p>WTLéƒ½ç®—ä¸ä¸Šä»€ä¹ˆFrameworkï¼Œå°±æ˜¯åˆ©ç”¨æ³›å‹ç‰¹æ€§å¯¹Win APIåšäº†å±‚å°è£…ï¼Œè®¾è®¡æ€è·¯ä¹Ÿæ²¡æ‘†è„±MFCçš„å½±å“ï¼Œå®é™…ä¸Šç”¨æ³›å‹åšUI Frameworkä¹Ÿåªèƒ½ç®—æ˜¯ä¸€æ¬¡è¡Œä¸ºè‰ºæœ¯ï¼Œè¿™ä¸ªæ€è·¯ä¸‹ç»§ç»­å‘å±•å°±ä¼šå˜å¾—æ²¡æ³•ç”¨äº†ï¼Œæ¯”å¦‚ ä»£ç è¿‡äºå¤æ‚ï¼Œç¼–è¯‘å¤ªæ…¢ï¼Œå‡ºé”™ä¸å¥½è°ƒè¯•ç­‰é—®é¢˜éš¾ä»¥è§£å†³ã€‚<br>è€Œä¸”å°è£…å¾—ä¹Ÿä¸å®Œå…¨ï¼Œè¿˜æ˜¯éšå¤„å¯è§ HWND HDCä¹‹ç±»çš„ä¸œè¥¿ã€‚<br>ç”¨é€”ä¸»è¦æ˜¯å†™ä¸€äº›å¾ˆå°çš„ç¨‹åºï¼Œæˆ–è€…ä½œä¸ºå…¶ä»–UIæ¡†æ¶çš„åç«¯å®ç°éƒ¨åˆ†ï¼Œæ¯”å¦‚æˆ‘å†™è¿‡ä¸€ä¸ªå°æ¡†æ¶ç”¨æ¥åšå®‰è£…å¸è½½ç¨‹åºï¼Œéå¸¸å°ï¼Œå…¶ä¸­åˆ›å»ºç®¡ç†çª—å£éƒ¨åˆ†æ˜¯ç”¨WTLçš„ã€‚</p><h1 id="MFC"><a href="#MFC" class="headerlink" title="MFC"></a>MFC</h1><p>MFCæ˜¯æ›´é«˜çº§ç‚¹çš„Win APIå°è£…ï¼Œæ¯”WTLå°è£…å½»åº•ï¼Œå¾ˆéš¾è§åˆ°HWND HDCäº†ï¼Œä¹Ÿæä¾›äº†ä¸å°‘å®ç”¨å·¥å…·ç±»ï¼Œæ¯”å¦‚é«˜çº§æ§ä»¶ï¼Œæ³›å‹å®¹å™¨ï¼ŒIOè®¿é—®ï¼Œç½‘ç»œåè®®ç­‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æä¾›äº†ä¸€äº›åŸºæœ¬æ¡†æ¶ï¼Œæ¯”å¦‚ Document/Viewï¼Œè¿™å°±æ˜¯ä¸ªMVCçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œåªæœ‰MVï¼Œä½†æ˜¯å¯¹äºæ•°æ®çš„ç®¡ç†ï¼Œæ¶ˆæ¯çš„ä¼ é€’ç­‰åˆæ²¡æœ‰ä»€ä¹ˆçº¦æŸï¼Œå¯¼è‡´Doc/Viewè¢«ç”¨å¾—ä¹±ä¸ƒå…«ç³Ÿã€‚å°¤å…¶æ˜¯å¯¹äº‹ä»¶å¤„ç†çš„æ¨¡å‹ï¼Œæ¶ˆæ¯æ˜ å°„æ˜¯åŠŸèƒ½ç®€é™‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™çš„æ–¹å¼ï¼Œå”¯ä¸€ä¼˜ç‚¹æ˜¯æ€§èƒ½å¥½ã€‚ ä»VC++ 1.Xå°±æœ‰MFCäº†ï¼Œé‚£æ—¶æ•´ä¸ªUIç•Œçš„è®¾è®¡æ€æƒ³éƒ½æ¯”è¾ƒè½åï¼ˆé™¤äº†Appleï¼‰ï¼ŒMFCåˆèƒŒè´Ÿäº†æ²‰é‡çš„å…¼å®¹æ€§åŒ…è¢±ï¼Œæ¯”å¦‚vc++ 1.52çš„MFCç¨‹åºåˆ°äº†vc2003ç¨åŠ ä¿®æ”¹éƒ½å¯ä»¥ç¼–è¯‘ï¼Œå¯¼è‡´MFCåæœŸæ²¡æœ‰ä»€ä¹ˆå‘å±•ï¼Œå°±æ˜¯æ²¿ç€è€çš„æ€è·¯å®Œå–„äº†äº›ç»†èŠ‚ï¼Œæ·»åŠ äº†äº›ç»„ä»¶ï¼Œä½†æ˜¯æ ¹æœ¬æ€§çš„è®¾è®¡é—®é¢˜æ²¡æœ‰æ”¹è¿›ã€‚</p><h1 id="GTK"><a href="#GTK" class="headerlink" title="GTK"></a>GTK</h1><p>GTKï¼Œè¿™ä¸ªåƒäº†è¯­è¨€çš„äºï¼Œç”¨Cå†™é¢å‘å¯¹è±¡å®åœ¨æ˜¯ç—›è‹¦ï¼Œè™½ç„¶åœ¨æ€æƒ³ä¸Šæ¯”MFCè¦å…ˆè¿›äº†äº›ï¼Œä½†æ˜¯å†™å‡ºæ¥çš„ä»£ç æ¯”MFCè¦ç½—å—¦å¾ˆå¤šäº†ã€‚ç›¸æ¯”MFCï¼Œå¤šäº†Layoutçš„æ¦‚å¿µï¼Œäº‹ä»¶å¤„ç†ä¸Šæœ‰äº†Signal/slotï¼Œè™½ç„¶ç”¨èµ·æ¥å¾ˆéº»çƒ¦ã€‚</p><h1 id="wxWidget"><a href="#wxWidget" class="headerlink" title="wxWidget"></a>wxWidget</h1><p>wxWidgetsï¼Œè¿™ä¸ªåŸºæœ¬å°±æ˜¯ä¸ªè·¨å¹³å°çš„MFCï¼Œå¯¹å„ä¸ªå¹³å°çš„å·®å¼‚åšäº†æŠ½è±¡ï¼Œå®é™…ä¸Šåç«¯å¤§å¤šè¿˜æ˜¯ç”¨å¹³å°åŸç”Ÿçš„APIå®ç°ï¼Œå¥½å¤šæ§ä»¶éƒ½æ˜¯ç›´æ¥ç”¨ç³»ç»ŸåŸç”Ÿçš„ã€‚æœ‰wxWidgets for GTK+çš„ç‰ˆæœ¬ï¼Œåç«¯å°±æ˜¯GTK+ï¼ŒwxWidgetså°±æ˜¯ä¸€å±‚å£³ã€‚è¿™ä¹Ÿæ˜¯wxWidgetsçš„ä¼˜ç‚¹ï¼Œå®ƒç¼–è¯‘å‡ºæ¥çš„ç¨‹åºå‘è¡ŒåŒ…æ¯”è¾ƒå°ï¼Œæ€§èƒ½ä¹Ÿä¸é”™ã€‚<br>ä»¥ä¸Šè¿™äº›å°±æ˜¯ä¸Šä¸–çºª90å¹´ä»£çš„UI FrameworkæŠ€æœ¯æ°´å¹³äº†ï¼Œè‡³ä»Šå®ƒä»¬ä¹Ÿä¾ç„¶æ²¡æœ‰å¤ªå¤šè¿›æ­¥ã€‚<br>ä¸‹é¢æ¥è°ˆè°ˆ21ä¸–çºªçš„æŠ€æœ¯ã€‚</p><h1 id="Qt"><a href="#Qt" class="headerlink" title="Qt"></a>Qt</h1><p>Qtï¼Œè™½ç„¶å®ƒä¹Ÿæ˜¯ä¸Šä¸–çºª90å¹´ä»£å‡ºç°çš„ï¼Œä½†æ˜¯å®ƒåœ¨21ä¸–çºªæœ‰äº†é•¿è¶³çš„è¿›æ­¥ã€‚åº”è¯¥è¯´å®ƒçš„èµ·ç‚¹å°±æ¯”è¾ƒé«˜ï¼Œä¸€å¼€å§‹å°±å®šä½è·¨å¹³å°ï¼Œè€Œä¸”ä¸æ»¡è¶³äºç®€å•å°è£…ç³»ç»ŸAPIï¼Œè€Œæ˜¯è¦è‡ªå·±åˆ›é€ å‡ºä¸€å¥—å®Œæ•´çš„APIå’Œæ¡†æ¶ï¼Œç”šè‡³è¦ä»£æ›¿ç³»ç»ŸAPIï¼Œæ‰€ä»¥ä¸ä»…ä»…æ˜¯åšUIï¼Œè€Œæ˜¯æ¶‰åŠåˆ°äº†APPå¼€å‘æ‰€ç”¨åˆ°çš„æ‰€æœ‰ä¸œè¥¿ï¼ŒåŒ…æ‹¬ç½‘ç»œï¼Œæ•°æ®åº“ï¼Œå¤šåª’ä½“ï¼Œè„šæœ¬å¼•æ“ç­‰ã€‚signal/slotæ˜¯Qtå‘æ˜çš„ï¼Œè¿™æ˜¯äº‹ä»¶é€šçŸ¥æ¨¡å‹é‡ŒC++è¯­è¨€çš„æœ€ä½³å®ç°äº†ï¼Œç”šè‡³æˆ‘éƒ½è§‰å¾—è¿™è¯¥å†™è¿›C++æ ‡å‡†ï¼Œä¼°è®¡C++å§”å‘˜ä¼šçš„è€é¡½å›ºä»¬æ˜¯ä»ä¸å†™GUIçš„ã€‚<br>æ—©æœŸçš„QTä¹Ÿæ˜¯æ²¡æœ‰DirectUIçš„æ¦‚å¿µçš„ï¼Œæ¯ä¸€ä¸ªQWidgetéƒ½å¯¹åº”ä¸€ä¸ªåŸç”Ÿçª—å£ï¼Œä»Qt4.4å¼€å§‹ï¼Œåªæœ‰é¡¶å±‚QWidgetæ‰æ˜¯åŸç”Ÿçª—å£ï¼Œè€ŒChild Widgetæ˜¯Alien Widgetï¼Œåªæ˜¯ä¸ªæŠ½è±¡çš„å›¾å±‚ä¸å¯¹åº”åŸç”Ÿçª—å£ï¼Œè¿™å°±å®ç°äº†DirectUIçš„æ¦‚å¿µï¼Œå¾ˆå¤šå›¾å½¢æ•ˆæœä¹Ÿå°±å˜å¾—å¯èƒ½äº†ï¼Œæ¯”å¦‚çª—å£å±‚å é€æ˜æ•ˆæœã€‚<br>åœ¨4.8åå®ç°äº†QPA(Qt Platform Abstraction)ï¼Œè¿™å°±ä½¿ç§»æ¤Qtå˜å¾—å¾ˆå®¹æ˜“ï¼Œç›®å‰Qtæ˜¯æ”¯æŒå¹³å°æœ€å¤šçš„æ¡†æ¶æ²¡æœ‰ä¹‹ä¸€ã€‚<br>ç”±äºæ—©æœŸæˆæƒçš„é—®é¢˜ï¼ŒQtå¯¹äºå¼€æºç¤¾åŒºä¸æ˜¯å¾ˆå‹å¥½ï¼Œå¯¼è‡´æ¨å¹¿ä¸å¤ªé¡ºåˆ©ï¼Œç›´åˆ°å®ƒæ”¹æˆäº†LGPLæ–¹å¼ï¼Œå¦‚æœQtèƒ½æ—©ç‚¹æƒ³å¼€äº†ï¼Œææ€•å°±æ²¡æœ‰wxWidgetsçš„ç”Ÿå­˜ç©ºé—´äº†ã€‚<br>Qtçš„ç¼ºç‚¹ä¹Ÿæ˜¯æœ‰çš„ï¼Œå°±æ˜¯å¤ªå¤§ï¼Œä¸è¿‡å¯ä»¥è‡ªå·±å‰ªè£ï¼Œæˆ‘å¯ä»¥æŠŠQTåº“å‰ªè£åˆ°å‘è¡ŒåŒ…å‹ç¼©å2.5MBã€‚<br>WPFï¼Œå¾®è½¯åœ¨Win Formçš„æ€è·¯ä¸Šèµ°åˆ°æ­»èƒ¡åŒåï¼Œç»ˆäºç—›ä¸‹å†³å¿ƒç”¨æ­£ç¡®çš„æ–¹æ³•å¼€å‘UIåº“äº†ã€‚21ä¸–çºªçš„UIä¸€å®šæ˜¯å®šä¹‰å‡ºæ¥çš„ï¼Œç»å¯¹ä¸èƒ½æ˜¯ä»£ç å†™å‡ºæ¥çš„ï¼Œæ‰€ä»¥æœ‰äº†XAMLè¿™ä¸ªå¼ºå¤§çš„å®šä¹‰å·¥å…·ï¼Œä¸ä½†å¯ä»¥å®šä¹‰UIå¸ƒå±€ï¼Œè¿˜åŒ…æ‹¬å›¾å½¢åŠ¨ç”»æ•ˆæœï¼Œæ¶ˆæ¯å“åº”æ–¹å¼ç­‰ã€‚é…åˆC#è¿™ç§ä¼˜ç§€çš„è¯­è¨€ï¼Œæ›´æ˜¯å¦‚è™æ·»ç¿¼ã€‚ä½†æ˜¯é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯è¿‡äºåºå¤§ï¼Œä¸ä»…å¼€å‘æ—¶è¦ç”¨åˆ°åºå¤§çš„IDEå’Œè®¾è®¡å·¥å…·ï¼Œå‘è¡Œçš„å®‰è£…åŒ…ä¹Ÿååˆ†å·¨å¤§ï¼Œæ‰€ä»¥ç›®å‰è¿˜æ˜¯å¾ˆå°‘æœ‰äººæ‹¿ä»–å†™é€šç”¨è½¯ä»¶å®¢æˆ·ç«¯çš„ï¼Œå¤§å¤šæ˜¯åšä¼ä¸šé¡¹ç›®æ—¶å†™ä¸“ç”¨å®¢æˆ·ç«¯ã€‚<br>å¤§æ¦‚4-5å¹´å‰å§ç–¼è®¯æ›¾ç»ç”¨WPFå†™äº†ä¸ªQQï¼Œä½†æ˜¯åªå®ç°äº†åŸºæœ¬åŠŸèƒ½å°±å·²ç»æ¯”C++å®¢æˆ·ç«¯å¤§å¥½å¤šäº†ï¼Œè€Œä¸”è¿è¡Œç¼“æ…¢ï¼Œä¸»è¦æ˜¯å¤ªåƒå†…å­˜ï¼Œè€Œä¸”é‚£æ—¶WPFçš„ä¼˜åŒ–è¿˜ä¸å……åˆ†ã€‚<br>æœ€åæˆ‘æƒ³è¡¥å……ä¸‹çœŸæ­£çš„UIåº“ä¹‹ç‹ï¼Œcocoaã€‚</p><h1 id="cocoa"><a href="#cocoa" class="headerlink" title="cocoa"></a>cocoa</h1><p>Appleçš„æˆåŠŸæœ‰å¾ˆå¤šåŸå› ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯cocoaï¼Œcocoaç†å¿µååˆ†å…ˆè¿›ï¼Œè€Œä¸”å‡ºæ¥å¾—æ—©ï¼Œæˆ‘éƒ½æ€€ç–‘Qtå’ŒWPFæœ‰ä¸å°‘æ€æƒ³éƒ½æ˜¯å€Ÿé‰´cocoaçš„ã€‚<br>å®šä¹‰å¼çš„UIï¼Œç”¨xibå°±å¯ä»¥å®šä¹‰UIçš„ç»å¤§éƒ¨åˆ†ç»†èŠ‚ï¼Œè€Œä¸”æä¾›æ‰€è§å³æ‰€å¾—çš„å¯è§†åŒ–è®¾è®¡å·¥å…·ã€‚<br>ä¸¥æ ¼çš„MVCï¼Œè€Œä¸”å®šä¹‰éå¸¸æ¸…æ™°ï¼Œåˆ†å·¥æ˜ç¡®ã€‚<br>signal/slotï¼Œè™½ç„¶ä¸å«è¿™ä¸ªåå­—ï¼Œä½†æ€æƒ³å°±æ˜¯ï¼Œè€Œä¸”çœŸçš„æ˜¯æ‹–åŠ¨é¼ æ ‡å°±èƒ½connectã€‚<br>æä¾›äº†ARCï¼Œé—­åŒ…å’Œåå°„ï¼Œç»™UIå¼€å‘å¸¦æ¥å·¨å¤§çš„ä¾¿åˆ©æ€§ï¼Œå½“ç„¶è¿™å¾—ç›ŠäºObjective-Cè¿™ä¸ªè¯­è¨€ã€‚<br>å†è¡¥å……ä¸‹ Borlandçš„OWLå’ŒVCLã€‚<br>æˆ‘æ˜¯ä»Borland C++3.0å’ŒDelphi 1.0å¼€å§‹ç”¨çš„ï¼Œé‚£æ—¶çš„Borlandçœ‹æ¥å¾ˆæœ‰å‰é€”çš„ï¼Œå¯æƒœåæ¥ä¸€ç³»åˆ—å†³ç­–å¤±è¯¯å¯¼è‡´ç°åœ¨è¿™ä¸ªå…¬å¸å‡ ä¹æ¶ˆå¤±äº†ï¼ŒåŒå­¦ä»¬ä¸è¦å†å¾€è¿™ä¸ªå‘é‡Œè·³äº†ã€‚<br>OWLæ›¾ç»å’ŒMFCæ˜¯ç«äº‰å¯¹æ‰‹ï¼Œè®¾è®¡æ€æƒ³ä¹Ÿå·®ä¸å¤šï¼Œä¸ªäººæ„Ÿè§‰OWLçš„APIè®¾è®¡æ›´ä¼˜é›…ä¸€ç‚¹ï¼Œä½†æ˜¯åœ¨å¸‚åœºä¸ŠOWLè¢«MFCå½»åº•å‡»è´¥ã€‚</p><h1 id="Delphi"><a href="#Delphi" class="headerlink" title="Delphi"></a>Delphi</h1><p>Delphiæ˜¯ç¥ä½œï¼Œå®ƒåœ¨RADï¼ˆå¿«é€Ÿåº”ç”¨å¼€å‘ï¼‰é¢†åŸŸé•¿æ—¶é—´æ²¡æœ‰å¯¹æ‰‹ï¼Œç›´åˆ°BSæ¶æ„å–ä»£CSæ¶æ„ã€‚Delphiçš„ç‰¹ç‚¹å°±æ˜¯ç®€å•ã€å¼€å‘å¿«ï¼Œå•çº¯å°±å†™ä¸ªåŸºæœ¬å¯ç”¨çš„åº”ç”¨æ¥è¯´ï¼Œå¯èƒ½è‡³ä»Šéƒ½æ²¡æœ‰æ¯”ä»–æ›´å¿«çš„ï¼Œä½†æ˜¯ç¼ºç‚¹å°±æ˜¯ä¸‘ï¼ŒåŸºæœ¬å¤§å¤šæ•°Delphiåº”ç”¨éƒ½æ˜¯ä¸€å¤§å †æ§ä»¶å †ç§¯åœ¨ä¸€èµ·ï¼Œå¾ˆä¸ç¾è§‚ï¼Œå¦å¤–ç”±äºPascalè¯­è¨€çš„é™åˆ¶æ— æ³•å’Œç°æœ‰å¤§é‡çš„C/C++ä»£ç èåˆã€‚è™½ç„¶åæ¥æœ‰C++ Builderï¼Œä½†æ˜¯Builderé‡Œç®€å•å’Œå¿«çš„ä¼˜ç‚¹ä¹Ÿæ¶ˆå¤±äº†ã€‚Borlandçš„C++ç¼–è¯‘å™¨è¶Šåšè¶Šå·®ï¼Œå¯¼è‡´åæ¥å¼€æºé¡¹ç›®éƒ½ä¸å¤ªæ„¿æ„å…¼å®¹è¿™ä¸ªç¼–è¯‘å™¨äº†ã€‚</p><h1 id="VLC"><a href="#VLC" class="headerlink" title="VLC"></a>VLC</h1><p>VCLå‡†ç¡®åœ°è¯´ä¸æ˜¯UIåº“ï¼Œè€Œæ˜¯ä¸€å¥—ç»„ä»¶æ¥å£è§„èŒƒï¼Œç±»ä¼¼COM ActiveXã€‚delphiå’ŒC++builderéƒ½æ˜¯åŸºäºè¿™ä¸ªè§„èŒƒæ„å»ºäº†åŸºç¡€åº“ã€‚<br>UIåº“æ˜¯ä¸ªå¾ˆå¤§çš„è¯é¢˜ï¼Œå¤Ÿå†™å¥½å‡ æœ¬ä¹¦æ¥æ¢è®¨çš„ï¼Œæˆ‘è¿™é‡Œå°±æ˜¯éšä¾¿å†™ç‚¹è‡ªå·±çš„æ„Ÿå—ã€‚<br>å•çº¯è®¨è®ºæ¯ä¸ªåº“çš„ä¼˜åŠ£æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè€Œæ˜¯è¦æ”¾åˆ°å…·ä½“çš„åº”ç”¨åœºæ™¯é‡Œæ¥çœ‹ï¼Œæ¯ä¸ªåº“éƒ½æœ‰è‡ªå·±æ“…é•¿çš„åœºæ™¯ã€‚</p><h1 id="æ€»è®¡"><a href="#æ€»è®¡" class="headerlink" title="æ€»è®¡"></a>æ€»è®¡</h1><p>å¦‚æœä»…åœ¨Windowsä¸‹ï¼Œè¿½æ±‚ç¨‹åºå°å·§ï¼Œç”¨WTLï¼Œä¸è¶³çš„åœ°æ–¹è‡ªå·±å®ç°å»å§ï¼Œä½†æ˜¯è§†è§‰æ•ˆæœå°±å‘µå‘µäº†ã€‚<br>å¦‚æœå¯ä»¥å¤§ä¸€ç‚¹ï¼Œè¿˜è¦å¥½çœ‹ç‚¹ï¼Œé‚£å°±Qtã€‚<br>å¦‚æœå®Œå…¨ä¸åœ¨ä¹å¤§å°ï¼Œåªè¦è§†è§‰æ•ˆæœåä¸½ï¼Œå°±ç”¨WPFï¼Œå¦‚æœæŠŠå¼€å‘å·¥å…·ä»·æ ¼ä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œé‚£ä¹ˆåœŸè±ªæ‰ä¼šé€‰WPFå‘¢ã€‚<br>MFCå°±æ˜¯ä¸ªé¸¡è‚‹äº†ï¼Œé™¤éä½ ç°æœ‰çš„å·¥ç¨‹å¸ˆä¸ä¼šç”¨åˆ«çš„ï¼Œæˆ–è€…æœ‰å†å²é—ç•™ä»£ç è¦ä¿æŒå…¼å®¹ã€‚<br>å¦‚æœè¦æ±‚è·¨å¹³å°ï¼Œé‚£ä¹ˆå°±ç”¨Qtï¼ŒwxWidgetså’ŒGTK+è·Ÿç°åœ¨çš„Qtæ¯”èµ·æ¥æ²¡æœ‰ä»€ä¹ˆä¼˜åŠ¿äº†ã€‚<br>å¦‚æœæ˜¯iOS Androidï¼Œé‚£ä¹ˆæœ€å¥½ç”¨åŸç”ŸUIåº“ï¼Œé™¤éä½ å†™æ¸¸æˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºQtçš„å†å²</title>
      <link href="/2020/06/28/guan-yu-qt-de-li-shi/"/>
      <url>/2020/06/28/guan-yu-qt-de-li-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="ç‰ˆæƒå£°æ˜"><a href="#ç‰ˆæƒå£°æ˜" class="headerlink" title="ç‰ˆæƒå£°æ˜"></a>ç‰ˆæƒå£°æ˜</h1><p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œæœ¬æ–‡ç« éµå¾ªåè®®<a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC 4.0 BY-SA</a>ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚<br>æœ¬æ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/u011012932/article/details/49826231" target="_blank" rel="noopener">https://blog.csdn.net/u011012932/article/details/49826231</a></p><h1 id="ä»€ä¹ˆæ˜¯Qt"><a href="#ä»€ä¹ˆæ˜¯Qt" class="headerlink" title="ä»€ä¹ˆæ˜¯Qt"></a>ä»€ä¹ˆæ˜¯Qt</h1><p>Qtæ˜¯ä¸€ä¸ªé’ˆå¯¹æ¡Œé¢ã€åµŒå…¥å¼ã€ç§»åŠ¨è®¾å¤‡çš„ä¸€ä¸ªè·¨å¹³å°çš„åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ï¼Œæ”¯æŒçš„å¹³å°åŒ…æ‹¬Linuxã€OS Xã€Windowsã€VxWorksã€QNXã€Androidã€iOSã€BlackBerry(é»‘è“)ã€Sailfish OSï¼ˆæ——é±¼æ“ä½œç³»ç»Ÿï¼‰ç­‰ã€‚<br>Qt 1991å¹´ç”±Trolltech-å¥‡è¶£ç§‘æŠ€ï¼ˆæˆç«‹äº1994å¹´ï¼‰å¼€å‘ï¼Œ2008å¹´ï¼ŒTrolltechè¢«Nokiaæ”¶è´­ï¼Œ2012å¹´ï¼ŒQtè¢«Digiaæ”¶è´­ã€‚<br>Qtæ˜¯åŸºäºC++ç¼–å†™çš„æ¡†æ¶ï¼Œå®ƒæ—¢å¯ä»¥å¼€å‘GUIç¨‹åºï¼Œä¹Ÿå¯ç”¨äºå¼€å‘éGUIç¨‹åºï¼Œæ¯”å¦‚æ§åˆ¶å°å·¥å…·å’ŒæœåŠ¡å™¨ã€‚é¢„å¤„ç†å™¨ï¼ŒMOCï¼ˆå…¨ç§°ï¼šMeta-Object Compiler-å…ƒå¯¹è±¡ç¼–è¯‘å™¨ï¼‰ç”¨äºæ‰©å±•C++ï¼Œå¦‚ï¼šä¿¡å·å’Œæ§½çš„ç‰¹æ€§ã€‚åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œå…ˆä½¿ç”¨MOCåˆ†æQtæ‰©å±•çš„C++æºæ–‡ä»¶ï¼ˆæ£€æµ‹æ˜¯å¦åŒ…å«Q_OBJECTå®ï¼‰ï¼Œç„¶åç”Ÿæˆç¬¦åˆC++æ ‡å‡†çš„æºæ–‡ä»¶ï¼ˆæ–°æ–‡ä»¶åå°†ä¼šç”±moc_åŠ ä¸ŠåŸæ–‡ä»¶åæ„æˆï¼‰ã€‚å› æ­¤æ¡†æ¶æœ¬èº«å’Œåº”ç”¨ç¨‹åº/åº“ä½¿ç”¨å®ƒèƒ½è¢«ä»»ä½•ç¬¦åˆæ ‡å‡†C++çš„ç¼–è¯‘å™¨ï¼ˆåƒClangã€GCCã€ ICCã€MinGW å’ŒMSVCï¼‰æ‰€ç¼–è¯‘ã€‚</p><h1 id="å‘å±•å²"><a href="#å‘å±•å²" class="headerlink" title="å‘å±•å²"></a>å‘å±•å²</h1><p>Qtçš„ç¬¬ä¸€ä¸ªå•†ä¸šç‰ˆæœ¬äº1995å¹´æ¨å‡ºï¼ŒéšåQtçš„å‘å±•å°±å¾ˆå¿«äº†ï¼Œä¸‹é¢æ˜¯Qtå‘å±•å²ä¸Šçš„ä¸€ äº›é‡Œç¨‹ç¢‘ï¼Œä»ä¹‹å‰çš„Qt1.xå¼€å§‹åˆ°ç°åœ¨çš„Qt5.xã€‚</p><h2 id="Qt1-3"><a href="#Qt1-3" class="headerlink" title="Qt1-3"></a>Qt1-3</h2><table><thead><tr><th align="center">ç‰ˆæœ¬</th><th>å‘å¸ƒæ—¥æœŸ</th></tr></thead><tbody><tr><td align="center">1.40</td><td>10 July 1998</td></tr><tr><td align="center">1.41</td><td>2 October 1998</td></tr><tr><td align="center">1.42</td><td>19 December 1998</td></tr><tr><td align="center">1.44</td><td>13 March 1999</td></tr><tr><td align="center">2.0</td><td>26 June 1999</td></tr><tr><td align="center">2.1</td><td>13 April 2000</td></tr><tr><td align="center">2.2</td><td>7 December 2000</td></tr><tr><td align="center">2.3</td><td>8 March 2001</td></tr><tr><td align="center">3.0</td><td>16 October 2001</td></tr><tr><td align="center">3.1</td><td>14 November 2001</td></tr><tr><td align="center">3.2</td><td>24 July 2003</td></tr><tr><td align="center">3.3</td><td>5 February 2004</td></tr></tbody></table><h2 id="Qt4"><a href="#Qt4" class="headerlink" title="Qt4"></a>Qt4</h2><p>Trolltechåœ¨2005å¹´6æœˆ28å‘å¸ƒäº†Qt4.0ï¼Œä»‹ç»äº†æ¡†æ¶çš„äº”ä¸ªæ–°æŠ€æœ¯ï¼š</p><ul><li>ä¸€å¥—æ¨¡æ¿å®¹å™¨ç±»</li><li>ä¸ºitem viewsæä¾›äº†ä¸€å¥—æ¨¡å‹ - è§†å›¾ - æ§åˆ¶å™¨ä½“ç³»ç»“æ„</li><li>äºŒç»´ç»˜å›¾æ¡†æ¶<ul><li>ä¸ºä½çº§æ–‡æœ¬å¸ƒå±€æä¾›äº†Unicodeæ–‡æœ¬æ¸²æŸ“å™¨çš„å…¬å…±API</li></ul></li><li>åŸºäºActionçš„MainWindowï¼ŒåŒ…æ‹¬ï¼šå·¥å…·æ ï¼Œèœå•å’Œåœé ä½“ç³»</li></ul><table><thead><tr><th align="center">ç‰ˆæœ¬</th><th>å‘å¸ƒæ—¥æœŸ</th><th align="center">æ–°ç‰¹æ€§</th></tr></thead><tbody><tr><td align="center">4.1</td><td>20 December 2005</td><td align="center">æ¨å‡ºé›†æˆSVGå¾®å°çš„æ”¯æŒï¼Œä¸€ä¸ªPDFçš„åç«¯Qtæ‰“å°ç³»ç»Ÿï¼Œä»¥åŠå…¶ä»–ä¸€äº›åŠŸèƒ½ã€‚</td></tr><tr><td align="center">4.2</td><td>4 October 2006</td><td align="center">ä»‹ç»äº†Windows Vistaçš„æ”¯æŒï¼Œéƒ¨ä»¶çš„CSSæ ·å¼æ”¯æŒï¼Œä»¥åŠQGraphicsViewæ¡†æ¶-åœ¨å±å¹•ä¸Šé«˜æ•ˆæ¸²æŸ“æˆåƒä¸Šä¸‡ä¸ª2Då¯¹è±¡ï¼Œä»¥å–ä»£Qt3.xä¸­çš„QCanvasç±»ã€‚</td></tr><tr><td align="center">4.3</td><td>30 May 2007</td><td align="center">æ”¹è¿›äº†Windows Vistaæ”¯æŒï¼Œæ”¹è¿›äº†OpenGLå¼•æ“ã€SVGæ–‡ä»¶çš„ç”Ÿæˆï¼Œå¢åŠ äº†QtScriptï¼ˆåŸºäºQSAçš„ECMAScriptè„šæœ¬å¼•æ“ï¼‰ã€‚</td></tr><tr><td align="center">4.4</td><td>6 May 2008</td><td align="center">ç‰¹æ€§åŒ…å«äº†æ”¹è¿›multimediaçš„æ”¯æŒï¼ˆä½¿ç”¨Phononï¼‰ï¼Œå¢å¼ºXMLæ”¯æŒï¼Œé›†ä¸­å…±äº«å†…å­˜çš„IPCæ¡†æ¶ï¼Œä»¥åŠWebKité›†æˆã€‚</td></tr><tr><td align="center">4.5</td><td>3 March 2009</td><td align="center">ä¸»è¦åŒ…æ‹¬åŠŸèƒ½æœ‰QtCreatorï¼Œæ”¹è¿›å›¾å½¢å¼•æ“ï¼ŒWebKitçš„é›†æˆï¼ŒOpenDocumentæ ¼å¼å†™å…¥æ”¯æŒå’Œæ–°çš„è®¸å¯é€‰é¡¹ï¼Œä»¥åŠOS X Cocoaæ¡†æ¶çš„æ”¯æŒã€‚</td></tr><tr><td align="center">4.6</td><td>1 December 2009</td><td align="center">æ–°çš„APIæ¡†æ¶-åŠ¨ç”»ã€æ‰‹åŠ¿ã€å¤šç‚¹è§¦æ§ã€‚æ”¯æŒSymbianã€Windows 7å’ŒMac OS X 10.6ï¼Œæ”¯æŒæ‰©å±•ä¸€äº›Unixç³»ç»Ÿã€‚ä¹Ÿå–å¾—äº†æ•´ä½“æ€§èƒ½çš„æ”¹è¿›ã€‚</td></tr><tr><td align="center">4.7</td><td>21 September 2010</td><td align="center">QML å’Œ Qt Quick</td></tr><tr><td align="center">4.8</td><td>15 December 2011</td><td align="center">Qtçš„å¹³å°æŠ½è±¡åŒ–ï¼Œæ”¯æŒå•çº¿ç¨‹OpenGLï¼Œå¤šçº¿ç¨‹HTTPï¼Œä¼˜åŒ–äº†æ–‡ä»¶ç³»ç»Ÿè®¿é—®ã€‚</td></tr></tbody></table><h2 id="Qt5"><a href="#Qt5" class="headerlink" title="Qt5"></a>Qt5</h2><p>Qt5äº2012å¹´12æœˆ19æ­£å¼å‘å¸ƒï¼Œè¿™ä¸ªæ–°ç‰ˆæœ¬æ ‡å¿—ç€å¹³å°çš„é‡å¤§å˜åŒ–ï¼Œç¡¬ä»¶åŠ é€Ÿçš„æ˜¾å¡ï¼ŒQMLå’ŒJavaScriptå‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚ä¼ ç»Ÿçš„C++ - ä»…QWidgetsç»§ç»­å¾—åˆ°æ”¯æŒï¼Œä½†æ²¡æœ‰ä»æ–°ä½“ç³»ç»“æ„çš„æ€§èƒ½æ”¹è¿›ä¸­å—ç›Šï¼ŒQt5å¸¦æ¥äº†é€Ÿåº¦åŠç”¨æˆ·ç•Œé¢ä¸Šçš„æ˜¾è‘—æ”¹è¿›ï¼ŒQt5å¼€å‘æ¡†æ¶ç§»åŠ¨è‡³qt-project.orgã€‚å¤–éƒ¨å¼€å‘è€…å¯ä»¥ä¸ºDigiaå…¬å¸æäº¤è¡¥ä¸ï¼Œå¹¶è®©ä»–ä»¬å®¡æŸ¥ã€‚</p><table><thead><tr><th align="center">ç‰ˆæœ¬</th><th align="left">å‘å¸ƒæ—¥æœŸ</th><th>æ–°ç‰¹æ€§</th></tr></thead><tbody><tr><td align="center">5.0</td><td align="left">19 December 2012</td><td>å¯¹Qt4.xè¿›è¡Œä¸€ç³»åˆ—é‡å¤§æ”¹é©ã€‚å®ŒæˆWaylandçš„æ”¯æŒã€‚</td></tr><tr><td align="center">5.1</td><td align="left">3 July 2013</td><td>æ–°æ¨¡å—ä»¥åŠAndroidå’ŒiOSå®éªŒæ€§çš„æ”¯æŒæŠ€æœ¯é¢„è§ˆã€‚</td></tr><tr><td align="center">5.2</td><td align="left">12 December 2013</td><td>ç¬¬ä¸€ä¸ªå®˜æ–¹æ”¯æŒAndroidå’ŒiOSçš„ç‰ˆæœ¬ã€‚</td></tr><tr><td align="center">5.3</td><td align="left">20 May 2014</td><td>é›†ä¸­äºç¨³å®šæ€§å’Œå¯ç”¨æ€§</td></tr><tr><td align="center">5.4</td><td align="left">10 December 2014</td><td>å®Œæ•´çš„WinRTå’ŒWindows Phoneæ”¯æŒã€‚ä»‹ç»åŸºäºChromiumçš„Qt WebEngineå†…éƒ¨ç»„ä»¶ï¼Œå°†åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å–ä»£QtWebKitã€‚åŠ¨æ€çš„GLå›¾å½¢åˆ‡æ¢åœ¨Windowsï¼ˆANGLEæˆ–OpenGLï¼‰åå°ï¼Œæœ¬åœ°åŒ–çš„â€œå¤–è§‚å’Œæ„Ÿè§‰â€åœ¨QtQuickçš„æ§åˆ¶åœ¨Androidå¹³å°çš„åç«¯ï¼Œå¼•å…¥Qt WebChannelsæä¾›QObjectåˆ°WebSocketsçš„æ¡¥æ¢ã€‚æœ€åˆä»…ä½¿ç”¨Qt WebKitçš„é›†æˆï¼Œä½†è¿˜æ­£åœ¨5.5ä¸‹è¿›è¡ŒQt WebEngineé›†æˆ</td></tr><tr><td align="center">5.5</td><td align="left">1 July 2015</td><td>Qt5.5æ ¹æ®å®˜æ–¹ç½‘ç«™æä¾›çš„åŠŸèƒ½ï¼šæ–°æ¨¡å—ï¼š Qt 3Dã€Qt Canvas 3Dã€Qt Locationã€‚è¿‡æ—¶çš„æ¨¡å—çš„ï¼šQt WebKitã€Qt Declarative (Qt Quick 1)ã€Qt Scriptã€‚è“ç‰™APIçš„æœ€ç»ˆç‰ˆæœ¬ï¼Œæ–°çš„è§†é¢‘è¿‡æ»¤æ¡†æ¶ï¼ŒCameraå’ŒQML MediaPlayeræ”¹å–„iOSï¼Œé€‚ç”¨äºLinuxçš„NFCï¼ŒSSL/TLSæ”¹è¿›Qt Network</td></tr><tr><td align="center">5.6</td><td align="left">Alpha release: 8 September 2015 Final release plan: 8 December 2015</td><td>å€¼å¾—æ³¨æ„çš„æ”¹è¿›ï¼šQt Coreï¼šä¸€äº›æ€§èƒ½æ”¹è¿›ï¼ŒåŒ…æ‹¬å‡å°‘åŠ¨æ€æ€§èƒ½çš„å†…å­˜ä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½æœ€ä½³åŒ–çš„QString Qt Networkï¼šæ”¯æŒHTTPé‡å®šå‘ Qt GUIï¼šæ”¹è¿›äº†è·¨å¹³å°çš„OpenGL ES3.0å’Œ3.1 Qt Multimediaï¼šæ·»åŠ QMLç±»å‹æ’­æ”¾åˆ—è¡¨ Qt WebEngineï¼šåŸºäºChromium 45ï¼Œè‡ªå®šä¹‰URLæ–¹æ¡ˆçš„APIï¼Œæ‹¦æˆªå’Œé˜»æ­¢ç½‘ç»œè¯·æ±‚ï¼Œå¹¶è·Ÿè¸ªæˆ–é˜»æ­¢Cookie QtQMLï¼šå‡å°‘å†…å­˜æ¶ˆè€— åµŒå…¥å¼å¹³å°ï¼šæ”¯æŒIntel Atom-based NUCs è¿‡æ—¶çš„æ¨¡å—ï¼šQt Scriptã€Qt Enginio å·²åˆ é™¤æ¨¡å—ï¼šQt WebKit, Qt Declarative (Qt Quick 1)</td></tr></tbody></table><h1 id="å¹³å°æ”¯æŒ"><a href="#å¹³å°æ”¯æŒ" class="headerlink" title="å¹³å°æ”¯æŒ"></a>å¹³å°æ”¯æŒ</h1><p>Qtæ”¯æŒä¸‹è¿°å¹³å°ï¼š</p><ul><li>MS/Windows - 95ã€98ã€NT4.0ã€MEã€2000ã€XP ã€Vistaã€Win7ã€win8ã€win2008ã€win10<ul><li>Unix/X11-Linuxã€SunSolarisã€HP-UXã€CompaqTru64 UNIXã€IBMAIXã€SGI IRIXã€FreeBSDã€BSD/OSå’Œå…¶å®ƒå¾ˆå¤šX11å¹³å°</li><li>Macintosh -Mac OS X</li><li>Embedded - æœ‰å¸§ç¼“å†²(framebuffer)æ”¯æŒçš„åµŒå…¥å¼Linuxå¹³å°ï¼ŒWindows CE</li><li>Symbianã€Symbian^3ã€Symbian Annaã€Symbian Belleã€MeeGo<h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2>QtåŒX Windowä¸Šçš„ Motifã€Openwinã€GTK ç­‰å›¾å½¢ç•Œé¢åº“å’Œ Windowså¹³å°ä¸Šçš„ MFCã€OWLã€VCLã€ATLæ˜¯åŒç±»å‹çš„ä¸œè¥¿ï¼Œä½†æ˜¯ Qt å…·æœ‰ä¸‹åˆ—ä¼˜ç‚¹ï¼š</li></ul></li></ul><h3 id="ä¼˜è‰¯çš„è·¨å¹³å°ç‰¹æ€§"><a href="#ä¼˜è‰¯çš„è·¨å¹³å°ç‰¹æ€§" class="headerlink" title="ä¼˜è‰¯çš„è·¨å¹³å°ç‰¹æ€§"></a>ä¼˜è‰¯çš„è·¨å¹³å°ç‰¹æ€§</h3><ul><li>Qtæ”¯æŒä¸‹åˆ—æ“ä½œç³»ç»Ÿ: Microsoft Windows 95/98ï¼Œ Microsoft Windows NTï¼Œ Linuxï¼Œ Solarisï¼Œ SunOSï¼Œ HP-UXï¼Œ Digital UNIX (OSF/1ï¼Œ Tru64)ï¼Œ Irixï¼Œ FreeBSDï¼Œ BSD/OSï¼Œ SCOï¼Œ AIXï¼Œ OS390ï¼ŒQNX ç­‰ç­‰ã€‚</li></ul><h3 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h3><ul><li>Qt çš„è‰¯å¥½å°è£…æœºåˆ¶ä½¿å¾— Qt çš„æ¨¡å—åŒ–ç¨‹åº¦éå¸¸é«˜ï¼Œå¯é‡ç”¨æ€§è¾ƒå¥½ï¼Œå¯¹äºç”¨æˆ·å¼€å‘æ¥è¯´æ˜¯éå¸¸ æ–¹ä¾¿çš„ã€‚ Qt æä¾›äº†ä¸€ç§ç§°ä¸º signals/slots çš„å®‰å…¨ç±»å‹æ¥æ›¿ä»£ callbackï¼Œè¿™ä½¿å¾—å„ä¸ªå…ƒä»¶ ä¹‹é—´çš„ååŒå·¥ä½œå˜å¾—ååˆ†ç®€å•ã€‚<h3 id="ä¸°å¯Œçš„-API"><a href="#ä¸°å¯Œçš„-API" class="headerlink" title="ä¸°å¯Œçš„ API"></a>ä¸°å¯Œçš„ API</h3></li><li>QtåŒ…æ‹¬å¤šè¾¾250ä¸ªä»¥ä¸Šçš„C++ç±»ï¼Œè¿˜æ›¿ä¾›åŸºäºæ¨¡æ¿çš„collectionsã€serializationã€ fileã€I/O deviceã€ directory managementã€date/time ç±»ã€‚ç”šè‡³è¿˜åŒ…æ‹¬æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†åŠŸèƒ½ã€‚<h3 id="æ”¯æŒ-2D-3D-å›¾å½¢æ¸²æŸ“ï¼Œæ”¯æŒ-OpenGL"><a href="#æ”¯æŒ-2D-3D-å›¾å½¢æ¸²æŸ“ï¼Œæ”¯æŒ-OpenGL" class="headerlink" title="æ”¯æŒ 2D/3D å›¾å½¢æ¸²æŸ“ï¼Œæ”¯æŒ OpenGL"></a>æ”¯æŒ 2D/3D å›¾å½¢æ¸²æŸ“ï¼Œæ”¯æŒ OpenGL</h3><h3 id="å¤§é‡çš„å¼€å‘æ–‡æ¡£"><a href="#å¤§é‡çš„å¼€å‘æ–‡æ¡£" class="headerlink" title="å¤§é‡çš„å¼€å‘æ–‡æ¡£"></a>å¤§é‡çš„å¼€å‘æ–‡æ¡£</h3><h3 id="XML-æ”¯æŒ"><a href="#XML-æ”¯æŒ" class="headerlink" title="XML æ”¯æŒ"></a>XML æ”¯æŒ</h3></li></ul><h1 id="Qt-Creator"><a href="#Qt-Creator" class="headerlink" title="Qt Creator"></a>Qt Creator</h1><p>ç®€ä»‹<br>åœ¨å‘å¸ƒ Qt 4.6 çš„åŒæ—¶ï¼Œä½œä¸º Qt å¼€å‘è·¨å¹³å° IDE çš„Qt Creatorä¹Ÿå‘å¸ƒäº†æ›´æ–°ç‰ˆæœ¬ã€‚Qt Creator 1.3 å’Œ Qt 4.6å…±åŒæ„æˆçš„ Qt SDKï¼ŒåŒ…å«äº†å¼€å‘è·¨å¹³å°åº”ç”¨ç¨‹åºæ‰€éœ€çš„å…¨éƒ¨åŠŸèƒ½ã€‚</p><p>Qt Creatoræ˜¯ä¸€ä¸ªç”¨äºQtå¼€å‘çš„è½»é‡çº§è·¨å¹³å°é›†æˆå¼€å‘ç¯å¢ƒã€‚Qt Creatorå¯å¸¦æ¥ä¸¤å¤§å…³é”®ç›Šå¤„ï¼šæä¾›é¦–ä¸ªä¸“ä¸ºæ”¯æŒè·¨å¹³å°å¼€å‘è€Œè®¾è®¡çš„é›†æˆå¼€å‘ç¯å¢ƒ (IDE)ï¼Œå¹¶ç¡®ä¿é¦–æ¬¡æ¥è§¦Qtæ¡†æ¶çš„å¼€å‘äººå‘˜èƒ½è¿…é€Ÿä¸Šæ‰‹å’Œæ“ä½œã€‚å³ä½¿ä¸å¼€å‘Qtåº”ç”¨ç¨‹åºï¼ŒQt Creatorä¹Ÿæ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨ä¸”åŠŸèƒ½å¼ºå¤§çš„IDEã€‚</p><p>Qt Creator åŒ…æ‹¬é¡¹ç›®ç”Ÿæˆå‘å¯¼ã€é«˜çº§çš„ C++ ä»£ç ç¼–è¾‘å™¨ã€æµè§ˆæ–‡ä»¶åŠç±»çš„å·¥å…·ã€é›†æˆäº† Qt Designerã€Qt Assistantã€Qt Linguistã€å›¾å½¢åŒ–çš„ GDB è°ƒè¯•å‰ç«¯ï¼Œé›†æˆ qmake æ„å»ºå·¥å…·ç­‰ã€‚<br>åŠŸèƒ½å’Œä¼˜åŠ¿</p><p>QtCreator ä¸»è¦æ˜¯ä¸ºäº†å¸®åŠ©æ–° Qt ç”¨æˆ·æ›´å¿«é€Ÿå…¥é—¨å¹¶è¿è¡Œé¡¹ç›®ï¼Œè¿˜å¯æé«˜æœ‰ç»éªŒçš„ Qt å¼€å‘äººå‘˜çš„å·¥ä½œæ•ˆç‡ã€‚</p><p>ä½¿ç”¨å¼ºå¤§çš„ C++ ä»£ç ç¼–è¾‘å™¨å¯å¿«é€Ÿç¼–å†™ä»£ç </p><p>è¯­æ³•æ ‡è¯†å’Œä»£ç å®ŒæˆåŠŸèƒ½è¾“å…¥æ—¶è¿›è¡Œé™æ€ä»£ç æ£€éªŒä»¥åŠæç¤ºæ ·å¼ä¸Šä¸‹æ–‡ç›¸å…³çš„å¸®åŠ©ä»£ç æŠ˜å æ‹¬å·åŒ¹é…å’Œæ‹¬å·é€‰æ‹©æ¨¡å¼é«˜çº§ç¼–è¾‘åŠŸèƒ½</p><p> ä½¿ç”¨æµè§ˆå·¥å…·ç®¡ç†æºä»£ç </p><p>é›†æˆäº†é¢†å…ˆçš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ï¼ŒåŒ…æ‹¬ Gitã€Perforce å’Œ Subversionå¼€æ”¾å¼æ–‡ä»¶ï¼Œæ— é¡»çŸ¥æ™“ç¡®åˆ‡çš„åç§°æˆ–ä½ç½®æœç´¢ç±»å’Œæ–‡ä»¶è·¨ä¸åŒä½ç½®æˆ–æ–‡ä»¶æ²¿ç”¨ç¬¦å·åœ¨å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶ï¼Œæˆ–åœ¨å£°æ˜å’Œå®šä¹‰ä¹‹é—´åˆ‡æ¢ä¸ºQtè·¨å¹³å°å¼€å‘äººå‘˜çš„éœ€æ±‚è€Œé‡èº«å®šåˆ¶</p><p>é›†æˆäº†ç‰¹å®šäº Qt çš„åŠŸèƒ½ï¼Œå¦‚ä¿¡å·ä¸æ§½ (Signals &amp; Slots)å›¾ç¤ºè°ƒè¯•å™¨ï¼Œ å¯¹ Qt ç±»ç»“æ„å¯ä¸€ç›®äº†ç„¶é›†æˆäº† Qt Designer å¯è§†åŒ–å¸ƒå±€å’Œæ ¼å¼æ„å»ºå™¨åªéœ€å•å‡»ä¸€ä¸‹å°±å¯ç”Ÿæˆå’Œè¿è¡Œ Qt é¡¹ç›®</p><h1 id="Qt-Designer"><a href="#Qt-Designer" class="headerlink" title="Qt Designer"></a>Qt Designer</h1><p>Qt Designerè¢«ç§°ä¸ºQtè®¾è®¡å¸ˆï¼Œç”¨äºè®¾è®¡å’Œæ„å»ºå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆQt Widgetsï¼‰ã€‚ä½ å¯ä»¥ç»„åˆå’Œè‡ªå®šä¹‰çª—å£æˆ–å¯¹è¯æ¡†ï¼ˆæ‰€è§å³æ‰€å¾—ï¼‰ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„é£æ ¼å’Œåˆ†è¾¨ç‡è¿›è¡Œæµ‹è¯•ã€‚ç”¨Qt Designeråˆ›å»ºçš„çª—å£éƒ¨ä»¶å’Œè¡¨æ ¼æ— ç¼é›†æˆç¼–ç¨‹ä»£ç ï¼Œé‡‡ç”¨Qtä¿¡å·å’Œæ§½æœºåˆ¶ï¼Œè¿™æ ·å°±å¯ä»¥è½»æ¾åœ°åˆ†é…å›¾å½¢å…ƒç´ çš„è¡Œä¸ºã€‚åœ¨Qtè®¾è®¡å¸ˆä¸­è®¾ç½®çš„æ‰€æœ‰å±æ€§å¯ä»¥åŠ¨æ€åœ°åœ¨ä»£ç ä¸­è¿›è¡Œæ›´æ”¹ã€‚æ­¤å¤–ï¼Œç±»ä¼¼æ’ä»¶æ¨å¹¿å’Œè‡ªå®šä¹‰æ’ä»¶åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç»„ä»¶æ¥ä½¿ç”¨Qt Designerã€‚<br>æ³¨æ„ï¼šä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨Qt Quickæ¥è®¾è®¡ç”¨æˆ·ç•Œé¢ï¼Œè€Œä¸æ˜¯Qt Widgetsã€‚è¿™æ ·æ›´å®¹æ˜“å†™å„ç§å„æ ·çš„åº”ç”¨ã€‚å®ƒå¯ä»¥å®Œå…¨å®šåˆ¶å¤–è§‚ï¼Œè§¦æ‘¸ååº”çš„å…ƒç´ ï¼Œæµç•…çš„åŠ¨ç”»è¿‡æ¸¡ï¼Œæ”¯æŒOpenGLå›¾å½¢åŠ é€ŸåŠŸèƒ½ã€‚å¦‚æœåˆšæ¥è§¦Qt Designerï¼Œå¯ä»¥çœ‹çœ‹Qtè®¾è®¡å¸ˆæ–‡æ¡£ã€‚æœ‰å…³å¦‚ä½•ä½¿ç”¨Qtè®¾è®¡å¸ˆï¼Œè¯·å‚é˜…Qtè®¾è®¡å¸ˆå¿«é€Ÿå…¥é—¨ã€‚</p><h1 id="Qt-Linguist"><a href="#Qt-Linguist" class="headerlink" title="Qt Linguist"></a>Qt Linguist</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Qt Linguistè¢«ç§°ä¸ºQtè¯­è¨€å®¶ã€‚ä¸»è¦ä»»åŠ¡æ˜¯è¯»å–ç¿»è¯‘æ–‡ä»¶ã€ä¸ºç¿»è¯‘äººå‘˜æä¾›å‹å¥½çš„ç¿»è¯‘ç•Œé¢ï¼Œæ˜¯ç”¨äºç•Œé¢å›½é™…åŒ–çš„é‡è¦å·¥å…·ã€‚å®ƒèƒ½å¸®åŠ©ä½ å¾ˆå®¹æ˜“è¯»æ‡‚C++è¯­è¨€ã€‚<br>ä½¿ç”¨æ–¹å¼<br>lupdateå¯ä»¥æŠŠ.hã€.cppã€.uiä¸­éœ€è¦ç¿»è¯‘çš„å­—ç¬¦ä¸²æå–å‡ºæ¥å½¢æˆ.tsæ–‡ä»¶ï¼Œç„¶åç”¨linguistç¿»è¯‘ã€‚ç”¨lerealseç”Ÿæˆ.qmã€‚<br>ç¿»è¯‘ä¸€ä¸ªå«æœ‰tr()è°ƒç”¨çš„Qtåº”ç”¨ç¨‹åºéœ€è¦ä»¥ä¸‹ä¸‰æ­¥ï¼š</p><ol><li>è¿è¡Œludateï¼Œä»åº”ç”¨ç¨‹åºçš„æºä»£ç ä¸­æå–æ‰€æœ‰ç”¨æˆ·å¯è§çš„å­—ç¬¦ä¸²ã€‚</li><li>ä½¿ç”¨Qt Linguistç¿»è¯‘è¯¥åº”ç”¨ç¨‹åºã€‚</li><li>è¿è¡Œlreleaseï¼Œç”ŸæˆäºŒè¿›åˆ¶.qmæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨QTranslatoråŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚<br>å¦‚æœå¼€å‘å·¥ç¨‹ä¸­å‡ºç°ç¿»è¯‘æ”¹åŠ¨ï¼Œå¯ä»¥å¤šæ¬¡æ‰§è¡Œæ­¤è¿‡ç¨‹ï¼</li></ol><h1 id="Qt-Assistant"><a href="#Qt-Assistant" class="headerlink" title="Qt Assistant"></a>Qt Assistant</h1><p>Qt Assistantè¢«ç§°ä¸ºQtåŠ©æ‰‹ï¼Œæ˜¯Qtè‡ªå¸¦çš„ä¸€æ¬¾å¯å®šåˆ¶ã€å¯é‡æ–°å‘è¡Œçš„å¸®åŠ©æ–‡ä»¶æµè§ˆå™¨ã€‚å®ƒæ”¯æŒHTMLæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥åˆ©ç”¨å…¶å®šåˆ¶è‡ªå·±çš„åŠŸèƒ½å¼ºå¤§çš„å¸®åŠ©æ–‡æ¡£æµè§ˆå™¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtç®€ä»‹</title>
      <link href="/2020/06/28/qt-jian-jie/"/>
      <url>/2020/06/28/qt-jian-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h1><p>æœ¬æ–‡ç« éµå¾ªåè®® åŸæ–‡é“¾æ¥ <a href="https://www.devbean.net/2012/08/qt-study-road-2-qt-intro/" target="_blank" rel="noopener">è±†å­</a></p><p><a href="https://creativecommons.org/licenses/by-nd/3.0/deed.zh" target="_blank" rel="noopener">çŸ¥è¯†å…±äº«ç½²å-ç¦æ­¢æ¼”ç» 3.0 æœªæœ¬åœ°åŒ–ç‰ˆæœ¬è®¸å¯åè®®</a></p><h1 id="Qtç®€ä»‹"><a href="#Qtç®€ä»‹" class="headerlink" title="Qtç®€ä»‹"></a>Qtç®€ä»‹</h1><p>Qt æ˜¯ä¸€ä¸ªè‘—åçš„ C++ åº”ç”¨ç¨‹åºæ¡†æ¶ã€‚ä½ å¹¶ä¸èƒ½è¯´å®ƒåªæ˜¯ä¸€ä¸ª GUI åº“ï¼Œå› ä¸º Qt ååˆ†åºå¤§ï¼Œå¹¶ä¸ä»…ä»…æ˜¯ GUI ç»„ä»¶ã€‚ä½¿ç”¨ Qtï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šä½ è·å¾—çš„æ˜¯ä¸€ä¸ªâ€œä¸€ç«™å¼â€çš„è§£å†³æ–¹æ¡ˆï¼šä¸å†éœ€è¦ç ”ç©¶ STLï¼Œä¸å†éœ€è¦ C++ çš„<string>ï¼Œä¸å†éœ€è¦åˆ°å¤„å»æ‰¾è§£æ XMLã€è¿æ¥æ•°æ®åº“ã€è®¿é—®ç½‘ç»œçš„å„ç§ç¬¬ä¸‰æ–¹åº“ï¼Œå› ä¸º Qt è‡ªå·±å†…ç½®äº†è¿™äº›æŠ€æœ¯ã€‚ </string></p><p>Qt æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„æ¡†æ¶ã€‚è·¨å¹³å° GUI é€šå¸¸æœ‰ä¸‰ç§å®ç°ç­–ç•¥ï¼š</p><p>API æ˜ å°„ï¼šAPI æ˜ å°„æ˜¯è¯´ï¼Œç•Œé¢åº“ä½¿ç”¨åŒä¸€å¥— APIï¼Œå°†å…¶æ˜ å°„åˆ°ä¸åŒçš„åº•å±‚å¹³å°ä¸Šé¢ã€‚å¤§ä½“ç›¸å½“äºå°†ä¸åŒå¹³å°çš„ API æå–å…¬å…±éƒ¨åˆ†ã€‚æ¯”å¦‚è¯´ï¼Œå°† Windows å¹³å°ä¸Šçš„æŒ‰é’®æ§ä»¶å’Œ Mac OS ä¸Šçš„æŒ‰é’®ç»„ä»¶éƒ½å–åä¸º Buttonã€‚å½“ä½ ä½¿ç”¨ Button æ—¶ï¼Œå¦‚æœåœ¨ Windows å¹³å°ä¸Šï¼Œåˆ™ç¼–è¯‘æˆæŒ‰é’®æ§ä»¶ï¼›å¦‚æœåœ¨ Mac OS ä¸Šï¼Œåˆ™ç¼–è¯‘æˆæŒ‰é’®ç»„ä»¶ã€‚è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½æ˜¯åŸå§‹å¹³å°è‡ªæœ‰çš„ï¼Œå¤–è§‚å’ŒåŸç”Ÿå¹³å°ä¸€è‡´ï¼›ç¼ºç‚¹æ˜¯ï¼Œç¼–å†™åº“ä»£ç çš„æ—¶å€™éœ€è¦å¤§é‡å·¥ä½œç”¨äºé€‚é…ä¸åŒå¹³å°ï¼Œå¹¶ä¸”ï¼Œåªèƒ½æå–ç›¸åŒéƒ¨åˆ†çš„ APIã€‚æ¯”å¦‚ Mac OS çš„æ–‡æœ¬æ¡†è‡ªå¸¦æ‹¼å†™æ£€æµ‹ï¼Œä½†æ˜¯ Windows ä¸Šé¢æ²¡æœ‰ï¼Œåˆ™ä¸èƒ½æä¾›è¯¥åŠŸèƒ½ã€‚è¿™ç§ç­–ç•¥çš„å…¸å‹ä»£è¡¨æ˜¯ wxWidgetsã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ C++ åº“ï¼Œå’Œ Qt ä¸€æ ·åºå¤§ã€‚å®ƒçš„è¯­æ³•çœ‹ä¸Šå»å’Œ MFC ç±»ä¼¼ï¼Œæœ‰å¤§é‡çš„å®ã€‚æ®è¯´ï¼Œä¸€ä¸ª MFC ç¨‹åºå‘˜å¯ä»¥å¾ˆå®¹æ˜“çš„è½¬æ¢åˆ° wxWidgets ä¸Šé¢æ¥ã€‚</p><p>API æ¨¡æ‹Ÿï¼šå‰é¢æåˆ°ï¼ŒAPI æ˜ å°„ä¼šâ€œç¼ºå¤±â€ä¸åŒå¹³å°çš„ç‰¹å®šåŠŸèƒ½ï¼Œè€Œ API æ¨¡æ‹Ÿåˆ™æ˜¯è§£å†³è¿™ä¸€é—®é¢˜ã€‚ä¸åŒå¹³å°çš„æœ‰å·®å¼‚ APIï¼Œå°†ä½¿ç”¨å·¥å…·åº“è‡ªå·±çš„ä»£ç ç”¨äºæ¨¡æ‹Ÿå‡ºæ¥ã€‚æŒ‰ç…§å‰é¢çš„ä¾‹å­ï¼ŒMac OS ä¸Šçš„æ–‡æœ¬æ¡†æœ‰æ‹¼å†™æ£€æµ‹ï¼Œä½†æ˜¯ Windows çš„æ²¡æœ‰ã€‚é‚£ä¹ˆï¼Œå·¥å…·åº“è‡ªå·±æä¾›ä¸€ä¸ªæ‹¼å†™æ£€æµ‹ç®—æ³•ï¼Œè®© Windows çš„æ–‡æœ¬æ¡†ä¹Ÿæœ‰ç›¸åŒçš„åŠŸèƒ½ã€‚API æ¨¡æ‹Ÿçš„å…¸å‹ä»£è¡¨æ˜¯ wine â€”â€” ä¸€ä¸ª Linux ä¸Šé¢çš„ Windows æ¨¡æ‹Ÿå™¨ã€‚å®ƒå°†å¤§éƒ¨åˆ† Win32 API åœ¨ Linux ä¸Šé¢æ¨¡æ‹Ÿäº†å‡ºæ¥ï¼Œè®© Linux å¯ä»¥é€šè¿‡ wine è¿è¡Œ Windows ç¨‹åºã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼ŒAPI æ¨¡æ‹Ÿæœ€å¤§ä¼˜ç‚¹æ˜¯ï¼Œåº”ç”¨ç¨‹åºæ— éœ€é‡æ–°ç¼–è¯‘ï¼Œå³å¯è¿è¡Œåˆ°ç‰¹å®šå¹³å°ä¸Šã€‚å¦å¤–ä¸€ä¸ªä¾‹å­æ˜¯å¾®è½¯æä¾›çš„ DirectXï¼Œè¿™ä¸ªå¼€å‘åº“å°†å±è”½æ‰ä¸åŒæ˜¾å¡ç¡¬ä»¶æ‰€æä¾›çš„å…·ä½“åŠŸèƒ½ã€‚ä½¿ç”¨è¿™ä¸ªåº“ï¼Œä½ æ— éœ€æ‹…å¿ƒç¡¬ä»¶ä¹‹é—´çš„å·®å¼‚ï¼Œå¦‚æœæœ‰çš„æ˜¾å¡æ²¡æœ‰æä¾›è¯¥ç§åŠŸèƒ½ï¼ŒSDK ä¼šä½¿ç”¨è½¯ä»¶çš„æ–¹å¼åŠ ä»¥å®ç°ã€‚ï¼ˆå…³äºä¸¾ä¾‹ï¼Œå¯ä»¥å‚è€ƒæ–‡æœ«ä¸€æ®µç²¾å½©çš„è®¨è®ºã€‚ï¼‰</p><p>GUI æ¨¡æ‹Ÿï¼šä»»ä½•å¹³å°éƒ½æä¾›äº†å›¾å½¢ç»˜åˆ¶å‡½æ•°ï¼Œä¾‹å¦‚ç”»ç‚¹ã€ç”»çº¿ã€ç”»é¢ç­‰ã€‚æœ‰äº›å·¥å…·åº“åˆ©ç”¨è¿™äº›åŸºæœ¬å‡½æ•°ï¼Œåœ¨ä¸åŒç»˜åˆ¶å‡ºè‡ªå·±çš„ç»„ä»¶ï¼Œè¿™å°±æ˜¯ GUI æ¨¡æ‹Ÿã€‚GUI æ¨¡æ‹Ÿçš„å·¥ä½œé‡æ— ç–‘æ˜¯å¾ˆå¤§çš„ï¼Œå› ä¸ºéœ€è¦ä½¿ç”¨æœ€åŸºæœ¬çš„ç»˜å›¾å‡½æ•°å°†æ‰€æœ‰ç»„ä»¶ç”»å‡ºæ¥ï¼›å¹¶ä¸”è¿™ç§ç»˜åˆ¶å¾ˆéš¾ä¿è¯å’ŒåŸç”Ÿç»„ä»¶ä¸€æ¨¡ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œè¿™ä¸€ä»£ä»·å¸¦æ¥çš„ä¼˜åŠ¿æ˜¯ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¿®æ”¹ç»„ä»¶çš„å¤–è§‚â€”â€”åªè¦ä¿®æ”¹ç»„ä»¶ç»˜åˆ¶å‡½æ•°å³å¯ã€‚å¾ˆå¤šè·¨å¹³å°çš„ GUI åº“éƒ½æ˜¯ä½¿ç”¨çš„è¿™ç§ç­–ç•¥ï¼Œä¾‹å¦‚ gtk+ï¼ˆè¿™æ˜¯ä¸€ä¸ª C è¯­è¨€çš„å›¾å½¢ç•Œé¢åº“ã€‚ä½¿ç”¨ C è¯­è¨€å¾ˆä¼˜é›…åœ°å®ç°äº†é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ã€‚ä¸è¿‡ï¼Œè¿™ä¹ŸåŒæ ·å¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜â€”â€”ä½¿ç”¨å¤§é‡çš„ç±»å‹è½¬æ¢çš„å®æ¥æ¨¡æ‹Ÿå¤šæ€ï¼Œå¹¶ä¸”å®ƒçš„å‡½æ•°åä¸€èˆ¬éƒ½æ¯”è¾ƒé•¿ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å‰²å•è¯ï¼Œçœ‹ä¸Šå»å’Œ Linux å¦‚å‡ºä¸€è¾™ã€‚gtk+ å¹¶ä¸æ˜¯æ¨¡æ‹Ÿçš„åŸç”Ÿç•Œé¢ï¼Œè€Œæœ‰å®ƒè‡ªå·±çš„é£æ ¼ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å°±ä¼šå’Œæ“ä½œç³»ç»Ÿçš„ç•Œé¢æ ¼æ ¼ä¸å…¥ã€‚ï¼‰ï¼ŒSwing ä»¥åŠæˆ‘ä»¬çš„ Qtã€‚</p><p>Qt å’Œ wxWidgets ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ C++ åº“ã€‚ä½†æ˜¯å®ƒçš„è¯­æ³•ç±»ä¼¼äº Java çš„ Swingï¼Œååˆ†æ¸…æ™°ï¼Œè€Œä¸”ä½¿ç”¨ä¿¡å·æ§½ï¼ˆsignal/slotï¼‰æœºåˆ¶ï¼Œè®©ç¨‹åºçœ‹èµ·æ¥å¾ˆæ˜ç™½â€”â€”è¿™ä¹Ÿæ˜¯å¾ˆå¤šäººä¼˜å…ˆé€‰æ‹© Qt çš„ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› ã€‚ä¸è¿‡ï¼Œæ‰€è°“â€œæˆä¹Ÿè§ä½•ï¼Œè´¥ä¹Ÿè§ä½•â€ã€‚è¿™ç§æœºåˆ¶è™½ç„¶å¾ˆæ¸…æ¥šï¼Œä½†æ˜¯å®ƒæ‰€å¸¦æ¥çš„åæœæ˜¯ä½ éœ€è¦ä½¿ç”¨ Qt çš„ moc å¯¹ç¨‹åºè¿›è¡Œé¢„å¤„ç†ï¼Œæ‰èƒ½å¤Ÿå†ä½¿ç”¨æ ‡å‡†çš„ make æˆ–è€… nmake è¿›è¡Œæ­£å¸¸çš„ç¼–è¯‘ï¼Œå¹¶ä¸”ä¿¡å·æ§½çš„è°ƒç”¨è¦æ¯”æ™®é€šçš„å‡½æ•°è°ƒç”¨æ…¢å¤§çº¦ä¸€ä¸ªæ•°é‡çº§ï¼ˆQt 4 æ–‡æ¡£ä¸­è¯´æ˜è¯¥æ•°æ®ï¼Œä½† Qt 5 å°šæœªæœ‰å®˜æ–¹è¯´æ˜ï¼‰ã€‚Qt çš„ç•Œé¢ä¹Ÿä¸æ˜¯åŸç”Ÿé£æ ¼çš„ï¼Œå°½ç®¡ Qt ä½¿ç”¨ style æœºåˆ¶ååˆ†å·§å¦™åœ°æ¨¡æ‹Ÿäº†åŸç”Ÿç•Œé¢ã€‚å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒQt ä¸ä»…ä»…èƒ½å¤Ÿè¿è¡Œåœ¨æ¡Œé¢ç¯å¢ƒä¸­ï¼Œè¿˜å¯ä»¥è¿è¡Œåœ¨åµŒå…¥å¼å¹³å°ä»¥åŠæ‰‹æœºå¹³å°ã€‚</p><p>Qt ç¬¬ä¸€ç‰ˆäº 1991 å¹´ç”± Trolltech ï¼ˆå¥‡è¶£ç§‘æŠ€ï¼‰å‘å¸ƒã€‚åæ¥åœ¨ 2008 å¹´ï¼ŒNokia æ–¥èµ„ 1.5 äº¿ç¾å…ƒæ”¶è´­ TrollTechï¼Œå°† Qt åº”ç”¨äº Symbian ç¨‹åºå¼€å‘ã€‚2012 å¹´ 8 æœˆ 9 æ—¥ï¼ŒNokia å°† Qt ä»¥ 400 ä¸‡æ¬§å…ƒçš„ä»·æ ¼å‡ºå”®ç»™ Digiaã€‚</p><p>ä¼´éšç€ Qtï¼Œä¸€ç›´æœ‰ä¸¤ç§æˆæƒåè®®ï¼šå•†ä¸šæˆæƒä»¥åŠå¼€æºæˆæƒã€‚åœ¨ Qt çš„æ—©æœŸç‰ˆæœ¬ï¼Œå•†ä¸šæˆæƒåŒ…å«ä¸€äº›å¼€æºæˆæƒä¸æä¾›çš„ç»„ä»¶ï¼Œä½†æ˜¯åœ¨è¿‘æœŸç‰ˆæœ¬åˆ™ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚ä»¥å¾€äººä»¬å¯¹ Qt çš„å¼€æºæˆæƒå¤šæœ‰è¯Ÿç—…ã€‚æ—©æœŸç‰ˆæœ¬çš„ Qt ä½¿ç”¨ä¸ GPL ä¸å…¼å®¹çš„åè®®æˆæƒï¼Œè¿™ç›´æ¥å¯¼è‡´äº† KDE ä¸ GNOME çš„æˆ˜äº‰ï¼ˆç”±äº Linux ä½¿ç”¨ GPL åè®®å‘å¸ƒï¼ŒGPL åè®®å…·æœ‰ä¼ æŸ“æ€§ï¼Œä½œä¸º Linux æ¡Œé¢ç¯å¢ƒçš„ KDE å´æ˜¯åŸºäºä¸ GPL ä¸å…¼å®¹çš„ Qt å¼€å‘ï¼Œè¿™å°±ä¸éµå®ˆ GPL åè®®ï¼‰ã€‚ä¸è¿‡ï¼Œç°åœ¨ Qt çš„å¼€æºç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯ GPLv3 ä»¥åŠ LGPL åè®®ã€‚è¿™æ„å‘³ç€ï¼Œä½ å¯ä»¥å°† Qt ä½œä¸ºä¸€ä¸ªåº“è¿æ¥åˆ°ä¸€ä¸ªé—­æºè½¯ä»¶é‡Œé¢ã€‚å¯ä»¥è¯´ï¼ŒQt åè®®çš„äº‰è®®å·²ç»ä¸å­˜åœ¨äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹ç¼–è¯‘Qt5.14æºç </title>
      <link href="/2020/06/28/qt-compile-linux/"/>
      <url>/2020/06/28/qt-compile-linux/</url>
      
        <content type="html"><![CDATA[<h1 id="0"><a href="#0" class="headerlink" title="0"></a>0</h1><p>å¦‚æœä½ è‹±æ–‡å¤Ÿå¥½ï¼Œå¯ä»¥ç›´æ¥å»å®˜æ–¹wikiçœ‹æ•™ç¨‹<br><a href="https://wiki.qt.io/Building_Qt_5_from_Git" target="_blank" rel="noopener">https://wiki.qt.io/Building_Qt_5_from_Git</a></p><p>æ‡’å¾—è¯ï¼Œè¿˜æ˜¯çœ‹æˆ‘çš„å§ï¼ˆé€ƒ</p><h1 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h1><p>é¦–å…ˆä¸‹è½½è¿™ä¸ªæ–‡ä»¶<br><a href="https://mirrors.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.14/5.14.0/single/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.14/5.14.0/single/</a></p><p>ä¸‹è½½è¿™ä¸ªï¼Œè¿™ä¸ªæ˜¯æ‰€æœ‰çš„æºç ã€‚æ‰“åŒ…æˆçš„ä¸€ä¸ªæ–‡ä»¶</p><p><img src="/2020/06/28/qt-compile-linux/linux_build_qt_source1.jpg" alt> </p><p>ç„¶åè§£å‹</p><pre class=" language-shell"><code class="language-shell">tar xvf qt-everywhere-src-5.14.0.tar.xz </code></pre><p>åœ¨å½“å‰ç›®å½•åˆ›å»ºæ–‡ä»¶å¤¹</p><pre class=" language-shell"><code class="language-shell">mkdir build_qt5.14</code></pre><p>ç°åœ¨ç›®å½•æœ‰è¿™å‡ ä¸ªæ–‡ä»¶å¤¹</p><p><img src="/2020/06/28/qt-compile-linux/linux_build_qt_source2.jpg" alt> </p><p>ä¸€ä¸ªä¸ªè§£é‡Šï¼š</p><ul><li>build_qt5.14 æ˜¯ä¸€ä¼šå„¿Qtè¦å®‰è£…çš„ä½ç½®</li><li>qt-everywhere-src-5.14.0 æ˜¯è§£å‹å¥½çš„æ–‡ä»¶å¤¹</li><li>qt-everywhere-src-5.14.0.tar.xz æ˜¯ä¸‹è½½çš„Qtæºç </li></ul><h1 id="å®‰è£…ç¯å¢ƒæ­å»º"><a href="#å®‰è£…ç¯å¢ƒæ­å»º" class="headerlink" title="å®‰è£…ç¯å¢ƒæ­å»º"></a>å®‰è£…ç¯å¢ƒæ­å»º</h1><pre class=" language-shell"><code class="language-shell">sudo apt-get build-dep qt5-defaultsudo apt-get install libxcb-xinerama0-devsudo apt-get install build-essential perl python gitsudo apt-get install '^libxcb.*-dev' libx11-xcb-dev libglu1-mesa-dev libxrender-dev libxi-dev</code></pre><h1 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h1><p>è¿™æ¬¡æˆ‘ä»¬ä¸ç¼–è¯‘webç›¸å…³çš„æ¨¡å—ã€‚<br>è¿›å…¥è§£å‹å¥½çš„æ–‡ä»¶å¤¹</p><pre><code>cd qt-everywhere-src-5.14.0</code></pre><h3 id="ç¼–è¯‘è„šæœ¬"><a href="#ç¼–è¯‘è„šæœ¬" class="headerlink" title="ç¼–è¯‘è„šæœ¬"></a>ç¼–è¯‘è„šæœ¬</h3><p>ç¼–è¯‘è„šæœ¬ã€‚æœ¬æ¬¡ç¼–è¯‘debugç‰ˆæœ¬çš„Qtæ–¹ä¾¿ä»¥åå­¦ä¹ ç”¨ã€‚ï¼ˆä¸»è¦æ˜¯æ¯”Releaseçš„å¿«</p><pre class=" language-shell"><code class="language-shell">./configure -prefix /home/zhangpf/QtVersion/build_qt5.14 -debug -opensource -confirm-license -no-openssl -no-opengl -qt-xcb -skip qtquickcontrols -skip qtquickcontrols2 -skip qtsensors -skip qtdoc -no-compile-examples</code></pre><p>ç¨å¾®è§£é‡Šä¸‹</p><ul><li>prefix æ˜¯ä¸€ä¼šå„¿installçš„è·¯å¾„ï¼Œå¦‚æœä¸åˆ¶å®šï¼Œå°±ä¼šå®‰è£…åˆ°é»˜è®¤çš„/usr/local/ ä¸‹</li><li>debug æ˜¯ç¼–è¯‘debugç‰ˆæœ¬çš„Qt</li><li>opensource æ˜¯é€‰å®šå¼€æºç‰ˆæœ¬</li><li>confirm-license æ˜¯ç¡®å®šä¸‹åè®®<br>å…¶å®ƒçš„å‚æ•°å¯ä»¥å¿½ç•¥æ‰</li></ul><p>ç»“æŸä¼šæç¤ºï¼Œå¯ä»¥makeäº†ã€‚</p><p><img src="/2020/06/28/qt-compile-linux/linux_build_qt_source3.jpg" alt> </p><h2 id="ç¼–è¯‘-1"><a href="#ç¼–è¯‘-1" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p>ç°åœ¨ç”µè„‘é»˜è®¤æ˜¯gccç¼–è¯‘å™¨ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šclangä½œä¸ºç¼–è¯‘å™¨ã€‚<br>æˆ‘æœ¬åœ°gccç‰ˆæœ¬<br>gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) </p><p>å…ˆæŒ‰ç…§é»˜è®¤çš„æ¥å§,å‡å®šä½ æœºå™¨4æ ¸ã€‚</p><pre class=" language-shell"><code class="language-shell">make -j4 //ç¼–è¯‘make install //å®‰è£…åˆ°prefixçš„ç›®å½•</code></pre><h1 id="éªŒè¯æˆ‘ä»¬è‡ªå·±ç¼–è¯‘çš„Qt"><a href="#éªŒè¯æˆ‘ä»¬è‡ªå·±ç¼–è¯‘çš„Qt" class="headerlink" title="éªŒè¯æˆ‘ä»¬è‡ªå·±ç¼–è¯‘çš„Qt"></a>éªŒè¯æˆ‘ä»¬è‡ªå·±ç¼–è¯‘çš„Qt</h1><p>è¿›å…¥ç›®å½•<br>/home/zhangpf/QtVersion/build_qt5.14</p><p><img src="/2020/06/28/qt-compile-linux/linux_build_qt_source4.jpg" alt> </p><p>biné‡Œå°±æœ‰æˆ‘ä»¬ç¼–è¯‘çš„äºŒè¿›åˆ¶çš„Qt;<br>è¿›å…¥binç›®å½•</p><pre class=" language-shell"><code class="language-shell">./qmake -v</code></pre><p>çœ‹å›¾ï¼Œå·²ç»ç¼–è¯‘æˆåŠŸ</p><p><img src="/2020/06/28/qt-compile-linux/linux_build_qt_source5.jpg" alt></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QImageè½¬QByteArray</title>
      <link href="/2020/06/28/qimage-zhuan-qbytearray/"/>
      <url>/2020/06/28/qimage-zhuan-qbytearray/</url>
      
        <content type="html"><![CDATA[<pre class=" language-cpp"><code class="language-cpp">QImage img_enrll<span class="token punctuation">;</span>QByteArray arr<span class="token punctuation">;</span>QBuffer <span class="token function">buffer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>buffer<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>QIODevice<span class="token operator">::</span>WriteOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>img_enrll<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buffer<span class="token punctuation">,</span> <span class="token string">"yourformat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ–è€…</p><pre class=" language-cpp"><code class="language-cpp">QByteArray arr <span class="token operator">=</span> QByteArray<span class="token operator">::</span><span class="token function">fromRawData</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>img<span class="token punctuation">.</span><span class="token function">bits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span><span class="token function">byteCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QImage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsä¸‹VS2019ç¼–è¯‘Qt5.13.2æºç </title>
      <link href="/2020/06/28/qt-compile-windows/"/>
      <url>/2020/06/28/qt-compile-windows/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼–è¯‘æ¡ä»¶"><a href="#ç¼–è¯‘æ¡ä»¶" class="headerlink" title="ç¼–è¯‘æ¡ä»¶"></a>ç¼–è¯‘æ¡ä»¶</h1><ul><li>Python2.7.5 or laterï¼›</li><li>VS2019ï¼›</li><li>Qt5.13.2æºç ï¼›</li><li>perl</li><li>ruby</li></ul><h1 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h1><blockquote><p><a href="http://mirror.bit.edu.cn/qtproject/official_releases/qt/5.14/5.14.2/" target="_blank" rel="noopener" title="http://mirror.bit.edu.cn/qtproject/official_releases/qt/5.14/5.14.2/">http://mirror.bit.edu.cn/qtproject/official_releases/qt/5.14/5.14.2/</a></p></blockquote><p><a href="https://mirrors.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.13/5.13.2/single/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.13/5.13.2/single/</a></p><p><img src="/2020/06/28/qt-compile-windows/windows_build_qt_source_debug2.jpg" alt> </p><h1 id="è§£å‹åˆ°æ–‡ä»¶å¤¹"><a href="#è§£å‹åˆ°æ–‡ä»¶å¤¹" class="headerlink" title="è§£å‹åˆ°æ–‡ä»¶å¤¹"></a>è§£å‹åˆ°æ–‡ä»¶å¤¹</h1><p>åˆ›å»ºæ–‡ä»¶å¤¹ qt5.13_build_mt</p><p>ç°åœ¨ç›®å½•æ˜¯è¿™æ ·</p><p><img src="/2020/06/28/qt-compile-windows/windows_build_qt_source_debug1.jpg" alt> </p><h1 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h1><h2 id="æ‰“å¼€VS2019çš„å‘½ä»¤è¡Œå·¥å…·"><a href="#æ‰“å¼€VS2019çš„å‘½ä»¤è¡Œå·¥å…·" class="headerlink" title="æ‰“å¼€VS2019çš„å‘½ä»¤è¡Œå·¥å…·"></a>æ‰“å¼€VS2019çš„å‘½ä»¤è¡Œå·¥å…·</h2><ul><li>tipsï¼Œè¿™æ ·configureä¸ç”¨æŒ‡å®šç¼–è¯‘å™¨äº†</li></ul><p><img src="/2020/06/28/qt-compile-windows/windows_build_qt_source_debug4.jpg" alt> </p><h3 id="è¿›å…¥è§£å‹çš„Qtæºç ç›®å½•"><a href="#è¿›å…¥è§£å‹çš„Qtæºç ç›®å½•" class="headerlink" title="è¿›å…¥è§£å‹çš„Qtæºç ç›®å½•"></a>è¿›å…¥è§£å‹çš„Qtæºç ç›®å½•</h3><p>tips</p><ul><li>ç›´æ¥ç»ˆç«¯ <code>D:</code> å°±æ˜¯è¿›å…¥Dç›˜ã€‚</li><li>è¿›å…¥æ–‡ä»¶å¤¹å‘½ä»¤æ˜¯<code>cd</code></li><li>è¿”å›ä¸Šä¸€çº§ç›®å½•æ˜¯<code>cd ..</code></li><li>åˆ—å‡ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶æ˜¯ <code>dir</code></li></ul><p><img src="/2020/06/28/qt-compile-windows/windows_build_qt_source_debug3.jpg" alt> </p><h3 id="è¾“å…¥ç¼–è¯‘è„šæœ¬"><a href="#è¾“å…¥ç¼–è¯‘è„šæœ¬" class="headerlink" title="è¾“å…¥ç¼–è¯‘è„šæœ¬"></a>è¾“å…¥ç¼–è¯‘è„šæœ¬</h3><p>åœ¨å½“å‰ç»ˆç«¯è¾“å…¥è„šæœ¬ configure Qt</p><pre class=" language-shell"><code class="language-shell">configure -confirm-license -opensource -debug -prefix "D:\QtVersion\Qt5.13_Build_MT_X64\qt5.13_build_mt" -qt-sqlite -qt-zlib -qt-libpng -qt-libjpeg -nomake tests -no-compile-examples -nomake examples </code></pre><p>åˆ«å¿˜è®°è‡ªå·±æ”¹ä¸‹ prefixçš„ä½ç½®</p><p>configureå®Œæˆä¹‹åç›´æ¥</p><pre class=" language-shell"><code class="language-shell">nmakenmake install</code></pre><h1 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h1><p>è¿›å…¥prefixçš„ç›®å½•<br><img src="/2020/06/28/qt-compile-windows/windows_build_qt_source_debug5.jpg" alt> </p><p>ç¼–è¯‘æˆåŠŸï¼Œä¸ç®¡æ˜¯configureè¿˜æ˜¯nmakeéƒ½æ²¡æœ‰å•¥é”™ã€‚</p><p>PSã€‚æˆ‘çœ‹è¿˜æœ‰jomç¼–è¯‘Qtçš„æ–¹æ³•ï¼ŒåŸè°…æˆ‘å¯¹windowsçš„ç¼–è¯‘ä¸ç†Ÿæ‚‰ã€‚æœ‰å¤§ä½¬å¯ä»¥è¡¥å……ä¸‹ï¼Œæˆ–è€…ç»™ä¸ªå®Œæˆçš„é“¾æ¥ï¼Œæˆ‘è¡¥å……ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
          <category> QtåŸºç¡€1æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> ç¼–è¯‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹ä½¿ç”¨inotifyç›‘æ§æ–‡ä»¶åŠ¨ä½œ</title>
      <link href="/2020/06/27/linux-inotify/"/>
      <url>/2020/06/27/linux-inotify/</url>
      
        <content type="html"><![CDATA[<h2 id="Linuxä¸‹ä½¿ç”¨inotifyç›‘æ§æ–‡ä»¶åŠ¨ä½œ"><a href="#Linuxä¸‹ä½¿ç”¨inotifyç›‘æ§æ–‡ä»¶åŠ¨ä½œ" class="headerlink" title="Linuxä¸‹ä½¿ç”¨inotifyç›‘æ§æ–‡ä»¶åŠ¨ä½œ"></a>Linuxä¸‹ä½¿ç”¨inotifyç›‘æ§æ–‡ä»¶åŠ¨ä½œ</h2><h1 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h1><p>åœ¨æ—¥å¸¸åº”ç”¨ä¸­ï¼Œå¸¸å¸¸ä¼šé‡åˆ°ä»¥ä¸‹åœºæ™¯ï¼Œç›‘æ§æ–‡ä»¶å¤¹Aï¼Œè‹¥æ–‡ä»¶å¤¹ä¸­çš„Bæ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œåˆ™æ‰§è¡ŒCå‘½ä»¤ã€‚Linuxä¸‹å¯ä»¥é€šè¿‡inotifyå®Œæˆè¯¥åŠŸèƒ½ã€‚<br>è‡ªä»Linux kernel 2.6.13èµ·ï¼Œinotifyä»¥ä½œä¸ºå†…æ ¸çš„ä¸€éƒ¨ä»½ï¼ŒåŒæ—¶éœ€è¦glibc 2.4ä»¥ä¸Šç‰ˆæœ¬ã€‚</p><h4 id="ç›¸å…³å‡½æ•°"><a href="#ç›¸å…³å‡½æ•°" class="headerlink" title="ç›¸å…³å‡½æ•°"></a>ç›¸å…³å‡½æ•°</h4><ul><li><p>inotify_init() â€“ åˆ›å»ºä¸€ä¸ªinotifyå®ä¾‹</p></li><li><p>inotify_add_watch(int fd, const char *pathname, uint32_t mask) â€“ åŠ å…¥æ–‡ä»¶æˆ–ç›®å½•åˆ°inotifyè¿›è¡Œç›‘æµ‹</p></li><li><p>inotify_rm_watch(int fd, int wd) â€“ ç§»é™¤ä¸€ä¸ªwatcher</p></li></ul><h4 id="ç›¸å…³ç»“æ„"><a href="#ç›¸å…³ç»“æ„" class="headerlink" title="ç›¸å…³ç»“æ„"></a>ç›¸å…³ç»“æ„</h4><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">struct</span> inotify_event <span class="token punctuation">{</span>    <span class="token keyword">int</span>      wd<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">/* Watch descriptor */</span>    uint32_t mask<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* Mask of events */</span>    uint32_t cookie<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* Unique cookie associating related                                     events (for rename(2)) */</span>    uint32_t len<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">/* Size of name field */</span>    <span class="token keyword">char</span>     name<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* Optional null-terminated name */</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h4 id="3-Mask"><a href="#3-Mask" class="headerlink" title="3 Mask"></a>3 Mask</h4><p>é€‚ç”¨äº inotify_add_watch mask ä¸ read è¿”å›çš„inotify_eventä¸­mask</p><table><thead><tr><th>mask</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>IN_ACCESS</td><td>æ–‡ä»¶è¢«è®¿é—®</td></tr><tr><td>IN_ATTRIB</td><td>æ–‡ä»¶å±æ€§å‘ç”Ÿå˜åŒ–</td></tr><tr><td>IN_CLOSE_WRITE</td><td>ä»¥writeæ–¹å¼æ‰“å¼€æ–‡ä»¶å¹¶å…³é—­</td></tr><tr><td>IN_CLOSE_NOWRITE</td><td>ä»¥éwriteæ–¹å¼æ‰“å¼€æ–‡ä»¶å¹¶å…³é—­</td></tr><tr><td>IN_CREATE</td><td>æ–‡ä»¶æˆ–ç›®å½•è¢«åˆ›å»º</td></tr><tr><td>IN_DELETE</td><td>æ–‡ä»¶æˆ–ç›®å½•è¢«åˆ é™¤ï¼ˆè¢«ç›‘æµ‹çš„æ–‡ä»¶å¤¹Aä¸­Bæ–‡ä»¶è¢«åˆ é™¤ï¼‰</td></tr><tr><td>IN_DELETE_SELF</td><td>è¢«ç›‘æµ‹çš„æ–‡ä»¶æˆ–ç›®å½•è¢«åˆ é™¤ï¼ˆè¢«ç›‘æµ‹çš„æ–‡ä»¶å¤¹Aè¢«åˆ é™¤ï¼‰</td></tr><tr><td>IN_MODIFY</td><td>æ–‡ä»¶è¢«ä¿®æ”¹</td></tr><tr><td>IN_MOVE_SELF</td><td>è¢«ç›‘æµ‹çš„æ–‡ä»¶æˆ–ç›®å½•ç§»åŠ¨</td></tr><tr><td>IN_MOVED_FROM</td><td>æ–‡ä»¶ç§»å‡ºè¢«ç›‘æµ‹çš„ç›®å½•</td></tr><tr><td>IN_MOVED_TO</td><td>æ–‡ä»¶ç§»å…¥è¢«ç›‘æµ‹çš„ç›®å½•</td></tr><tr><td>IN_OPEN</td><td>æ–‡ä»¶è¢«æ‰“å¼€</td></tr><tr><td>ä¸Šè¿°flagçš„é›†åˆ</td><td></td></tr><tr><td>IN_ALL_EVENTS</td><td>ä»¥ä¸Šæ‰€æœ‰flagçš„é›†åˆ</td></tr><tr><td>IN_MOVE</td><td>IN_MOVED_TO</td></tr><tr><td>IN_CLOSE</td><td>IN_CLOSE_WRITE</td></tr><tr><td>ä¸å¸¸ç”¨çš„flag</td><td></td></tr><tr><td>IN_DONT_FOLLOW</td><td>ä¸followç¬¦å·é“¾æ¥ (since 2.6.15)</td></tr><tr><td>IN_EXCL_UNLINK</td><td>å½“æ–‡ä»¶ä»ç›‘æµ‹ç›®ä¸­unlinkåï¼Œåˆ™ä¸å†æŠ¥å‘Šè¯¥æ–‡ä»¶çš„ç›¸å…³eventï¼Œæ¯”å¦‚ç›‘æ§/tmpä½¿ç”¨ (since 2.6.36)</td></tr><tr><td>IN_MASK_ADD</td><td>è¿½æ‰“MASKåˆ°è¢«ç›‘æµ‹çš„pathname</td></tr><tr><td>IN_ONESHOT</td><td>åªç›‘æµ‹ä¸€æ¬¡</td></tr><tr><td>IN_ONLYDIR</td><td>åªç›‘æµ‹ç›®å½•</td></tr></tbody></table><p>ä»…ç”±readè¿”å›</p><table><thead><tr><th>mask</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>IN_IGNORED</td><td>inotify_rm_watchï¼Œæ–‡ä»¶è¢«åˆ é™¤æˆ–è€…æ–‡ä»¶ç³»ç»Ÿè¢«umount</td></tr><tr><td>IN_ISDIR</td><td>å‘ç”Ÿäº‹ä»¶çš„æ˜¯ä¸€ä¸ªç›®å½•</td></tr><tr><td>IN_Q_OVERFLOW</td><td>Eventé˜Ÿåˆ—æº¢å‡º</td></tr><tr><td>IN_UNMOUNT</td><td>æ–‡ä»¶ç³»ç»Ÿunmount</td></tr></tbody></table><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><p>ç”¨é€”ï¼šç›‘æµ‹æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•ï¼ˆæˆ–ä¸æŒ‡å®šåˆ™ä¸ºå½“å‰ç›®å½•ï¼‰çš„ä¸€åˆ‡åŠ¨ä½œã€‚<br>ä½¿ç”¨ï¼šinotify </p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span>  </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/inotify.h></span>  </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span>  </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;error.h></span>  </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;errno.h></span>  </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span>  </span><span class="token macro property">#<span class="token directive keyword">define</span> ERROR(text) error(1, errno, "%s", text)  </span><span class="token keyword">struct</span> EventMask <span class="token punctuation">{</span>      <span class="token keyword">int</span>        flag<span class="token punctuation">;</span>      <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> <span class="token function">freadsome</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>dest<span class="token punctuation">,</span> size_t remain<span class="token punctuation">,</span> FILE <span class="token operator">*</span>file<span class="token punctuation">)</span>  <span class="token punctuation">{</span>      <span class="token keyword">char</span> <span class="token operator">*</span>offset <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>dest<span class="token punctuation">;</span>      <span class="token keyword">while</span> <span class="token punctuation">(</span>remain<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> remain<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          remain <span class="token operator">-</span><span class="token operator">=</span> n<span class="token punctuation">;</span>          offset <span class="token operator">+</span><span class="token operator">=</span> n<span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>      <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>target<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          target <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>          target <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      EventMask event_masks<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>             <span class="token punctuation">{</span>IN_ACCESS        <span class="token punctuation">,</span> <span class="token string">"IN_ACCESS"</span><span class="token punctuation">}</span>        <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_ATTRIB        <span class="token punctuation">,</span> <span class="token string">"IN_ATTRIB"</span><span class="token punctuation">}</span>        <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_CLOSE_WRITE   <span class="token punctuation">,</span> <span class="token string">"IN_CLOSE_WRITE"</span><span class="token punctuation">}</span>   <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_CLOSE_NOWRITE <span class="token punctuation">,</span> <span class="token string">"IN_CLOSE_NOWRITE"</span><span class="token punctuation">}</span> <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_CREATE        <span class="token punctuation">,</span> <span class="token string">"IN_CREATE"</span><span class="token punctuation">}</span>        <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_DELETE        <span class="token punctuation">,</span> <span class="token string">"IN_DELETE"</span><span class="token punctuation">}</span>        <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_DELETE_SELF   <span class="token punctuation">,</span> <span class="token string">"IN_DELETE_SELF"</span><span class="token punctuation">}</span>   <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_MODIFY        <span class="token punctuation">,</span> <span class="token string">"IN_MODIFY"</span><span class="token punctuation">}</span>        <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_MOVE_SELF     <span class="token punctuation">,</span> <span class="token string">"IN_MOVE_SELF"</span><span class="token punctuation">}</span>     <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_MOVED_FROM    <span class="token punctuation">,</span> <span class="token string">"IN_MOVED_FROM"</span><span class="token punctuation">}</span>    <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_MOVED_TO      <span class="token punctuation">,</span> <span class="token string">"IN_MOVED_TO"</span><span class="token punctuation">}</span>      <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_OPEN          <span class="token punctuation">,</span> <span class="token string">"IN_OPEN"</span><span class="token punctuation">}</span>          <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_DONT_FOLLOW   <span class="token punctuation">,</span> <span class="token string">"IN_DONT_FOLLOW"</span><span class="token punctuation">}</span>   <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_EXCL_UNLINK   <span class="token punctuation">,</span> <span class="token string">"IN_EXCL_UNLINK"</span><span class="token punctuation">}</span>   <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_MASK_ADD      <span class="token punctuation">,</span> <span class="token string">"IN_MASK_ADD"</span><span class="token punctuation">}</span>      <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_ONESHOT       <span class="token punctuation">,</span> <span class="token string">"IN_ONESHOT"</span><span class="token punctuation">}</span>       <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_ONLYDIR       <span class="token punctuation">,</span> <span class="token string">"IN_ONLYDIR"</span><span class="token punctuation">}</span>       <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_IGNORED       <span class="token punctuation">,</span> <span class="token string">"IN_IGNORED"</span><span class="token punctuation">}</span>       <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_ISDIR         <span class="token punctuation">,</span> <span class="token string">"IN_ISDIR"</span><span class="token punctuation">}</span>         <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_Q_OVERFLOW    <span class="token punctuation">,</span> <span class="token string">"IN_Q_OVERFLOW"</span><span class="token punctuation">}</span>    <span class="token punctuation">,</span>               <span class="token punctuation">{</span>IN_UNMOUNT       <span class="token punctuation">,</span> <span class="token string">"IN_UNMOUNT"</span><span class="token punctuation">}</span>       <span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> monitor <span class="token operator">=</span> <span class="token function">inotify_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> monitor <span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">"monitor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">int</span> watcher <span class="token operator">=</span> <span class="token function">inotify_add_watch</span><span class="token punctuation">(</span>monitor<span class="token punctuation">,</span> target<span class="token punctuation">,</span> IN_ALL_EVENTS<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> watcher  <span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">"inotify_add_watch"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      FILE <span class="token operator">*</span>monitor_file <span class="token operator">=</span> <span class="token function">fdopen</span><span class="token punctuation">(</span>monitor<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">char</span> last_name<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">/* event:inotify_event -> name:char[event.len] */</span>      <span class="token keyword">while</span> <span class="token punctuation">(</span>true<span class="token punctuation">)</span> <span class="token punctuation">{</span>          inotify_event event<span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> <span class="token function">freadsome</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>event<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">,</span> monitor_file<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">"freadsome"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>len<span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token function">freadsome</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> event<span class="token punctuation">.</span>len<span class="token punctuation">,</span> monitor_file<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>              <span class="token function">sprintf</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"FD: %d\n"</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>wd<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> last_name<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token function">puts</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">strcpy</span><span class="token punctuation">(</span>last_name<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">/* æ˜¾ç¤ºeventçš„maskçš„å«ä¹‰ */</span>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>event_masks<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>EventMask<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>mask <span class="token operator">&amp;</span> event_masks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>                  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t%s\n"</span><span class="token punctuation">,</span> event_masks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">}</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  </code></pre><p>è¿è¡Œç»“æœï¼š vim ä¸­ å¯¹ç›‘æµ‹ç›®å½•ä¸­çš„ inotify.cc è¿›è¡Œä¿å­˜</p><pre class=" language-c"><code class="language-c"><span class="token number">4913</span>    IN_CREATE    IN_OPEN    IN_ATTRIB    IN_CLOSE_WRITE    IN_DELETEinotify<span class="token punctuation">.</span>cc    IN_MOVED_FROMinotify<span class="token punctuation">.</span>cc<span class="token operator">~</span>    IN_MOVED_TOinotify<span class="token punctuation">.</span>cc    IN_CREATE    IN_OPEN    IN_MODIFY    IN_CLOSE_WRITE    IN_ATTRIBinotify<span class="token punctuation">.</span>cc<span class="token operator">~</span>    IN_DELETE</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œvimä¿å­˜æ–‡ä»¶çš„æµç¨‹ä¸º<br>åˆ›å»ºä¸€ä¸ª4913æ–‡ä»¶ç”¨äºæ£€æµ‹vimå¯¹ç›®å½•çš„æ§åˆ¶æƒé™<br>æŠŠinotify.ccæ›´åä¸ºinotify.cc~<br>æ–°å»ºinotify.ccï¼Œå¹¶å†™å…¥buffer<br>åˆ é™¤inotify.cc</p><h1 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h1><p><a href="http://man7.org/linux/man-pages/man7/inotify.7.html" target="_blank" rel="noopener" title="http://man7.org/linux/man-pages/man7/inotify.7.html">http://man7.org/linux/man-pages/man7/inotify.7.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> inotify </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥äº†è§£QTæ¶ˆæ¯å¾ªç¯åŠçº¿ç¨‹ç›¸å…³æ€§</title>
      <link href="/2020/06/27/shen-ru-liao-jie-qt-xiao-xi-xun-huan-ji-xian-cheng-xiang-guan-xing/"/>
      <url>/2020/06/27/shen-ru-liao-jie-qt-xiao-xi-xun-huan-ji-xian-cheng-xiang-guan-xing/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯Qtæ¶ˆæ¯å¾ªç¯"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯Qtæ¶ˆæ¯å¾ªç¯" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯Qtæ¶ˆæ¯å¾ªç¯"></a>ä¸€ã€ä»€ä¹ˆæ˜¯Qtæ¶ˆæ¯å¾ªç¯</h1><p>  Qtæ¶ˆæ¯å¾ªç¯ï¼Œå°±æ˜¯ä»ä¸€ä¸ªé˜Ÿåˆ—ä¸­ä¸æ–­å–å‡ºæ¶ˆæ¯ï¼Œå¹¶å“åº”æ¶ˆæ¯çš„è¿‡ç¨‹ã€‚çª—ä½“çš„é¼ æ ‡ã€é”®ç›˜ã€è¾“å…¥æ³•ã€ç»˜åˆ¶ï¼Œå„ç§æ¶ˆæ¯ï¼Œéƒ½æ¥è‡ªäºQtçš„æ¶ˆæ¯å¾ªç¯ã€‚ä»¥Windowsæ“ä½œç³»ç»Ÿä¸ºä¾‹ï¼ŒQtæ¥ç®¡WindowsåŸç”Ÿçª—å£æ¶ˆæ¯ï¼Œå¹¶ç¿»è¯‘æˆQtçš„æ¶ˆæ¯ï¼Œæ´¾å‘ç»™ç¨‹åºä¸‹çš„å„ä¸ªå­å¯¹è±¡ã€å­QWidgetç­‰ï¼Œé€šè¿‡æ¥ç®¡å±‚ï¼Œå¯ä»¥å¾ˆå¥½å±è”½ä¸åŒå¹³å°ä¹‹é—´çš„å·®å¼‚æ€§ï¼Œå¼€å‘äººå‘˜ä¸éœ€è¦å…³å¿ƒWindowsæˆ–è€…X11çš„æ¶ˆæ¯çš„å·®å¼‚æ€§ï¼Œåªéœ€è¦ææ¸…æ¥šå„ä¸ªQEventä¹‹é—´æ˜¯ä»€ä¹ˆå«ä¹‰ã€‚</p><p>  æœ€å¼€å§‹çš„Qtæ¶ˆæ¯å¾ªç¯å¼€å§‹äºQCoreApplication::exec()ã€‚ç”¨æˆ·åˆ›å»ºå‡ºä¸€ä¸ªQCoreApplicationï¼Œæˆ–è€…è¯´æ›´å¤šæƒ…å†µä¸‹æ˜¯QApplicationï¼Œæ‰§è¡ŒQCoreApplication::exec()ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºä¾¿å¼€å§‹äº†ã€‚QCoreApplicationä¼šä¸æ–­ä»æ“ä½œç³»ç»Ÿè·å–æ¶ˆæ¯ï¼Œå¹¶ä¸”åˆ†å‘ç»™QObjectã€‚</p><p>  å¦‚æœæ²¡æœ‰æ¶ˆæ¯å¾ªç¯ï¼Œé‚£ä¹ˆQtçš„ä¿¡å·å’Œæ§½æ— æ³•å®Œå…¨ä½¿ç”¨ï¼Œæœ‰äº›å‡½æ•°ä¹Ÿæ— æ³•æ­£ç¡®æ‰§è¡Œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡QueuedConnectionè¿æ¥çš„ä¿¡å·ï¼Œå…¶å®æ˜¯å°†ä¸€ä¸ªäº‹ä»¶å‹å…¥äº†æ¶ˆæ¯å¾ªç¯ï¼Œå¦‚æœæ²¡æœ‰QCoreApplication::exec()ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¶ˆæ¯å¾ªç¯å°†æ°¸è¿œæ— æ³•æ´¾å‘åˆ°æŒ‡å®šçš„å¯¹è±¡ã€‚</p><h1 id="äºŒã€ä»€ä¹ˆæ˜¯çº¿ç¨‹ç›¸å…³æ€§"><a href="#äºŒã€ä»€ä¹ˆæ˜¯çº¿ç¨‹ç›¸å…³æ€§" class="headerlink" title="äºŒã€ä»€ä¹ˆæ˜¯çº¿ç¨‹ç›¸å…³æ€§"></a>äºŒã€ä»€ä¹ˆæ˜¯çº¿ç¨‹ç›¸å…³æ€§</h1><p>å‡†ç¡®ç‚¹æ¥è¯´ï¼Œåº”è¯¥æ˜¯æŒ‡QObjectçš„çº¿ç¨‹ç›¸å…³æ€§ã€‚ä»¥Qtæ–‡æ¡£ä¸­çš„ç¤ºæ„å›¾æ¥ä½œè¯´æ˜ï¼š</p><p><img src="/2020/06/27/shen-ru-liao-jie-qt-xiao-xi-xun-huan-ji-xian-cheng-xiang-guan-xing/1584530091352-tst.jpg" alt></p><p>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªQObjectæ—¶ï¼Œå®ƒä¼šä¸åˆ›å»ºè‡ªå·±æ‰€åœ¨çš„çº¿ç¨‹ç»‘å®šã€‚å®ƒå‚ä¸çš„æ¶ˆæ¯å¾ªç¯ï¼Œå…¶å®æ˜¯å®ƒæ‰€åœ¨çº¿ç¨‹çš„æ¶ˆæ¯å¾ªç¯ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚å‡å¦‚æŸä¸ªçº¿ç¨‹æ²¡æœ‰é»˜è®¤çš„QThread::exec()ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹ä¸Šçš„QObjectåˆ™æ— æ³•æ¥æ”¶åˆ°äº‹ä»¶ã€‚å¦å¤–ï¼Œå¦‚æœä¸¤ä¸ªä¸åŒçº¿ç¨‹çš„QObjectéœ€è¦ç›¸äº’é€šä¿¡ï¼Œé‚£ä¹ˆåªèƒ½é€šè¿‡QueuedConnectionçš„æ–¹å¼ï¼Œå¼‚æ­¥é€šçŸ¥å¯¹æ–¹çº¿ç¨‹ï¼Œåœ¨ä¸‹ä¸€è½®æ¶ˆæ¯å¾ªç¯å¤„ç†QObjectçš„æ¶ˆæ¯ã€‚</p><p>QObjectçš„çº¿ç¨‹ç›¸å…³æ€§é»˜è®¤ä¼šå’Œå®ƒçš„parentä¿æŒä¸€è‡´ã€‚å¦‚æœä¸€ä¸ªQObjectæ²¡æœ‰parentï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡moveToThreadï¼Œå°†å®ƒçš„çº¿ç¨‹ç›¸å…³æ€§åˆ‡æ¢åˆ°æŒ‡å®šçº¿ç¨‹ã€‚</p><p>äº†è§£QObjectçš„çº¿ç¨‹ç›¸å…³æ€§éå¸¸é‡è¦ï¼Œå¾ˆå¤šåˆå­¦è€…å¸¸å¸¸åˆ†ä¸æ¸…ä¸€ä¸ªå¤šçº¿ç¨‹ä¸­å“ªäº›QObjectåº”è¯¥ç”±ä¸»çº¿ç¨‹åˆ›å»ºï¼Œå“ªäº›åº”è¯¥ç”±å·¥ä½œçº¿ç¨‹åˆ›å»ºï¼Œæˆ‘çš„è§‚ç‚¹æ˜¯ï¼Œå®ƒå‚ä¸å“ªä¸ªæ¶ˆæ¯å¾ªç¯ï¼Œå°±ç”±å“ªä¸ªæ¥åˆ›å»ºã€‚</p><p>æ­£å› ä¸ºè¿™æ ·çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬æ‰å¯ä»¥ç†è§£ä»€ä¹ˆå«åšAutoConnectionã€‚é€šè¿‡AutoConnectè¿æ¥çš„ä¸¤ä¸ªQObjectï¼Œå¦‚æœæ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è°ƒç”¨(DirectConnection)ï¼Œå¦‚æœä¸æ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå°±é€šè¿‡äº‹ä»¶é€šçŸ¥çš„æ–¹å¼(QueuedConnectionï¼‰æ¥è°ƒç”¨ã€‚é€šè¿‡ä¿¡å·å’Œæ§½ã€äº‹ä»¶æˆ–è€…QueuedConnectionæ–¹å¼æ¥è¿›è¡Œçº¿ç¨‹é—´çš„é€šè®¯ï¼Œå°¤å…¶æ˜¯ä¸UIçº¿ç¨‹é€šè®¯ï¼Œæ°¸è¿œæ˜¯æœ€ä¼˜é›…çš„æ–¹å¼ä¹‹ä¸€ã€‚</p><p>å¸Œæœ›å¤§å®¶çœ‹äº†è¿™ç¯‡æ–‡ç« åèƒ½æœ‰æ‰€å¸®åŠ©ã€‚</p><p>å…¨æ–‡å®Œã€‚</p><hr><p>ç­‰ç­‰ï¼Œè¿™å°±å®Œäº†ï¼Ÿè¿™ç®—å“ªé—¨å­æ·±å…¥ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>å¥½å§ï¼ä»¥ä¸‹æ‰æ˜¯æ­£æ–‡ï¼</p><p>çœŸÂ·æ·±å…¥äº†è§£QTæ¶ˆæ¯å¾ªç¯åŠçº¿ç¨‹ç›¸å…³æ€§</p><h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯æ¶ˆæ¯å¾ªç¯"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯æ¶ˆæ¯å¾ªç¯" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯æ¶ˆæ¯å¾ªç¯"></a>ä¸€ã€ä»€ä¹ˆæ˜¯æ¶ˆæ¯å¾ªç¯</h1><p>ä»¥Windowsä¸ºä¾‹ï¼Œåœ¨æˆ‘ä»¬ç¼–å†™GUIç¨‹åºï¼Œåˆ›å»ºä¸€ä¸ªåŸç”Ÿçª—ä½“æ—¶ï¼Œæ€»ä¼šè¦ç»å†ä¸¤ä¸ªæ­¥éª¤ï¼š</p><h2 id="1ã€æ³¨å†Œä¸€ä¸ªçª—ä½“ç±»-RegisterClassEx"><a href="#1ã€æ³¨å†Œä¸€ä¸ªçª—ä½“ç±»-RegisterClassEx" class="headerlink" title="1ã€æ³¨å†Œä¸€ä¸ªçª—ä½“ç±»(RegisterClassEx):"></a>1ã€æ³¨å†Œä¸€ä¸ªçª—ä½“ç±»(RegisterClassEx):</h2><p><a href="https://docs.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-registerclassexa" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-registerclassexa</a></p><p>çª—ä½“ç±»ä¸­ï¼Œæœ€é‡è¦çš„å°±æ˜¯æŒ‡å®šäº†ä¸€ä¸ªçª—å£å¤„ç†å‡½æ•°WNDPROCã€‚æ‰€æœ‰æ­¤ç±»å‹çš„çª—å£ï¼Œæ”¶åˆ°äº‹ä»¶åï¼Œéƒ½ä¼šå›è°ƒåˆ°æ­¤å¤„ç†å‡½æ•°ä¸­æ¥æ‰§è¡Œã€‚</p><h2 id="2ã€åˆ›å»ºä¸€ä¸ªçª—ä½“-CreateWindow"><a href="#2ã€åˆ›å»ºä¸€ä¸ªçª—ä½“-CreateWindow" class="headerlink" title="2ã€åˆ›å»ºä¸€ä¸ªçª—ä½“(CreateWindow)"></a>2ã€åˆ›å»ºä¸€ä¸ªçª—ä½“(CreateWindow)</h2><p><a href="https://docs.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-createwindowexw" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-createwindowexw</a></p><p>ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¾ˆå¤šä¸ªçª—å£ï¼Œç„¶åä½¿ç”¨åŒä¸€ä¸ªçª—ä½“å¤„ç†å‡½æ•°ï¼Œé€šè¿‡åˆ›å»ºæ—¶çš„å‚æ•°æ¥å†³å®šä¸Šä¸‹æ–‡ï¼Œä¹Ÿå°±æ˜¯åˆ°åº•æ˜¯å¤„ç†çš„æ˜¯å“ªä¸ªWindowï¼Œä»¥åŠè·å–ä¸€äº›è‡ªå®šä¹‰ç»“æ„ç­‰ã€‚è¿™ä¸ªå‡½æ•°å¤§è‡´å®šä¹‰äº†çª—ä½“çš„é¢œå€¼ï¼Œå¹¶ä¸”éœ€è¦ä¸ç¬¬ä¸€æ­¥ä¸­çš„çª—ä½“ç±»å…³è”èµ·æ¥ã€‚è¿™æ ·ä¸€æ¥ï¼Œçª—ä½“å°±çœŸæ­£åˆ›å»ºå¥½äº†ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥æ¥æ”¶åˆ°ç³»ç»Ÿå‘æ¥çš„æ¶ˆæ¯ã€‚</p><p>æ¥ä¸‹æ¥å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œå°±æ˜¯å…³äºæ¶ˆæ¯å¾ªç¯çš„è¿‡ç¨‹ã€‚<br>é¦–å…ˆï¼Œç”¨æˆ·é€šè¿‡GetMessageã€PeekMessageç­‰å‡½æ•°ï¼Œä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºäº‹ä»¶ï¼Œæ¥ä¸‹æ¥ï¼Œé€šè¿‡DispatchMessageæ¥åˆ†å‘äº‹ä»¶ã€‚ç³»ç»Ÿå°†è¿™ä¸ªäº‹ä»¶åˆ†å‘åˆ°å¯¹åº”çš„çª—å£å¤„ç†å‡½æ•°WNDPROCä¸­è¿›è¡Œå¤„ç†ã€‚<br>åœ¨ç»å¤§éƒ¨åˆ†GUIç¨‹åºä¸­ï¼ŒGetMessage, DispatchMessageæ˜¯å†™åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­çš„ï¼Œé™¤éç¨‹åºé€€å‡ºï¼Œå¦åˆ™ä¼šä¸€ç›´å¤„ç†å„ç§äº‹ä»¶ã€‚</p><h1 id="äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„çº¿ç¨‹ç›¸å…³æ€§"><a href="#äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„çº¿ç¨‹ç›¸å…³æ€§" class="headerlink" title="äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„çº¿ç¨‹ç›¸å…³æ€§"></a>äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„çº¿ç¨‹ç›¸å…³æ€§</h1><p>ä¾ç…§MSDNçš„è¯´æ³•ï¼š</p><p><a href="https://docs.microsoft.com/zh-cn/windows/win32/winmsg/about-messages-and-message-queues" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/winmsg/about-messages-and-message-queues</a></p><p>ç³»ç»Ÿå°†ç”¨åˆ›å»ºæŸWindowçš„çº¿ç¨‹æ¥åˆ†å‘æ¶ˆæ¯ã€‚ä¾‹å¦‚çª—ä½“1åœ¨çº¿ç¨‹Aåˆ›å»ºï¼Œçª—ä½“2åœ¨çº¿ç¨‹Båˆ›å»ºï¼Œé‚£ä¹ˆå®ƒä»¬çš„WNDPROCåˆ™æ˜¯ç”±ä¸åŒçº¿ç¨‹æ¥å›è°ƒçš„ã€‚ä¸€èˆ¬åœ°æˆ‘ä»¬ä¹Ÿåªä¼šåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºçª—ä½“ï¼Œä¸è¿‡ç³»ç»Ÿè¿˜æ˜¯å…è®¸åœ¨å„ä¸ªçº¿ç¨‹ä¸­å¤„ç†çª—å£çš„ã€‚</p><h1 id="ä¸‰ã€Qtæ¶ˆæ¯å¾ªç¯çš„åŸºç¡€ï¼šçª—ä½“äº‹ä»¶"><a href="#ä¸‰ã€Qtæ¶ˆæ¯å¾ªç¯çš„åŸºç¡€ï¼šçª—ä½“äº‹ä»¶" class="headerlink" title="ä¸‰ã€Qtæ¶ˆæ¯å¾ªç¯çš„åŸºç¡€ï¼šçª—ä½“äº‹ä»¶"></a>ä¸‰ã€Qtæ¶ˆæ¯å¾ªç¯çš„åŸºç¡€ï¼šçª—ä½“äº‹ä»¶</h1><p>åœ¨Windowsä¸­ï¼Œè¦å¤„ç†äº‹ä»¶ä¸€å®šè¦æœ‰ä¸€ä¸ªçª—ä½“ã€‚åœ¨Qtä¸­ï¼Œäº‹ä»¶ä¸€å…±æœ‰ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯å’Œçª—ä½“æ— å…³çš„å®è·µï¼Œä¾‹å¦‚QTimerEventï¼Œå¦å¤–ä¸€ç±»å°±æ˜¯å¸¸è§çš„çª—ä½“äº‹ä»¶ï¼Œå¦‚é¼ æ ‡ã€é”®ç›˜ã€ç»˜åˆ¶ç­‰äº‹ä»¶ã€‚å› æ­¤ï¼Œqtè‡³å°‘æœ‰ä¸¤ä¸ªWNDPROCï¼Œä¸€ä¸ªå¤„ç†Timerç­‰äº‹ä»¶ï¼Œä¸€ä¸ªå¤„ç†QWidgetä¸­çš„äº‹ä»¶ã€‚</p><p>åˆšåˆšä¹Ÿæåˆ°ï¼ŒWindowsäº‹ä»¶å…¶å®æ˜¯å’Œçº¿ç¨‹ç›¸å…³çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸€ä¸ªQObjectçš„å¯¹è±¡ï¼Œå®ƒå¿…é¡»è¦æœ‰è‡ªå·±æ‰€åœ¨çº¿ç¨‹çš„ä¿¡æ¯ã€‚ä¸åŒçº¿ç¨‹çš„å¯¹è±¡æ˜¯æ— æ³•ç›´æ¥é€šä¿¡çš„ï¼Œè¦é€šè¿‡äº‹ä»¶æ‰å¯ä»¥ã€‚</p><p>åœ¨Qtä¸­ï¼Œæ¶ˆæ¯å¾ªç¯åœ¨QEventLoopç±»ä¸­å®ç°ã€‚é€šè¿‡QEventLoop::exec()å¯ä»¥è¿›å…¥ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯çš„é˜»å¡çŠ¶æ€ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­åœ°PeekMessage-DispatchMessageã€‚å…¶å®ï¼ŒQEventLoopé‡Œé¢å‡ ä¹æ²¡æœ‰å®ç°ä»»ä½•ç»†èŠ‚ï¼Œè¿™å¯èƒ½æœ‰ç‚¹ä»¤äººè¿·æƒ‘ï¼Œä¸è¿‡ä»”ç»†æƒ³æƒ³ï¼Œä»»ä½•ç³»ç»Ÿéƒ½å¯ä»¥é€šè¿‡QEventLoopæ¥è°ƒç”¨æ¶ˆæ¯å¾ªç¯ï¼Œè¯´æ˜é‡Œé¢ä¸€å®šæœ‰ä¸€å±‚å’Œç³»ç»Ÿç›¸å…³çš„æŠ½è±¡ï¼Œè¿™ä¸ªç¨åä¼šè¯´åˆ°ã€‚</p><p>ä¸éš¾æƒ³åˆ°ï¼ŒQEventLoopé€šè¿‡å†…éƒ¨çš„ä¸€å±‚æŠ½è±¡ï¼Œæ¥ä¸æ–­ä»ç³»ç»Ÿè·å–å’Œå¤„ç†æ¶ˆæ¯ï¼Œè€Œè¿™ä¸€å±‚æŠ½è±¡ï¼Œæ˜¯å’Œçº¿ç¨‹ç›¸å…³çš„ã€‚æ‰€æœ‰ç›¸åŒçš„çº¿ç¨‹ï¼Œå®Œå…¨å¯ä»¥å…±ç”¨è¿™å±‚æŠ½è±¡ã€‚æ¥ä¸‹æ¥å°±å¼€å§‹è§£æQt4.8ä¸­å¯¹æ­¤çš„å®ç°ã€‚</p><h1 id="å››ã€å®ç°"><a href="#å››ã€å®ç°" class="headerlink" title="å››ã€å®ç°"></a>å››ã€å®ç°</h1><h2 id="1-QAbstractEventDispatcher"><a href="#1-QAbstractEventDispatcher" class="headerlink" title="1. QAbstractEventDispatcher"></a>1. QAbstractEventDispatcher</h2><p>QAbstractEventDispatcheræ˜¯ä¸€ä¸ªå¤„ç†PeekMessage-DispatchMessageçš„æŠ½è±¡æ¥å£ã€‚Windowsä¸Šå®ç°çš„æ´¾ç”Ÿç±»æ˜¯QEventDispatcherWin32ã€‚QEventLoopä»æŸä¸ªåœ°æ–¹å–åˆ°è¿™ä¸ªç±»çš„å®ä¾‹ï¼Œæ¥å®Œæˆæ¶ˆæ¯çš„è·å–å’Œåˆ†å‘ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">QEventDispatcherWin32::processEvents</span><span class="params">(QEventLoop::ProcessEventsFlags flags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Q_D(QEventDispatcherWin32);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!d-&gt;internalHwnd)</span><br><span class="line">        createInternalHwnd();</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        ....</span><br><span class="line">        <span class="keyword">while</span> (!d-&gt;interrupt) &#123;</span><br><span class="line">             ...</span><br><span class="line">            MSG msg;</span><br><span class="line">            <span class="keyword">bool</span> haveMessage;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!(flags &amp; QEventLoop::ExcludeUserInputEvents) &amp;&amp; !d-&gt;queuedUserInputEvents.isEmpty()) &#123;</span><br><span class="line">                ...</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                haveMessage = PeekMessage(&amp;msg, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, PM_REMOVE);</span><br><span class="line">                ...</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!haveMessage) &#123;</span><br><span class="line">                .....</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (haveMessage) &#123;</span><br><span class="line">                .....</span><br><span class="line">                <span class="keyword">if</span> (!filterEvent(&amp;msg)) &#123;</span><br><span class="line">                    TranslateMessage(&amp;msg);</span><br><span class="line">                    DispatchMessage(&amp;msg);</span><br><span class="line">                &#125;</span><br><span class="line">                .....</span><br><span class="line">            &#125;</span><br><span class="line">            retVal = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (canWait);</span><br><span class="line">    .....</span><br><span class="line">    <span class="keyword">return</span> retVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯QEventDispatcherWin32çš„å…·ä½“å®ç°ã€‚æˆ‘çœç•¥æ‰äº†å¤§éƒ¨åˆ†ä»£ç ï¼Œåªç•™ä¸‹å‡ ä¸ªå…³é”®éƒ¨åˆ†ã€‚<br>é¦–å…ˆæ˜¯çœ‹å¾ªç¯éƒ¨åˆ†ï¼Œå…¶å®å°±åƒåŸç”Ÿçš„Windowsç¨‹åºé‚£æ ·ï¼ŒPeekMessage, TranslateMessage, DispatchMessageã€‚æˆ‘ä»¬è°ƒç”¨QEventLoop::exec()åï¼Œä¾¿é©¬ä¸Šè°ƒè¿›äº†è¿™é‡Œã€‚<br>ç¬¬äºŒä¸ªå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!d-&gt;internalHwnd)</span><br><span class="line">    createInternalHwnd();</span><br></pre></td></tr></table></figure><p>createInternalHwnd()ï¼ŒQTç”¨å®ƒåˆ›å»ºäº†ä¸€ä¸ªä¸å¯è§çš„çª—å£ï¼Œå¹¶ä¸”ä¸ºå®ƒæ³¨å†Œäº†ä¸€ä¸ªå«åšqt_internal_procçš„WNDPROCå‡½æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT QT_WIN_CALLBACK <span class="title">qt_internal_proc</span><span class="params">(HWND hwnd, UINT message, WPARAM wp, LPARAM lp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (message == WM_NCCREATE)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    MSG msg;</span><br><span class="line">    msg.hwnd = hwnd;</span><br><span class="line">    msg.message = message;</span><br><span class="line">    msg.wParam = wp;</span><br><span class="line">    msg.lParam = lp;</span><br><span class="line">    QCoreApplication *app = QCoreApplication::instance();</span><br><span class="line">    <span class="keyword">long</span> result;</span><br><span class="line">    <span class="keyword">if</span> (!app) &#123;</span><br><span class="line">        <span class="keyword">if</span> (message == WM_TIMER)</span><br><span class="line">            KillTimer(hwnd, wp);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (app-&gt;filterEvent(&amp;msg, &amp;result)) &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> GWLP_USERDATA</span></span><br><span class="line">    QEventDispatcherWin32 *q = (QEventDispatcherWin32 *) GetWindowLongPtr(hwnd, GWLP_USERDATA);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    QEventDispatcherWin32 *q = (QEventDispatcherWin32 *) GetWindowLong(hwnd, GWL_USERDATA);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    QEventDispatcherWin32Private *d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (q != <span class="number">0</span>)</span><br><span class="line">        d = q-&gt;d_func();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (message == WM_QT_SOCKETNOTIFIER) &#123;</span><br><span class="line">        <span class="comment">// socket notifier message</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message == WM_QT_SENDPOSTEDEVENTS</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message == WM_TIMER) &#123;</span><br><span class="line">        Q_ASSERT(d != <span class="number">0</span>);</span><br><span class="line">        d-&gt;sendTimerEvent(wp);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> DefWindowProc(hwnd, message, wp, lp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªéšè—çš„çª—å£å¤„ç†äº†å‡ ä¸ªäº‹ä»¶ã€‚å…¶ä¸­æœ€å¸¸ç”¨çš„äº‹ä»¶ï¼Œè‚¯å®šå°±æ˜¯WM_TIMERäº†ã€‚é€šè¿‡QTimer::singleShotè¿›æ¥çš„äº‹ä»¶ï¼Œæœ€ç»ˆé€šè¿‡registerTimer()è®¾ç½®äº†è®¡æ—¶å™¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QEventDispatcherWin32Private::registerTimer</span><span class="params">(WinTimerInfo *t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Q_ASSERT(internalHwnd);</span><br><span class="line"></span><br><span class="line">    Q_Q(QEventDispatcherWin32);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (t-&gt;interval &gt; <span class="number">20</span> || !t-&gt;interval || !qtimeSetEvent) &#123;</span><br><span class="line">        ok = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (!t-&gt;interval)  <span class="comment">// optimization for single-shot-zero-timer</span></span><br><span class="line">            QCoreApplication::postEvent(q, <span class="keyword">new</span> QZeroTimerEvent(t-&gt;timerId));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ok = SetTimer(internalHwnd, t-&gt;timerId, (uint) t-&gt;interval, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ok = t-&gt;fastTimerId = qtimeSetEvent(t-&gt;interval, <span class="number">1</span>, qt_fast_timer_proc, (DWORD_PTR)t,</span><br><span class="line">                                            TIME_CALLBACK_FUNCTION | TIME_PERIODIC | TIME_KILL_SYNCHRONOUS);</span><br><span class="line">        <span class="keyword">if</span> (ok == <span class="number">0</span>) &#123; <span class="comment">// fall back to normal timer if no more multimedia timers available</span></span><br><span class="line">            ok = SetTimer(internalHwnd, t-&gt;timerId, (uint) t-&gt;interval, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ok == <span class="number">0</span>)</span><br><span class="line">        qErrnoWarning(<span class="string">"QEventDispatcherWin32::registerTimer: Failed to create a timer"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“SetTimerè¶…æ—¶åï¼ŒWM_TIMERå°†å‘é€ç»™internalHwndï¼Œæ¥ä¸‹æ¥å®ƒè°ƒç”¨sendTimerEventï¼Œé€šçŸ¥æ¥æ”¶çš„QObjectï¼Œè¾¾åˆ°è®¡æ—¶å™¨çš„æ•ˆæœã€‚</p><p>é€šè¿‡åˆ›å»ºä¸€ä¸ªéšè—çš„çª—å£ï¼Œæ¥å¤„ç†ä¸€äº›ç‰¹å®šçš„äº‹ä»¶ï¼Œè¿™ä¾¿æ˜¯Qtæ¶ˆæ¯å¾ªç¯çš„ä¸€ä¸ªå°å°çš„å¥—è·¯ã€‚</p><h2 id="2-QThreadData"><a href="#2-QThreadData" class="headerlink" title="2. QThreadData"></a>2. QThreadData</h2><p>ä½ å¯èƒ½ä¼šé—®ï¼ŒQEventDispatcherWin32çš„å®ä¾‹å­˜æ”¾åœ¨å“ªé‡Œã€‚å‰æ–‡ä¹Ÿè¯´è¿‡ï¼ŒQEventDispatcherWin32æ˜¯è·Ÿç€çº¿ç¨‹èµ°çš„ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦æ¯ä¸ªQEventLoopéƒ½å­˜ä¸€ä¸ªã€‚äº‹å®ä¸Šï¼Œå®ƒå­˜æ”¾åœ¨ä¸€ä¸ªå«åšQThreadDataçš„ç»“æ„ä¸­ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QThreadData</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    QAtomicInt _ref;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    QThreadData(<span class="keyword">int</span> initialRefCount = <span class="number">1</span>);</span><br><span class="line">    ~QThreadData();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> QThreadData *<span class="title">current</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> QThreadData *<span class="title">get2</span><span class="params">(QThread *thread)</span></span></span><br><span class="line"><span class="function">    </span>&#123; Q_ASSERT_X(thread != <span class="number">0</span>, <span class="string">"QThread"</span>, <span class="string">"internal error"</span>); <span class="keyword">return</span> thread-&gt;d_func()-&gt;data; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ref</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deref</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    QThread *thread;</span><br><span class="line">    <span class="keyword">bool</span> quitNow;</span><br><span class="line">    <span class="keyword">int</span> loopLevel;</span><br><span class="line">    QAbstractEventDispatcher *eventDispatcher;</span><br><span class="line">    QStack&lt;QEventLoop *&gt; eventLoops;</span><br><span class="line">    QPostEventList postEventList;</span><br><span class="line">    <span class="keyword">bool</span> canWait;</span><br><span class="line">    QVector&lt;<span class="keyword">void</span> *&gt; tls;</span><br><span class="line"></span><br><span class="line">    QMutex mutex;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="meta-keyword">ifdef</span> Q_OS_SYMBIAN</span></span><br><span class="line">    RThread symbian_thread_handle;</span><br><span class="line"><span class="meta"># <span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä»”ç»†çœ‹çœ‹è¿™ä¸ªç»“æ„ï¼Œå®ƒå‡ ä¸ªä¸»è¦çš„æˆå‘˜ï¼ŒeventDispatcherï¼Œå°±æ˜¯æˆ‘ä»¬åˆšåˆšè¯´çš„QEventDispatcherWin32å®ä¾‹ã€‚eventLoopsï¼Œè¿™ä¸ªæ˜¯åµŒå¥—çš„æ¶ˆæ¯å¾ªç¯ï¼Œä»¥åŠloopLevelï¼Œæ˜¯å®ƒåµŒå¥—çš„å±‚æ•°ï¼ˆå¦‚QEventLoop::execé‡Œé¢è°ƒç”¨QEventLoop:execï¼‰ã€‚é‡Œé¢è¿˜æœ‰ä¸ªpostEventListï¼Œè¡¨ç¤ºå½“å‰çš„Qtäº‹ä»¶é˜Ÿåˆ—ï¼Œthreadè¡¨ç¤ºå®ƒå½“å‰æ‰€åœ¨çš„çº¿ç¨‹ï¼Œä»¥åŠä¸€ä¸ª_refå¼•ç”¨è®¡æ•°ã€‚</p><p>QThreadDataå¥‡å¦™åœ¨ï¼Œå®ƒæ˜¯è·Ÿç€çº¿ç¨‹èµ°çš„ã€‚åœ¨QThreadData::currentä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QThreadData *<span class="title">QThreadData::current</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    qt_create_tls();</span><br><span class="line">    QThreadData *threadData = <span class="keyword">reinterpret_cast</span>&lt;QThreadData *&gt;(TlsGetValue(qt_current_thread_data_tls_index));</span><br><span class="line">    <span class="keyword">if</span> (!threadData) &#123;</span><br><span class="line">       ...</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            threadData = <span class="keyword">new</span> QThreadData;</span><br><span class="line">            <span class="comment">// This needs to be called prior to new AdoptedThread() to</span></span><br><span class="line">            <span class="comment">// avoid recursion.</span></span><br><span class="line">            TlsSetValue(qt_current_thread_data_tls_index, threadData);</span><br><span class="line">            QT_TRY &#123;</span><br><span class="line">                threadData-&gt;thread = <span class="keyword">new</span> QAdoptedThread(threadData);</span><br><span class="line">            &#125; QT_CATCH(...) &#123;</span><br><span class="line">                TlsSetValue(qt_current_thread_data_tls_index, <span class="number">0</span>);</span><br><span class="line">                threadData-&gt;deref();</span><br><span class="line">                threadData = <span class="number">0</span>;</span><br><span class="line">                QT_RETHROW;</span><br><span class="line">            &#125;</span><br><span class="line">            threadData-&gt;deref();</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> threadData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ï¼Œè°ƒç”¨æ­¤æ–¹æ³•åï¼Œå¦‚æœçº¿ç¨‹æ ˆçš„å±€éƒ¨å­˜å‚¨åŒºä¸­æ²¡æœ‰QThreadDataï¼Œä¸€ä¸ªæ–°çš„QThreadDataå°±ä¼šè¢«åˆ›å»ºï¼Œå¹¶ä¸”è®¾ç½®åˆ°å½“å‰çº¿ç¨‹çš„å±€éƒ¨å­˜å‚¨åŒºï¼Œå¹¶ä¸”å°†å½“å‰çº¿ç¨‹ç»‘å®šåœ¨ä¸€ä¸ªå‡çš„QAdoptedThreadä¸­ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼šæ‰€æœ‰çš„QObjectä¸­éƒ½æœ‰QThreadDataçš„æˆå‘˜ï¼Œå¹¶ä¸”æœ‰ä¸‹åˆ—åˆå§‹åŒ–ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QObject::QObject(QObjectPrivate &amp;dd, QObject *parent)</span><br><span class="line">    : d_ptr(&amp;dd)</span><br><span class="line">&#123;</span><br><span class="line">    Q_D(QObject);</span><br><span class="line">    d_ptr-&gt;q_ptr = <span class="keyword">this</span>;</span><br><span class="line">    d-&gt;threadData = (parent &amp;&amp; !parent-&gt;thread()) ? parent-&gt;d_func()-&gt;threadData : QThreadData::current();</span><br><span class="line">    d-&gt;threadData-&gt;ref();</span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±éå¸¸æ¸…æ™°æ˜äº†äº†ï¼Œæˆ‘åˆ›å»ºä¸€ä¸ªQObjectå¯¹è±¡ï¼Œå®ƒçš„threadDataï¼Œå°†å’Œparentä¸€è‡´ã€‚è‹¥parentæ²¡æœ‰threadDataï¼Œæˆ–è€…æ˜¯æ²¡æœ‰parentï¼Œå°†è°ƒç”¨QThreadData::currentè·å–ä¸€ä¸ªæ–°çš„ã€å½“å‰çº¿ç¨‹çš„QThreadDataï¼Œå¹¶ä¸”å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºä¸€ä¸ªQAdoptedThreadçš„å®ä¾‹ã€‚</p><p>ä¸‹é¢çœ‹ä¸€ä¸‹QEventLoop::processEventsçš„å®ç°ï¼ŒQEventLoop::exec()æœ€ç»ˆè°ƒå…¥æ­¤å¤„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">QEventLoop::processEvents</span><span class="params">(ProcessEventsFlags flags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Q_D(QEventLoop);</span><br><span class="line">    <span class="keyword">if</span> (!d-&gt;threadData-&gt;eventDispatcher)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (flags &amp; DeferredDeletion)</span><br><span class="line">        QCoreApplication::sendPostedEvents(<span class="number">0</span>, QEvent::DeferredDelete);</span><br><span class="line">    <span class="keyword">return</span> d-&gt;threadData-&gt;eventDispatcher-&gt;processEvents(flags);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸæ¥QEventLoopä½œä¸ºä¸€ä¸ªQObjectï¼Œå®ƒä¹Ÿæœ‰threadDataã€‚åŒä¸€ä¸ªçº¿ç¨‹threadDataåªåˆ›å»ºä¸€æ¬¡ï¼Œæ‰€ä»¥å®ƒä»¬å–å‡ºæ¥çš„eventDispatcherä¹Ÿéƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™æ„å‘³ç€æ‰€æœ‰çš„ç›¸åŒçº¿ç¨‹çš„QObjectï¼Œå…±äº«ä¸€ä»½threadDataï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä»½eventDispatcher, postEventListç­‰ã€‚è¿™ä¹Ÿå°±è¯´æ˜äº†ï¼Œæˆ‘ä»¬ä¸‹å›¾æ˜¯å¦‚ä½•å®ç°çš„ï¼š</p><p>äº‹ä»¶ä¿å­˜åœ¨QThreadData::postEventListä¸­ï¼Œä¸åŒçº¿ç¨‹æœ‰ä¸åŒçš„QThreadDataå®ä¾‹</p><h2 id="3-QThread"><a href="#3-QThread" class="headerlink" title="3. QThread"></a>3. QThread</h2><p>æ¥ä¸‹æ¥çœ‹çœ‹å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">QThreadPrivate::QThreadPrivate(QThreadData *d)</span><br><span class="line">    : QObjectPrivate(), running(<span class="literal">false</span>), finished(<span class="literal">false</span>), terminated(<span class="literal">false</span>), exited(<span class="literal">false</span>), returnCode(<span class="number">-1</span>),</span><br><span class="line">      stackSize(<span class="number">0</span>), priority(QThread::InheritPriority), data(d)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (!data)</span><br><span class="line">        data = <span class="keyword">new</span> QThreadData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QThread::QThread(QObject *parent)</span><br><span class="line">    : QObject(*(<span class="keyword">new</span> QThreadPrivate), parent)</span><br><span class="line">&#123;</span><br><span class="line">    Q_D(QThread);</span><br><span class="line">    <span class="comment">// fprintf(stderr, "QThreadData %p created for thread %p\n", d-&gt;data, this);</span></span><br><span class="line">    d-&gt;data-&gt;thread = <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“æ–°å»ºä¸€ä¸ªQThreadæ—¶ï¼ŒäºŒè¯ä¸è¯´å®ƒå…ˆæ˜¯å»ºç«‹äº†ä¸€ä¸ªæ–°çš„QThreadDataï¼Œå¹¶è®¾ç½®threadä¸ºè‡ªå·±ã€‚å’ŒQThreadData::currentä¸åŒçš„æ˜¯ï¼ŒQThreadData::currentæ˜¯è¢«åŠ¨ç”Ÿæˆä¸€ä¸ªQThreadDataï¼Œå› ä¸ºå®ƒå¹¶æ²¡æœ‰æŒ‡å®šæŸä¸ªQThreadã€‚è€Œåˆ›å»ºQThreadåˆ™å¯ä»¥â€œåæ­£è¨€é¡ºâ€åˆ›å»ºQThreadDataï¼Œç„¶åå°†å®ƒçš„threadè®¾ç½®ä¸ºè‡ªå·±ã€‚ç”±äºå®ƒè¿˜æ²¡æœ‰æ‰§è¡Œï¼Œå› æ­¤å¹¶æ²¡æœ‰è®¾ç½®TLSã€‚</p><p>å½“ä¸€ä¸ªQThreadè¦å¼€å§‹æ‰§è¡Œåï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QThread::start</span><span class="params">(Priority priority)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    d-&gt;handle = (Qt::HANDLE) _beginthreadex(<span class="literal">NULL</span>, d-&gt;stackSize, QThreadPrivate::start,</span><br><span class="line">                                            <span class="keyword">this</span>, CREATE_SUSPENDED, &amp;(d-&gt;id));</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> __stdcall <span class="title">QThreadPrivate::start</span><span class="params">(<span class="keyword">void</span> *arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QThread *thr = <span class="keyword">reinterpret_cast</span>&lt;QThread *&gt;(arg);</span><br><span class="line">    QThreadData *data = QThreadData::get2(thr);</span><br><span class="line"></span><br><span class="line">    qt_create_tls();</span><br><span class="line">    TlsSetValue(qt_current_thread_data_tls_index, data);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    data-&gt;quitNow = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// ### <span class="doctag">TODO:</span> allow the user to create a custom event dispatcher</span></span><br><span class="line">    createEventDispatcher(data);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒTLSè¢«è®¾ç½®æˆäº†åˆšåˆšQThreadåˆ›å»ºçš„QThreadDataå®ä¾‹ï¼Œé‚£ä¹ˆä¹‹ååœ¨è¿™ä¸ªçº¿ç¨‹ä¸­ï¼ŒQThreadData::currentå°±å¯ä»¥å–åˆ°å¯¹åº”çš„ä¿¡æ¯äº†ã€‚å®ƒç´§æ¥ç€åˆ›å»ºäº†event dispatcherï¼Œä¹Ÿå°±æ˜¯QEventDispatcherWin32ï¼Œå¹¶ä¸”å¡ç»™äº†QThreadDataï¼Œä¿è¯è¿™ä¸ªçº¿ç¨‹ä¸­çš„æ¶ˆæ¯å¾ªç¯éƒ½æ˜¯é€šè¿‡æ­¤QEventDispatcherWin32ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸æ˜¯é€šè¿‡QThreadåˆ›å»ºçš„QThreadDataï¼ˆå³é€šè¿‡QThreadData::currentæ¥åˆ›å»ºçš„ï¼‰é»˜è®¤æ˜¯æ²¡æœ‰event dispatcherçš„ï¼Œæ‰€ä»¥ä½ æ— æ³•å¯¹ä¸€ä¸ªå­¤ç«‹çš„QObjectåˆ†å‘äº‹ä»¶ã€‚QCoreApplicationå¹¶æ²¡æœ‰ç»§æ‰¿QThreadï¼Œå®ƒé€šè¿‡QThreadData::currentè·å–äº†å®ä¾‹åè‡ªå·±è®¾ç½®äº†event dispatcheræ¥å®ç°æ¶ˆæ¯çš„åˆ†å‘ã€‚</p><p>è¿™æ ·ä¸€æ¥ä¸€åˆ‡éƒ½è¯´å¾—é€šäº†ï¼Œä¸ºä»€ä¹ˆäº‹ä»¶æ˜¯è·Ÿç€çº¿ç¨‹èµ°çš„ï¼Œä¸ºä»€ä¹ˆæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„æ¶ˆæ¯å¾ªç¯ï¼Œä¸ºä»€ä¹ˆéœ€è¦moveToThreadï¼Œä¸€åˆ‡åŸå› ï¼Œéƒ½åœ¨QThreadDataé‡Œã€‚</p><h2 id="4-QWidgetæ¶ˆæ¯å¾ªç¯"><a href="#4-QWidgetæ¶ˆæ¯å¾ªç¯" class="headerlink" title="4. QWidgetæ¶ˆæ¯å¾ªç¯"></a>4. QWidgetæ¶ˆæ¯å¾ªç¯</h2><p>åˆšåˆšçœ‹åˆ°æ¯ä¸€ä¸ªQEventDispatcherWin32éƒ½ä¼šåˆ›å»ºä¸€ä¸ªéšè—çš„çª—å£æ¥å¤„ç†WM_TIMERç­‰äº‹ä»¶ï¼Œå¯¹äºæ™®é€šçš„QWidgetæ¥è¯´ï¼Œå®ƒä»¬çš„æ¶ˆæ¯å¤„ç†å‡½æ•°å«åšQtWndProcï¼Œå®šä¹‰åœ¨äº†qapplication_win.cppä¸­ã€‚å®ƒé‡Œé¢æ— éå°±æ˜¯å°†æ‹¿åˆ°çš„HWNDæ˜ å°„åˆ°æ­£ç¡®çš„QWidgetä¸­ï¼Œç„¶åç¿»è¯‘æˆQtäº‹ä»¶ã€‚Qtå¾ˆå·§å¦™åœ°å°†QWidget<em>å¼ºè¡Œè½¬æ¢ä¸ºäº†QETWidget</em>ï¼Œå®ç°äº†ç§æœ‰æˆå‘˜çš„å°è£…ï¼Œä¸è¿‡è¿™ä¸ªå°±å·²ç»è¶…è¿‡æˆ‘ä»¬è®¨è®ºçš„èŒƒç•´äº†ã€‚</p><p>ä»¥ä¸Šä¾¿æ˜¯Qtæ¶ˆæ¯å¾ªç¯å’Œçº¿ç¨‹ç›¸å…³çš„ç§˜å¯†ï¼Œè™½ç„¶Qt5çš„ä»£ç è¿˜æ²¡æœ‰ä»”ç»†ç ”ç©¶è¿‡ï¼Œä½†æ˜¯å¤§ä½“ä¸Šå˜åŒ–åº”è¯¥ä¸å¤§ï¼Œå¸Œæœ›å¤§å®¶çœ‹å®Œåï¼Œèƒ½å¯¹Qtæœ‰ä¸€ä¸ªã€å§æ§½å¥½å±Œå•Šã€‘è¿™æ ·çš„æ„Ÿå—ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Warning: File &#39;tests/checkasm/Makefile&#39; has modification time 56376655 s in</title>
      <link href="/2020/06/27/warning-file-tests-checkasm-makefile-has-modification-time-56376655-s-in/"/>
      <url>/2020/06/27/warning-file-tests-checkasm-makefile-has-modification-time-56376655-s-in/</url>
      
        <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find . -type f | xargs -n 5 touch</span><br><span class="line">make clean</span><br><span class="line">make</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpegå½•å±</title>
      <link href="/2020/06/27/ffmpeg-lu-ping/"/>
      <url>/2020/06/27/ffmpeg-lu-ping/</url>
      
        <content type="html"><![CDATA[<p>Linux</p><pre class=" language-shell"><code class="language-shell">ffmpeg -video_size 1820x900 -framerate 25 -f x11grab -i :0.0 -t 5 output1.mp4</code></pre><p><a href="https://trac.ffmpeg.org/wiki/Capture/Desktop" target="_blank" rel="noopener" title="https://trac.ffmpeg.org/wiki/Capture/Desktop">https://trac.ffmpeg.org/wiki/Capture/Desktop</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹Qtå®ç°æ— è¾¹æ¡†å¯ç¼©æ”¾çš„çª—å£</title>
      <link href="/2020/06/27/linux-xia-qt-shi-xian-wu-bian-kuang-ke-suo-fang-de-chuang-kou/"/>
      <url>/2020/06/27/linux-xia-qt-shi-xian-wu-bian-kuang-ke-suo-fang-de-chuang-kou/</url>
      
        <content type="html"><![CDATA[<h1 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h1><p>åœ¨Linuxå¹³å°ä¸Šåšdesktopåº”ç”¨çš„è¿˜æ˜¯éå¸¸å°‘çš„ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šç½‘ä¸Šè¿™éƒ¨åˆ†èµ„æ–™æ˜¯æ²¡æœ‰çš„ã€‚Linuxå¹³å°åˆä¸åƒWiné‚£ä¹ˆå¤šAPIã€‚è¿™æ¬¡çš„å®ç°ï¼Œæœ¬æ¥è‡ªå·±æƒ³å†™xlibçš„å‡½æ•°çš„ï¼Œç„¶åæœºæ™ºçš„æˆ‘ä»deepinçš„ä»£ç é‡ŒæŠŠä»–ä»¬å°è£…å¥½çš„æŠ å‡ºæ¥äº†ï¼Œç„¶åè¡¥å……äº†ä¸€äº›x11çš„å°è£…å‡½æ•°ã€‚æ¥å®Œæˆæœ€ç»ˆçš„æ•ˆæœã€‚</p><p>æœ¬ç¯‡æ–‡ç« çº¯ç²¹æŠ›ç –å¼•ç‰ï¼Œæ¯•ç«Ÿåªæ˜¯ä¸ªdemoã€‚ç®€å•çš„è¯´ä¸€ä¸‹é‡åˆ°çš„å‘ã€‚</p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>å®ç°ä¸Šå¾ˆç®€å•ï¼Œé‡å†™qtçš„ä¸‰ä¸ªå‡½æ•°å°±å¯ä»¥ã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">void</span> FLWidget_Linux<span class="token operator">::</span><span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>QMouseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_LINUX</span>     <span class="token keyword">const</span> <span class="token keyword">int</span> x <span class="token operator">=</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">const</span> <span class="token keyword">int</span> y <span class="token operator">=</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>resizingCornerEdge <span class="token operator">==</span> XUtils<span class="token operator">::</span>CornerEdge<span class="token operator">::</span>kInvalid<span class="token punctuation">)</span>     <span class="token punctuation">{</span>      XUtils<span class="token operator">::</span><span class="token function">UpdateCursorShape</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">layout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">contentsMargins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ResizeHandleWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span> <span class="token keyword">return</span> QWidget<span class="token operator">::</span><span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> FLWidget_Linux<span class="token operator">::</span><span class="token function">mousePressEvent</span><span class="token punctuation">(</span>QMouseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_LINUX</span> <span class="token keyword">const</span> <span class="token keyword">int</span> x <span class="token operator">=</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">const</span> <span class="token keyword">int</span> y <span class="token operator">=</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token operator">-</span><span class="token operator">></span><span class="token function">button</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Qt<span class="token operator">::</span>LeftButton<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> XUtils<span class="token operator">::</span>CornerEdge ce <span class="token operator">=</span> XUtils<span class="token operator">::</span><span class="token function">GetCornerEdge</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">layout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">contentsMargins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ResizeHandleWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>ce <span class="token operator">!=</span> XUtils<span class="token operator">::</span>CornerEdge<span class="token operator">::</span>kInvalid<span class="token punctuation">)</span>      <span class="token punctuation">{</span>           resizingCornerEdge <span class="token operator">=</span> ce<span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//send x11 move event dont send mouserrelease event</span>           XUtils<span class="token operator">::</span><span class="token function">SendButtonRelease</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">globalPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           XUtils<span class="token operator">::</span><span class="token function">StartResizing</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> QCursor<span class="token operator">::</span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ce<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span> <span class="token keyword">return</span> QWidget<span class="token operator">::</span><span class="token function">mousePressEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> FLWidget_Linux<span class="token operator">::</span><span class="token function">mouseReleaseEvent</span><span class="token punctuation">(</span>QMouseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_LINUX</span>     resizingCornerEdge <span class="token operator">=</span> XUtils<span class="token operator">::</span>CornerEdge<span class="token operator">::</span>kInvalid<span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span></span>     <span class="token keyword">return</span> QWidget<span class="token operator">::</span><span class="token function">mouseReleaseEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>åªé‡å†™è¿™ä¸‰ä¸ªå‡½æ•°å°±å¯ä»¥å®Œæˆå¯¹åº”çš„åŠŸèƒ½ï¼Œå½“ç„¶è¿˜å¾—æœ‰XUtilsã€‚<br>XUtilsæ˜¯deepinå°è£…çš„ä¸€ä¸ªåŠŸèƒ½namespaceã€‚å°è£…äº†å¸¸ç”¨çš„xlibæ“ä½œqtçš„widgetçš„ä¸€äº›å‡½æ•°ã€‚<br>ç„¶åæˆ‘è¡¥å……äº†ä¸€ä¸ªä»–ä»¬çš„å‡½æ•°</p><p>ä¸»è¦æ˜¯è°ƒç”¨çš„xlibçš„mousemoveä¹‹åï¼ŒQtæ¥å—ä¸åˆ°releaseäº‹ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨å†å‘ä¸€ä¸ª</p><pre class=" language-cpp"><code class="language-cpp">XUtils<span class="token operator">::</span><span class="token function">SendButtonRelease</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> event<span class="token operator">-</span><span class="token operator">></span><span class="token function">globalPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">SendButtonRelease</span><span class="token punctuation">(</span><span class="token keyword">const</span> QWidget <span class="token operator">*</span>widget<span class="token punctuation">,</span>          <span class="token keyword">const</span> QPoint <span class="token operator">&amp;</span>pos<span class="token punctuation">,</span> <span class="token keyword">const</span> QPoint <span class="token operator">&amp;</span>globalPos<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">const</span> <span class="token keyword">auto</span> display <span class="token operator">=</span> QX11Info<span class="token operator">::</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">const</span> <span class="token keyword">auto</span> screen <span class="token operator">=</span> QX11Info<span class="token operator">::</span><span class="token function">appScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> XEvent xevent<span class="token punctuation">;</span> <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>xevent<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>XEvent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>type <span class="token operator">=</span> ButtonRelease<span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>button <span class="token operator">=</span> Button1<span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>window <span class="token operator">=</span> widget<span class="token operator">-</span><span class="token operator">></span><span class="token function">effectiveWinId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>x <span class="token operator">=</span> pos<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>y <span class="token operator">=</span> pos<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>x_root <span class="token operator">=</span> globalPos<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>y_root <span class="token operator">=</span> globalPos<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xevent<span class="token punctuation">.</span>xbutton<span class="token punctuation">.</span>display <span class="token operator">=</span> display<span class="token punctuation">;</span> <span class="token function">XSendEvent</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> widget<span class="token operator">-</span><span class="token operator">></span><span class="token function">effectiveWinId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> False<span class="token punctuation">,</span> ButtonReleaseMask<span class="token punctuation">,</span> <span class="token operator">&amp;</span>xevent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">XFlush</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>æ˜¨å¤©æ•´ç†äº†ä¸‹æ–‡æ¡£ï¼Œå‘åˆ°githubä¸Šäº†ï¼Œæ¬¢è¿starè·Ÿfork</p><p><a href="https://github.com/CryFeiFei/FLWidget" target="_blank" rel="noopener" title="https://github.com/CryFeiFei/FLWidget">https://github.com/CryFeiFei/FLWidget</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Linux </tag>
            
            <tag> æ— è¾¹æ¡† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsä¸‹Qtæ— è¾¹æ¡†å¯å˜åŒ–çš„å®ç°</title>
      <link href="/2020/06/27/windows-xia-qt-wu-bian-kuang-ke-bian-hua-de-shi-xian/"/>
      <url>/2020/06/27/windows-xia-qt-wu-bian-kuang-ke-bian-hua-de-shi-xian/</url>
      
        <content type="html"><![CDATA[<pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">ifndef</span> FLWIDGET_H</span><span class="token macro property">#<span class="token directive keyword">define</span> FLWIDGET_H</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QWidget></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QMouseEvent></span></span><span class="token keyword">class</span> <span class="token class-name">FLWidget</span> <span class="token operator">:</span> <span class="token keyword">public</span> QWidget<span class="token punctuation">{</span> Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span> <span class="token keyword">explicit</span> <span class="token function">FLWidget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">~</span><span class="token function">FLWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span> <span class="token keyword">bool</span> <span class="token function">nativeEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> QByteArray <span class="token operator">&amp;</span>eventType<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>message<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token operator">*</span>result<span class="token punctuation">)</span> override<span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token function">mousePressEvent</span><span class="token punctuation">(</span>QMouseEvent<span class="token operator">*</span> e<span class="token punctuation">)</span> override<span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>QMouseEvent<span class="token operator">*</span> e<span class="token punctuation">)</span> override<span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span> <span class="token keyword">int</span> m_bouderWidth<span class="token punctuation">;</span> QPoint m_curPos<span class="token punctuation">;</span>signals<span class="token operator">:</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">// FLWIDGET_H</span><span class="token comment" spellcheck="true">// cpp</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"flwidget.h"</span></span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_WIN</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;windows.h></span></span><span class="token comment" spellcheck="true">//æ³¨æ„å¤´æ–‡ä»¶</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;windowsx.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QMouseEvent></span></span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token keyword">namespace</span><span class="token punctuation">{</span>    <span class="token keyword">constexpr</span> <span class="token keyword">int</span> BOUDERWIDTH <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token punctuation">}</span>FLWidget<span class="token operator">::</span><span class="token function">FLWidget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_bouderWidth</span><span class="token punctuation">(</span>BOUDERWIDTH<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">setMouseTracking</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token operator">::</span>FramelessWindowHint <span class="token operator">|</span> Qt<span class="token operator">::</span>Dialog<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"background:red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>FLWidget<span class="token operator">::</span><span class="token operator">~</span><span class="token function">FLWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">void</span> FLWidget<span class="token operator">::</span><span class="token function">mousePressEvent</span><span class="token punctuation">(</span>QMouseEvent <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_WIN</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token operator">-</span><span class="token operator">></span><span class="token function">button</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Qt<span class="token operator">::</span>LeftButton<span class="token punctuation">)</span>        m_curPos <span class="token operator">=</span> e<span class="token operator">-</span><span class="token operator">></span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span></span>    <span class="token keyword">return</span> QWidget<span class="token operator">::</span><span class="token function">mousePressEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> FLWidget<span class="token operator">::</span><span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>QMouseEvent <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_WIN</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token operator">-</span><span class="token operator">></span><span class="token function">buttons</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> Qt<span class="token operator">::</span>LeftButton<span class="token punctuation">)</span>        <span class="token function">move</span><span class="token punctuation">(</span>e<span class="token operator">-</span><span class="token operator">></span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> m_curPos<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span></span>    <span class="token keyword">return</span> QWidget<span class="token operator">::</span><span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">bool</span> FLWidget<span class="token operator">::</span><span class="token function">nativeEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> QByteArray <span class="token operator">&amp;</span>eventType<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>message<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_WIN</span>    MSG<span class="token operator">*</span> msg <span class="token operator">=</span> <span class="token punctuation">(</span>MSG<span class="token operator">*</span><span class="token punctuation">)</span>message<span class="token punctuation">;</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>msg<span class="token operator">-</span><span class="token operator">></span>message<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">case</span> WM_NCHITTEST<span class="token operator">:</span>            <span class="token keyword">int</span> xPos <span class="token operator">=</span> <span class="token function">GET_X_LPARAM</span><span class="token punctuation">(</span>msg<span class="token operator">-</span><span class="token operator">></span>lParam<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">frameGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> yPos <span class="token operator">=</span> <span class="token function">GET_Y_LPARAM</span><span class="token punctuation">(</span>msg<span class="token operator">-</span><span class="token operator">></span>lParam<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">frameGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> nUseFulWidth <span class="token operator">=</span> <span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> m_bouderWidth<span class="token punctuation">;</span>            <span class="token keyword">int</span> nUseFulHeight <span class="token operator">=</span> <span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> m_bouderWidth<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>xPos <span class="token operator">&lt;</span> m_bouderWidth <span class="token operator">&amp;&amp;</span> yPos <span class="token operator">&lt;</span> m_bouderWidth<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//å·¦ä¸Šè§’</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTTOPLEFT<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xPos<span class="token operator">>=</span> nUseFulWidth <span class="token operator">&amp;&amp;</span> yPos <span class="token operator">&lt;</span> m_bouderWidth<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//å³ä¸Šè§’</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTTOPRIGHT<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xPos <span class="token operator">&lt;</span> m_bouderWidth <span class="token operator">&amp;&amp;</span> yPos <span class="token operator">>=</span> nUseFulHeight<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//å·¦ä¸‹è§’</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTBOTTOMLEFT<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xPos <span class="token operator">>=</span> nUseFulWidth <span class="token operator">&amp;&amp;</span> yPos <span class="token operator">>=</span> nUseFulHeight<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//å³ä¸‹è§’</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTBOTTOMRIGHT<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xPos <span class="token operator">&lt;</span> m_bouderWidth<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//å·¦è¾¹</span>                <span class="token operator">*</span>result <span class="token operator">=</span>  HTLEFT<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xPos <span class="token operator">>=</span> nUseFulWidth<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//å³è¾¹</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTRIGHT<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>yPos <span class="token operator">&lt;</span> m_bouderWidth<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//ä¸Šè¾¹</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTTOP<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>yPos <span class="token operator">>=</span> nUseFulHeight<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//ä¸‹è¾¹</span>                <span class="token operator">*</span>result <span class="token operator">=</span> HTBOTTOM<span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span>    <span class="token keyword">return</span> QWidget<span class="token operator">::</span><span class="token function">nativeEvent</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> message<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ­¤å¤„è¿”å›falseï¼Œç•™ç»™å…¶ä»–äº‹ä»¶å¤„ç†å™¨å¤„ç†</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹ä½¿ç”¨WPSåšofficeçš„äºŒæ¬¡å¼€å‘</title>
      <link href="/2020/06/27/linux-xia-shi-yong-wps-zuo-office-de-er-ci-kai-fa/"/>
      <url>/2020/06/27/linux-xia-shi-yong-wps-zuo-office-de-er-ci-kai-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h1><p>ä¸Šä¸ªç‰ˆæœ¬WPSåœ¨Linuxä¸Šå°±å·²ç»æ”¯æŒäºŒæ¬¡å¼€å‘äº†ï¼Œå¯ä»¥ç›´æ¥å»çœ‹å®˜ç½‘ç›¸å…³çš„ä»‹ç»ã€‚<a href="https://open.wps.cn/" target="_blank" rel="noopener">https://open.wps.cn/</a></p><p>æˆ‘ä»¬é€‰æ‹©WPSçš„å®¢æˆ·ç«¯è¿›è¡ŒäºŒæ¬¡å¼€å‘</p><h1 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h1><ul><li>Ubuntu18.04</li><li>wps-office_11.1.0.9126_amd64.deb</li><li>Qtçš„å¼€å‘ç¯å¢ƒï¼ˆæˆ‘æœ¬åœ°5.14ï¼‰</li></ul><h1 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h1><h2 id="ä¸‹è½½WPSçš„äºŒæ¬¡å¼€å‘demo"><a href="#ä¸‹è½½WPSçš„äºŒæ¬¡å¼€å‘demo" class="headerlink" title="ä¸‹è½½WPSçš„äºŒæ¬¡å¼€å‘demo"></a>ä¸‹è½½WPSçš„äºŒæ¬¡å¼€å‘demo</h2><p>æˆ‘ä»¬å†™äº†ä¸€äº›WPSçš„äºŒæ¬¡å¼€å‘demoæ¥ç»™å¤§å®¶å­¦ä¹ </p><p>C++è·ŸQtä»£ç é£æ ¼è·Ÿæˆ‘ä»¬å†…éƒ¨ç¼–ç é£æ ¼ä¿æŒä¸€è‡´ã€‚å¯ä»¥çœ‹çœ‹ã€‚</p><pre class=" language-shell"><code class="language-shell">// è¿™ä¸ªé“¾æ¥æ˜¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œå·²ç»å¤±æ•ˆgit clone https://git.dev.tencent.com/zouyingfeng/wps.git</code></pre><p>è¿™æ˜¯ç°åœ¨çš„è·¯å¾„ã€‚ <a href="https://zouyingfeng.coding.net/p/wps/d/wps/git/tree/master" target="_blank" rel="noopener" title="https://zouyingfeng.coding.net/p/wps/d/wps/git/tree/master">https://zouyingfeng.coding.net/p/wps/d/wps/git/tree/master</a></p><p>ç„¶åè¿›å…¥cppçš„demoçš„æ–‡ä»¶å¤¹</p><p>tips</p><p>æˆ‘è¿™æ˜¯Ubuntu18.04ï¼Œè¿™é‡Œcppçš„proæ–‡ä»¶è¿˜æ˜¯è¦ç¨å¾®æ”¹ä¸€ä¸‹</p><pre class=" language-cpp"><code class="language-cpp">LIBS <span class="token operator">+</span><span class="token operator">=</span> libc<span class="token operator">++</span>abi<span class="token punctuation">.</span>so<span class="token number">.1</span></code></pre><p>//æ”¹æˆ</p><pre class=" language-cpp"><code class="language-cpp">LIBS <span class="token operator">+</span><span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>kingsoft<span class="token operator">/</span>wps<span class="token operator">-</span>office<span class="token operator">/</span>office6<span class="token operator">/</span>libc<span class="token operator">++</span>abi<span class="token punctuation">.</span>so<span class="token number">.1</span></code></pre><p>éœ€è¦åˆ¶å®šä¸‹è¿™ä¸ªè·¯å¾„ã€‚ç„¶åå°±å¯ä»¥ç¼–è¯‘è¿‡äº†ï¼Œå¦åˆ™å¯èƒ½ä¼šæ‰¾ä¸åˆ°libc++abi.so.1çš„åº“ã€‚</p><p>æ¥ä¸‹æ¥ä½¿ç”¨</p><pre class=" language-cpp"><code class="language-cpp">qmakemake</code></pre><p>ç„¶åæ‰§è¡Œ<br>wpsDemoå¯æ‰§è¡Œæ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p><p>ç„¶åç‚¹å‡»</p><p>åˆå§‹åŒ–<br>æ–°å»ºæ–‡æ¡£<br>å°±å¯ä»¥æ–°å»ºæ–‡æ¡£äº†</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æˆ‘è¿™æ˜¯ä¸ªå®˜æ–¹çš„demoï¼Œç¤¾åŒºç”¨æˆ·å¯ä»¥è‡ªå·±ç”¨è¿™ä¸ªdemoæŠŠç•Œé¢éšè—ï¼Œç„¶åå¯ä»¥è‡ªå·±åšä¸€ä¸ªå‘½ä»¤è¡Œæ‰¹é‡è½¬åŒ–pdfçš„å°å·¥å…·</p><h2 id="PS-å…³äºpythonçš„æ¥å£"><a href="#PS-å…³äºpythonçš„æ¥å£" class="headerlink" title="PS å…³äºpythonçš„æ¥å£"></a>PS å…³äºpythonçš„æ¥å£</h2><p>æˆ‘çš„ä¸€ä¸ªåŒäº‹ç”¨pythonçš„swigå°è£…äº†è¿™ä¸ªc++æ¥å£ï¼Œç„¶åææˆäº†pythonåº“ï¼Œæœ‰å…´è¶£å¯ä»¥githubçœ‹ä¸€ä¸‹</p><p>ä¸Šåœ°å€<br><a href="https://github.com/timxx/pywpsrpc" target="_blank" rel="noopener" title="https://github.com/timxx/pywpsrpc">https://github.com/timxx/pywpsrpc</a></p><p>ä½œè€…æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„ä¸€ä¸ªå¤§ä½¬ï¼Œçƒ­å¿ƒäººï¼ŒWPSçš„æ’å…¥å…¬å¼çš„åŠŸèƒ½å°±æ˜¯ä»–é—¨å‡ ä¸ªåšçš„ï¼Œä¹Ÿå¯ä»¥æ¬¢è¿éªšæ‰°ä»–ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> WPS </tag>
            
            <tag> office </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ¸…ç©ºå›æ”¶ç«™</title>
      <link href="/2020/06/27/linux-qing-kong-hui-shou-zhan/"/>
      <url>/2020/06/27/linux-qing-kong-hui-shou-zhan/</url>
      
        <content type="html"><![CDATA[<pre class=" language-shell"><code class="language-shell">rm -rf $HOME/.local/share/Trash/files/*</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘è“æ´¾æ­å»ºwordpress</title>
      <link href="/2020/06/27/shu-mei-pai-da-jian-wordpress/"/>
      <url>/2020/06/27/shu-mei-pai-da-jian-wordpress/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è·ŸUbuntuæ˜¯å·®ä¸å¤šçš„ã€‚<br>æŠŠmysqlæ¢æˆäº†mariadb</p><pre class=" language-shell"><code class="language-shell">sudo apt updatesudo apt-get install apache2 -ysudo apt-get install php7.0 -ysudo apt-get install libapache2-mod-php7.3sudo apt install php7.3-mysql sudo apt install phpmyadmin -ysudo apt install mariadb-server// é‡å¯æœåŠ¡sudo systemctl restart mariadbsudo systemctl restart apache2.service</code></pre><h1 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h1><pre class=" language-shell"><code class="language-shell">sudo mysql -u root -pCREATE DATABASE wordpress;CREATE USER wordpressuser;SET PASSWORD FOR wordpressuser= PASSWORD("password123");GRANT ALL PRIVILEGES ON wordpress.* TO wordpressuser IDENTIFIED BY"password123";FLUSH PRIVILEGES;exit;</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘è“æ´¾ </tag>
            
            <tag> wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mdè½¬åŒ–ä¸ºå¾®ä¿¡å…¬ä¼—å·æ ¼å¼</title>
      <link href="/2020/06/27/md-zhuan-hua-wei-wei-xin-gong-zhong-hao-ge-shi/"/>
      <url>/2020/06/27/md-zhuan-hua-wei-wei-xin-gong-zhong-hao-ge-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h2><p>å¹³æ—¶å†™çš„æŠ€æœ¯æ–‡æ¡£éƒ½æ˜¯markdownçš„å½¢å¼ã€‚æ‰€ä»¥ç­¾åˆ°å…¬ä¼—å·ä¸Šæ€¥éœ€ä¸€ä¸ªè½¬åŒ–å·¥å…·ï¼Œæ‰€å¹¸åœ¨githubä¸Šæ‰¾åˆ°äº†ã€‚</p><h2 id="åœ°å€0"><a href="#åœ°å€0" class="headerlink" title="åœ°å€0"></a>åœ°å€0</h2><p>åœ¨çº¿ä½¿ç”¨åœ°å€ï¼š <a href="http://blog.didispace.com/tools/online-markdown/" target="_blank" rel="noopener">http://blog.didispace.com/tools/online-markdown/</a><br>githubåœ°å€ï¼š<a href="https://github.com/dyc87112/online-markdown" target="_blank" rel="noopener">https://github.com/dyc87112/online-markdown</a></p><h2 id="åœ°å€1"><a href="#åœ°å€1" class="headerlink" title="åœ°å€1"></a>åœ°å€1</h2><p>åœ¨çº¿ä½¿ç”¨åœ°å€ï¼š<a href="https://lab.lyric.im/wxformat/" target="_blank" rel="noopener">https://lab.lyric.im/wxformat/</a><br>githubåœ°å€ï¼š<a href="https://github.com/CryFeiFei/wechat-format" target="_blank" rel="noopener">https://github.com/CryFeiFei/wechat-format</a></p><h2 id="æˆ‘å¸¸ç”¨çš„"><a href="#æˆ‘å¸¸ç”¨çš„" class="headerlink" title="æˆ‘å¸¸ç”¨çš„"></a>æˆ‘å¸¸ç”¨çš„</h2><p><a href="https://mdnice.com/" target="_blank" rel="noopener">https://mdnice.com/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> markdown </tag>
            
            <tag> å¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹u</title>
      <link href="/2020/06/27/linux-xia-du-ming-ling/"/>
      <url>/2020/06/27/linux-xia-du-ming-ling/</url>
      
        <content type="html"><![CDATA[<pre class=" language-shell"><code class="language-shell">du:#    æŸ¥çœ‹å„ç›®å½•æˆ–æ–‡ä»¶æ‰€å ç©ºé—´    -s #åªæ˜¾ç¤ºæ€»å’Œå¤§å°    -a #/ all æ˜¾ç¤ºæ‰€æœ‰å¤§å°ï¼ˆåŒ…æ‹¬æ–‡ä»¶ï¼‰    -h #å‹å¥½æ ¼å¼æ˜¾ç¤ºï¼Œæ¯”å¦‚ç”¨K/M/Gè¡¨ç¤ºå¤§å°ã€‚    --max-depth=N #ç»Ÿè®¡çš„ç›®å½•æ·±åº¦ã€‚å½“N=0æ—¶ç­‰åŒäº-sï¼Œæ‰€ä»¥å’Œ--så‚æ•°ä¸èƒ½åŒæ—¶å‡ºç°ã€‚    -b #æ˜¾ç¤ºä¸ºå­—èŠ‚æ•°ã€‚    -k #æ˜¾ç¤ºä¸ºKå­—èŠ‚æ•°ã€‚    -m #æ˜¾ç¤ºä¸ºå…†å­—èŠ‚æ•°ã€‚du#åªæ˜¾ç¤ºå½“å‰ç›®å½•å­ç›®å½•çš„å¤§å°å’Œå½“å‰ç›®å½•çš„æ€»çš„å¤§å°ï¼Œæœ€ä¸‹é¢çš„. ä¸ºå½“å‰ç›®å½•çš„æ€»å¤§å°du log2012.log #æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ‰€å ç©ºé—´du scf#æŸ¥çœ‹æŒ‡å®šç›®å½•çš„æ‰€å ç©ºé—´du -s//du -s mulu#åªæ˜¾ç¤ºæ€»å’Œçš„å¤§å°du -ah mulu#æ–‡ä»¶å’Œç›®å½•éƒ½æ˜¾ç¤ºdu -h --max-depth=1#è¾“å‡ºå½“å‰ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> du </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsæ¿€æ´»</title>
      <link href="/2020/06/27/windows-ji-huo/"/>
      <url>/2020/06/27/windows-ji-huo/</url>
      
        <content type="html"><![CDATA[<pre class=" language-shell"><code class="language-shell">slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX  //å®‰è£…win10ä¸“ä¸šç‰ˆå¯†é’¥slmgr /skms zh.us.to //è®¾ç½®kmsæœåŠ¡å™¨slmgr /ato //æ¿€æ´»win10ä¸“ä¸šç‰ˆç³»ç»Ÿslmgr /xpr //æŸ¥çœ‹ä¸“ä¸šç‰ˆæ¿€æ´»çŠ¶æ€</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­æ–‡Unicodeç å­—ç¬¦èŒƒå›´</title>
      <link href="/2020/06/27/zhong-wen-unicode-ma-zi-fu-fan-wei/"/>
      <url>/2020/06/27/zhong-wen-unicode-ma-zi-fu-fan-wei/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th>å­—ç¬¦é›†</th><th>å­—æ•°</th><th>Unicode ç¼–ç </th></tr></thead><tbody><tr><td>åŸºæœ¬æ±‰å­—</td><td>20902å­—</td><td>4E00-9FA5</td></tr><tr><td>åŸºæœ¬æ±‰å­—è¡¥å……</td><td>74å­—</td><td>9FA6-9FEF</td></tr><tr><td>æ‰©å±•A</td><td>6582å­—</td><td>3400-4DB5</td></tr><tr><td>æ‰©å±•B</td><td>42711å­—</td><td>20000-2A6D6</td></tr><tr><td>æ‰©å±•C</td><td>4149å­—</td><td>2A700-2B734</td></tr><tr><td>æ‰©å±•D</td><td>222å­—</td><td>2B740-2B81D</td></tr><tr><td>æ‰©å±•E</td><td>5762å­—</td><td>2B820-2CEA1</td></tr><tr><td>æ‰©å±•F</td><td>7473å­—</td><td>2CEB0-2EBE0</td></tr><tr><td>åº·ç†™éƒ¨é¦–</td><td>214å­—</td><td>2F00-2FD5</td></tr><tr><td>éƒ¨é¦–æ‰©å±•</td><td>115å­—</td><td>2E80-2EF3</td></tr><tr><td>å…¼å®¹æ±‰å­—</td><td>477å­—</td><td>F900-FAD9</td></tr><tr><td>å…¼å®¹æ‰©å±•</td><td>542å­—</td><td>2F800-2FA1D</td></tr><tr><td>PUA(GBK)éƒ¨ä»¶</td><td>81å­—</td><td>E815-E86F</td></tr><tr><td>éƒ¨ä»¶æ‰©å±•</td><td>452å­—</td><td>E400-E5E8</td></tr><tr><td>PUAå¢è¡¥</td><td>207å­—</td><td>E600-E6CF</td></tr><tr><td>æ±‰å­—ç¬”ç”»</td><td>36å­—</td><td>31C0-31E3</td></tr><tr><td>æ±‰å­—ç»“æ„</td><td>12å­—</td><td>2FF0-2FFB</td></tr><tr><td>æ±‰è¯­æ³¨éŸ³</td><td>43å­—</td><td>3105-312F</td></tr><tr><td>æ³¨éŸ³æ‰©å±•</td><td>22å­—</td><td>31A0-31BA</td></tr><tr><td>ã€‡</td><td>1å­—</td><td>3007</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> Unicode </tag>
            
            <tag> ä¸­æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ssh  read: Connection reset by peer error</title>
      <link href="/2020/06/27/ssh-read-connection-reset-by-peer-error/"/>
      <url>/2020/06/27/ssh-read-connection-reset-by-peer-error/</url>
      
        <content type="html"><![CDATA[<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#error</span>sshfs xxx 192.168.39.70read: Connection reset by peer</code></pre><p>slove</p><pre class=" language-bash"><code class="language-bash">ssh-keygen -R 192.168.39.70</code></pre><p>umout</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">umount</span> -l /home/zhangpf/workspace</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> error </tag>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unicodeå­—ç¬¦èŒƒå›´</title>
      <link href="/2020/06/27/unicode-zi-fu-fan-wei/"/>
      <url>/2020/06/27/unicode-zi-fu-fan-wei/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/m372897500/article/details/37592543" target="_blank" rel="noopener">https://blog.csdn.net/m372897500/article/details/37592543</a></p><table><thead><tr><th>åè¿›åˆ¶</th><th>åè¿›åˆ¶</th><th>åå…­è¿›åˆ¶</th><th>åå…­è¿›åˆ¶</th><th>å­—ç¬¦æ•°</th><th>ç¼–ç åˆ†ç±»ï¼ˆä¸­æ–‡ï¼‰</th><th>ç¼–ç åˆ†ç±»ï¼ˆè‹±æ–‡ï¼‰</th></tr></thead><tbody><tr><td>èµ·å§‹</td><td>ç»ˆæ­¢</td><td>èµ·å§‹</td><td>ç»ˆæ­¢</td><td>(ä¸ª)</td><td></td><td></td></tr><tr><td>0</td><td>127</td><td>0000</td><td>007F</td><td>128</td><td>C0æ§åˆ¶ç¬¦åŠåŸºæœ¬æ‹‰ä¸æ–‡</td><td>C0 Control and Basic Latin</td></tr><tr><td>128</td><td>255</td><td>0080</td><td>00FF</td><td>128</td><td>C1æ§åˆ¶ç¬¦åŠæ‹‰ä¸æ–‡è¡¥å……-1</td><td>C1 Control and Latin 1 Supplement</td></tr><tr><td>256</td><td>383</td><td>0100</td><td>017F</td><td>128</td><td>æ‹‰ä¸æ–‡æ‰©å±•-A</td><td>Latin Extended-A</td></tr><tr><td>384</td><td>591</td><td>0180</td><td>024F</td><td>208</td><td>æ‹‰ä¸æ–‡æ‰©å±•-B</td><td>Latin Extended-B</td></tr><tr><td>592</td><td>687</td><td>0250</td><td>02AF</td><td>96</td><td>å›½é™…éŸ³æ ‡æ‰©å±•</td><td>IPA Extensions</td></tr><tr><td>688</td><td>767</td><td>02B0</td><td>02FF</td><td>80</td><td>ç©ºç™½ä¿®é¥°å­—æ¯</td><td>Spacing Modifiers</td></tr><tr><td>768</td><td>879</td><td>0300</td><td>036F</td><td>112</td><td>ç»“åˆç”¨è¯»éŸ³ç¬¦å·</td><td>Combining Diacritics Marks</td></tr><tr><td>880</td><td>1023</td><td>0370</td><td>03FF</td><td>144</td><td>å¸Œè…Šæ–‡åŠç§‘æ™®ç‰¹æ–‡</td><td>Greek and Coptic</td></tr><tr><td>1024</td><td>1279</td><td>0400</td><td>04FF</td><td>256</td><td>è¥¿é‡Œå°”å­—æ¯</td><td>Cyrillic</td></tr><tr><td>1280</td><td>1327</td><td>0500</td><td>052F</td><td>48</td><td>è¥¿é‡Œå°”å­—æ¯è¡¥å……</td><td>Cyrillic Supplement</td></tr><tr><td>1328</td><td>1423</td><td>0530</td><td>058F</td><td>96</td><td>äºšç¾å°¼äºšè¯­</td><td>Armenian</td></tr><tr><td>1424</td><td>1535</td><td>0590</td><td>05FF</td><td>112</td><td>å¸Œä¼¯æ¥æ–‡</td><td>Hebrew</td></tr><tr><td>1536</td><td>1791</td><td>0600</td><td>06FF</td><td>256</td><td>é˜¿æ‹‰ä¼¯æ–‡</td><td>Arabic</td></tr><tr><td>1792</td><td>1871</td><td>0700</td><td>074F</td><td>80</td><td>å™åˆ©äºšæ–‡</td><td>Syriac</td></tr><tr><td>1872</td><td>1919</td><td>0750</td><td>077F</td><td>48</td><td>é˜¿æ‹‰ä¼¯æ–‡è¡¥å……</td><td>Arabic Supplement</td></tr><tr><td>1920</td><td>1983</td><td>0780</td><td>07BF</td><td>64</td><td>é©¬å°”ä»£å¤«è¯­</td><td>Thaana</td></tr><tr><td>1984</td><td>2047</td><td>07C0</td><td>07FF</td><td>64</td><td>è¥¿éæ›¸é¢èªè¨€</td><td>Nâ€™Ko</td></tr><tr><td>2048</td><td>2143</td><td>0800</td><td>085F</td><td>96</td><td>é˜¿ç»´æ–¯å¡”è¯­åŠå·´åˆ—ç»´è¯­</td><td>Avestan and Pahlavi</td></tr><tr><td>2144</td><td>2175</td><td>0860</td><td>087F</td><td>32</td><td>Mandaic</td><td>Mandaic</td></tr><tr><td>2176</td><td>2223</td><td>0880</td><td>08AF</td><td>48</td><td>æ’’é©¬åˆ©äºšè¯­</td><td>Samaritan</td></tr><tr><td>2304</td><td>2431</td><td>0900</td><td>097F</td><td>128</td><td>å¤©åŸæ–‡ä¹¦</td><td>Devanagari</td></tr><tr><td>2432</td><td>2559</td><td>0980</td><td>09FF</td><td>128</td><td>å­ŸåŠ æ‹‰è¯­</td><td>Bengali</td></tr><tr><td>2560</td><td>2687</td><td>0A00</td><td>0A7F</td><td>128</td><td>é”¡å…‹æ•™æ–‡</td><td>Gurmukhi</td></tr><tr><td>2688</td><td>2815</td><td>0A80</td><td>0AFF</td><td>128</td><td>å¤å‰æ‹‰ç‰¹æ–‡</td><td>Gujarati</td></tr><tr><td>2816</td><td>2943</td><td>0B00</td><td>0B7F</td><td>128</td><td>å¥¥é‡Œäºšæ–‡</td><td>Oriya</td></tr><tr><td>2944</td><td>3071</td><td>0B80</td><td>0BFF</td><td>128</td><td>æ³°ç±³å°”æ–‡</td><td>Tamil</td></tr><tr><td>3072</td><td>3199</td><td>0C00</td><td>0C7F</td><td>128</td><td>æ³°å¢å›ºæ–‡</td><td>Telugu</td></tr><tr><td>3200</td><td>3327</td><td>0C80</td><td>0CFF</td><td>128</td><td>å¡çº³è¾¾æ–‡</td><td>Kannada</td></tr><tr><td>3328</td><td>3455</td><td>0D00</td><td>0D7F</td><td>128</td><td>å¾·æ‹‰ç»´æ—è¯­</td><td>Malayalam</td></tr><tr><td>3456</td><td>3583</td><td>0D80</td><td>0DFF</td><td>128</td><td>åƒ§ä¼½ç½—è¯­</td><td>Sinhala</td></tr><tr><td>3584</td><td>3711</td><td>0E00</td><td>0E7F</td><td>128</td><td>æ³°æ–‡</td><td>Thai</td></tr><tr><td>3712</td><td>3839</td><td>0E80</td><td>0EFF</td><td>128</td><td>è€æŒæ–‡</td><td>Lao</td></tr><tr><td>3840</td><td>4095</td><td>0F00</td><td>0FFF</td><td>256</td><td>è—æ–‡</td><td>Tibetan</td></tr><tr><td>4096</td><td>4255</td><td>1000</td><td>109F</td><td>160</td><td>ç¼…ç”¸è¯­</td><td>Myanmar</td></tr><tr><td>4256</td><td>4351</td><td>10A0</td><td>10FF</td><td>96</td><td>æ ¼é²å‰äºšè¯­</td><td>Georgian</td></tr><tr><td>4352</td><td>4607</td><td>1100</td><td>11FF</td><td>256</td><td>æœé²œæ–‡</td><td>Hangul Jamo</td></tr><tr><td>4608</td><td>4991</td><td>1200</td><td>137F</td><td>384</td><td>åŸƒå¡ä¿„æ¯”äºšè¯­</td><td>Ethiopic</td></tr><tr><td>4992</td><td>5023</td><td>1380</td><td>139F</td><td>32</td><td>åŸƒå¡ä¿„æ¯”äºšè¯­è¡¥å……</td><td>Ethiopic Supplement</td></tr><tr><td>5024</td><td>5119</td><td>13A0</td><td>13FF</td><td>96</td><td>åˆ‡ç½—åŸºè¯­</td><td>Cherokee</td></tr><tr><td>5120</td><td>5759</td><td>1400</td><td>167F</td><td>640</td><td>ç»Ÿä¸€åŠ æ‹¿å¤§åœŸè‘—è¯­éŸ³èŠ‚</td><td>Unified Canadian Aboriginal Syllabics</td></tr><tr><td>5760</td><td>5791</td><td>1680</td><td>169F</td><td>32</td><td>æ¬§ç”˜å­—æ¯</td><td>Ogham</td></tr><tr><td>5792</td><td>5887</td><td>16A0</td><td>16FF</td><td>96</td><td>å¦‚å°¼æ–‡</td><td>Runic</td></tr><tr><td>5888</td><td>5919</td><td>1700</td><td>171F</td><td>32</td><td>å¡”åŠ æ‹‰è¯­</td><td>Tagalog</td></tr><tr><td>5920</td><td>5951</td><td>1720</td><td>173F</td><td>32</td><td>HanunÃ³o</td><td>HanunÃ³o</td></tr><tr><td>5952</td><td>5983</td><td>1740</td><td>175F</td><td>32</td><td>Buhid</td><td>Buhid</td></tr><tr><td>5984</td><td>6015</td><td>1760</td><td>177F</td><td>32</td><td>Tagbanwa</td><td>Tagbanwa</td></tr><tr><td>6016</td><td>6143</td><td>1780</td><td>17FF</td><td>128</td><td>é«˜æ£‰è¯­</td><td>Khmer</td></tr><tr><td>6144</td><td>6319</td><td>1800</td><td>18AF</td><td>176</td><td>è’™å¤æ–‡</td><td>Mongolian</td></tr><tr><td>6320</td><td>6399</td><td>18B0</td><td>18FF</td><td>80</td><td>Cham</td><td>Cham</td></tr><tr><td>6400</td><td>6479</td><td>1900</td><td>194F</td><td>80</td><td>Limbu</td><td>Limbu</td></tr><tr><td>6480</td><td>6527</td><td>1950</td><td>197F</td><td>48</td><td>å¾·å®æ³°è¯­</td><td>Tai Le</td></tr><tr><td>6528</td><td>6623</td><td>1980</td><td>19DF</td><td>96</td><td>æ–°å‚£ä»‚è¯­</td><td>New Tai Lue</td></tr><tr><td>6624</td><td>6655</td><td>19E0</td><td>19FF</td><td>32</td><td>é«˜æ£‰è¯­è®°å·</td><td>Kmer Symbols</td></tr><tr><td>6656</td><td>6687</td><td>1A00</td><td>1A1F</td><td>32</td><td>Buginese</td><td>Buginese</td></tr><tr><td>6688</td><td>6751</td><td>1A20</td><td>1A5F</td><td>64</td><td>Batak</td><td>Batak</td></tr><tr><td>6784</td><td>6895</td><td>1A80</td><td>1AEF</td><td>112</td><td>Lanna</td><td>Lanna</td></tr><tr><td>6912</td><td>7039</td><td>1B00</td><td>1B7F</td><td>128</td><td>å·´å˜è¯­</td><td>Balinese</td></tr><tr><td>7040</td><td>7088</td><td>1B80</td><td>1BB0</td><td>49</td><td>å·½ä»–è¯­</td><td>Sundanese</td></tr><tr><td>7104</td><td>7167</td><td>1BC0</td><td>1BFF</td><td>64</td><td>Pahawh Hmong</td><td>Pahawh Hmong</td></tr><tr><td>7168</td><td>7247</td><td>1C00</td><td>1C4F</td><td>80</td><td>é›·å¸ƒæŸ¥è¯­</td><td>Lepcha</td></tr><tr><td>7248</td><td>7295</td><td>1C50</td><td>1C7F</td><td>48</td><td>Ol Chiki</td><td>Ol Chiki</td></tr><tr><td>7296</td><td>7391</td><td>1C80</td><td>1CDF</td><td>96</td><td>æ›¼å°¼æ™®å°”è¯­</td><td>Meithei/Manipuri</td></tr><tr><td>7424</td><td>7551</td><td>1D00</td><td>1D7F</td><td>128</td><td>è¯­éŸ³å­¦æ‰©å±•</td><td>Phonetic Extensions</td></tr><tr><td>7552</td><td>7615</td><td>1D80</td><td>1DBF</td><td>64</td><td>è¯­éŸ³å­¦æ‰©å±•è¡¥å……</td><td>Phonetic Extensions Supplement</td></tr><tr><td>7616</td><td>7679</td><td>1DC0</td><td>1DFF</td><td>64</td><td>ç»“åˆç”¨è¯»éŸ³ç¬¦å·è¡¥å……</td><td>Combining Diacritics Marks Supplement</td></tr><tr><td>7680</td><td>7935</td><td>1E00</td><td>1EFF</td><td>256</td><td>æ‹‰ä¸æ–‡æ‰©å……é™„åŠ </td><td>Latin Extended Additional</td></tr><tr><td>7936</td><td>8191</td><td>1F00</td><td>1FFF</td><td>256</td><td>å¸Œè…Šè¯­æ‰©å……</td><td>Greek Extended</td></tr><tr><td>8192</td><td>8303</td><td>2000</td><td>206F</td><td>112</td><td>å¸¸ç”¨æ ‡ç‚¹</td><td>General Punctuation</td></tr><tr><td>8304</td><td>8351</td><td>2070</td><td>209F</td><td>48</td><td>ä¸Šæ ‡åŠä¸‹æ ‡</td><td>Superscripts and Subscripts</td></tr><tr><td>8352</td><td>8399</td><td>20A0</td><td>20CF</td><td>48</td><td>è´§å¸ç¬¦å·</td><td>Currency Symbols</td></tr><tr><td>8400</td><td>8447</td><td>20D0</td><td>20FF</td><td>48</td><td>ç»„åˆç”¨è®°å·</td><td>Combining Diacritics Marks for Symbols</td></tr><tr><td>8448</td><td>8527</td><td>2100</td><td>214F</td><td>80</td><td>å­—æ¯å¼ç¬¦å·</td><td>Letterlike Symbols</td></tr><tr><td>8528</td><td>8591</td><td>2150</td><td>218F</td><td>64</td><td>æ•°å­—å½¢å¼</td><td>Number Form</td></tr><tr><td>8592</td><td>8703</td><td>2190</td><td>21FF</td><td>112</td><td>ç®­å¤´</td><td>Arrows</td></tr><tr><td>8704</td><td>8959</td><td>2200</td><td>22FF</td><td>256</td><td>æ•°å­¦è¿ç®—ç¬¦</td><td>Mathematical Operator</td></tr><tr><td>8960</td><td>9215</td><td>2300</td><td>23FF</td><td>256</td><td>æ‚é¡¹å·¥ä¸šç¬¦å·</td><td>Miscellaneous Technical</td></tr><tr><td>9216</td><td>9279</td><td>2400</td><td>243F</td><td>64</td><td>æ§åˆ¶å›¾ç‰‡</td><td>Control Pictures</td></tr><tr><td>9280</td><td>9311</td><td>2440</td><td>245F</td><td>32</td><td>å…‰å­¦è¯†åˆ«ç¬¦</td><td>Optical Character Recognition</td></tr><tr><td>9312</td><td>9471</td><td>2460</td><td>24FF</td><td>160</td><td>å°é—­å¼å­—æ¯æ•°å­—</td><td>Enclosed Alphanumerics</td></tr><tr><td>9472</td><td>9599</td><td>2500</td><td>257F</td><td>128</td><td>åˆ¶è¡¨ç¬¦</td><td>Box Drawing</td></tr><tr><td>9600</td><td>9631</td><td>2580</td><td>259F</td><td>32</td><td>æ–¹å—å…ƒç´ </td><td>Block Element</td></tr><tr><td>9632</td><td>9727</td><td>25A0</td><td>25FF</td><td>96</td><td>å‡ ä½•å›¾å½¢</td><td>Geometric Shapes</td></tr><tr><td>9728</td><td>9983</td><td>2600</td><td>26FF</td><td>256</td><td>æ‚é¡¹ç¬¦å·</td><td>Miscellaneous Symbols</td></tr><tr><td>9984</td><td>10175</td><td>2700</td><td>27BF</td><td>192</td><td>å°åˆ·ç¬¦å·</td><td>Dingbats</td></tr><tr><td>10176</td><td>10223</td><td>27C0</td><td>27EF</td><td>48</td><td>æ‚é¡¹æ•°å­¦ç¬¦å·-A</td><td>Miscellaneous Mathematical Symbols-A</td></tr><tr><td>10224</td><td>10239</td><td>27F0</td><td>27FF</td><td>16</td><td>è¿½åŠ ç®­å¤´-A</td><td>Supplemental Arrows-A</td></tr><tr><td>10240</td><td>10495</td><td>2800</td><td>28FF</td><td>256</td><td>ç›²æ–‡ç‚¹å­—æ¨¡å‹</td><td>Braille Patterns</td></tr><tr><td>10496</td><td>10623</td><td>2900</td><td>297F</td><td>128</td><td>è¿½åŠ ç®­å¤´-B</td><td>Supplemental Arrows-B</td></tr><tr><td>10624</td><td>10751</td><td>2980</td><td>29FF</td><td>128</td><td>æ‚é¡¹æ•°å­¦ç¬¦å·-B</td><td>Miscellaneous Mathematical Symbols-B</td></tr><tr><td>10752</td><td>11007</td><td>2A00</td><td>2AFF</td><td>256</td><td>è¿½åŠ æ•°å­¦è¿ç®—ç¬¦</td><td>Supplemental Mathematical Operator</td></tr><tr><td>11008</td><td>11263</td><td>2B00</td><td>2BFF</td><td>256</td><td>æ‚é¡¹ç¬¦å·å’Œç®­å¤´</td><td>Miscellaneous Symbols and Arrows</td></tr><tr><td>11264</td><td>11359</td><td>2C00</td><td>2C5F</td><td>96</td><td>æ ¼æ‹‰å“¥é‡Œå­—æ¯</td><td>Glagolitic</td></tr><tr><td>11360</td><td>11391</td><td>2C60</td><td>2C7F</td><td>32</td><td>æ‹‰ä¸æ–‡æ‰©å±•-C</td><td>Latin Extended-C</td></tr><tr><td>11392</td><td>11519</td><td>2C80</td><td>2CFF</td><td>128</td><td>å¤åŸƒåŠè¯­</td><td>Coptic</td></tr><tr><td>11520</td><td>11567</td><td>2D00</td><td>2D2F</td><td>48</td><td>æ ¼é²å‰äºšè¯­è¡¥å……</td><td>Georgian Supplement</td></tr><tr><td>11568</td><td>11647</td><td>2D30</td><td>2D7F</td><td>80</td><td>æéçº³æ–‡</td><td>Tifinagh</td></tr><tr><td>11648</td><td>11743</td><td>2D80</td><td>2DDF</td><td>96</td><td>åŸƒå¡ä¿„æ¯”äºšè¯­æ‰©å±•</td><td>Ethiopic Extended</td></tr><tr><td>11776</td><td>11903</td><td>2E00</td><td>2E7F</td><td>128</td><td>è¿½åŠ æ ‡ç‚¹</td><td>Supplemental Punctuation</td></tr><tr><td>11904</td><td>12031</td><td>2E80</td><td>2EFF</td><td>128</td><td>CJK éƒ¨é¦–è¡¥å……</td><td>CJK Radicals Supplement</td></tr><tr><td>12032</td><td>12255</td><td>2F00</td><td>2FDF</td><td>224</td><td>åº·ç†™å­—å…¸éƒ¨é¦–</td><td>Kangxi Radicals</td></tr><tr><td>12272</td><td>12287</td><td>2FF0</td><td>2FFF</td><td>16</td><td>è¡¨æ„æ–‡å­—æè¿°ç¬¦</td><td>Ideographic Description Characters</td></tr><tr><td>12288</td><td>12351</td><td>3000</td><td>303F</td><td>64</td><td>CJK ç¬¦å·å’Œæ ‡ç‚¹</td><td>CJK Symbols and Punctuation</td></tr><tr><td>12352</td><td>12447</td><td>3040</td><td>309F</td><td>96</td><td>æ—¥æ–‡å¹³å‡å</td><td>Hiragana</td></tr><tr><td>12448</td><td>12543</td><td>30A0</td><td>30FF</td><td>96</td><td>æ—¥æ–‡ç‰‡å‡å</td><td>Katakana</td></tr><tr><td>12544</td><td>12591</td><td>3100</td><td>312F</td><td>48</td><td>æ³¨éŸ³å­—æ¯</td><td>Bopomofo</td></tr><tr><td>12592</td><td>12687</td><td>3130</td><td>318F</td><td>96</td><td>æœé²œæ–‡å…¼å®¹å­—æ¯</td><td>Hangul Compatibility Jamo</td></tr><tr><td>12688</td><td>12703</td><td>3190</td><td>319F</td><td>16</td><td>è±¡å½¢å­—æ³¨é‡Šæ ‡å¿—</td><td>Kanbun</td></tr><tr><td>12704</td><td>12735</td><td>31A0</td><td>31BF</td><td>32</td><td>æ³¨éŸ³å­—æ¯æ‰©å±•</td><td>Bopomofo Extended</td></tr><tr><td>12736</td><td>12783</td><td>31C0</td><td>31EF</td><td>48</td><td>CJK ç¬”ç”»</td><td>CJK Strokes</td></tr><tr><td>12784</td><td>12799</td><td>31F0</td><td>31FF</td><td>16</td><td>æ—¥æ–‡ç‰‡å‡åè¯­éŸ³æ‰©å±•</td><td>Katakana Phonetic Extensions</td></tr><tr><td>12800</td><td>13055</td><td>3200</td><td>32FF</td><td>256</td><td>å°é—­å¼ CJK æ–‡å­—å’Œæœˆä»½</td><td>Enclosed CJK Letters and Months</td></tr><tr><td>13056</td><td>13311</td><td>3300</td><td>33FF</td><td>256</td><td>CJK å…¼å®¹</td><td>CJK Compatibility</td></tr><tr><td>13312</td><td>19903</td><td>3400</td><td>4DBF</td><td>6592</td><td>CJK ç»Ÿä¸€è¡¨æ„ç¬¦å·æ‰©å±• A</td><td>CJK Unified Ideographs Extension A</td></tr><tr><td>19904</td><td>19967</td><td>4DC0</td><td>4DFF</td><td>64</td><td>æ˜“ç»å…­åå››å¦ç¬¦å·</td><td>Yijing Hexagrams Symbols</td></tr><tr><td>19968</td><td>40895</td><td>4E00</td><td>9FBF</td><td>20928</td><td>CJK ç»Ÿä¸€è¡¨æ„ç¬¦å·</td><td>CJK Unified Ideographs</td></tr><tr><td>40960</td><td>42127</td><td>A000</td><td>A48F</td><td>1168</td><td>å½æ–‡éŸ³èŠ‚</td><td>Yi Syllables</td></tr><tr><td>42128</td><td>42191</td><td>A490</td><td>A4CF</td><td>64</td><td>å½æ–‡å­—æ ¹</td><td>Yi Radicals</td></tr><tr><td>42240</td><td>42527</td><td>A500</td><td>A61F</td><td>288</td><td>Vai</td><td>Vai</td></tr><tr><td>42592</td><td>42751</td><td>A660</td><td>A6FF</td><td>160</td><td>ç»Ÿä¸€åŠ æ‹¿å¤§åœŸè‘—è¯­éŸ³èŠ‚è¡¥å……</td><td>Unified Canadian Aboriginal Syllabics Supplement</td></tr><tr><td>42752</td><td>42783</td><td>A700</td><td>A71F</td><td>32</td><td>å£°è°ƒä¿®é¥°å­—æ¯</td><td>Modifier Tone Letters</td></tr><tr><td>42784</td><td>43007</td><td>A720</td><td>A7FF</td><td>224</td><td>æ‹‰ä¸æ–‡æ‰©å±•-D</td><td>Latin Extended-D</td></tr><tr><td>43008</td><td>43055</td><td>A800</td><td>A82F</td><td>48</td><td>Syloti Nagri</td><td>Syloti Nagri</td></tr><tr><td>43072</td><td>43135</td><td>A840</td><td>A87F</td><td>64</td><td>å…«æ€å·´å­—</td><td>Phags-pa</td></tr><tr><td>43136</td><td>43231</td><td>A880</td><td>A8DF</td><td>96</td><td>Saurashtra</td><td>Saurashtra</td></tr><tr><td>43264</td><td>43391</td><td>A900</td><td>A97F</td><td>128</td><td>çˆªå“‡è¯­</td><td>Javanese</td></tr><tr><td>43392</td><td>43487</td><td>A980</td><td>A9DF</td><td>96</td><td>Chakma</td><td>Chakma</td></tr><tr><td>43520</td><td>43583</td><td>AA00</td><td>AA3F</td><td>64</td><td>Varang Kshiti</td><td>Varang Kshiti</td></tr><tr><td>43584</td><td>43631</td><td>AA40</td><td>AA6F</td><td>48</td><td>Sorang Sompeng</td><td>Sorang Sompeng</td></tr><tr><td>43648</td><td>43743</td><td>AA80</td><td>AADF</td><td>96</td><td>Newari</td><td>Newari</td></tr><tr><td>43776</td><td>43871</td><td>AB00</td><td>AB5F</td><td>96</td><td>è¶Šå—å‚£è¯­</td><td>Vi?t ThÃ¡i</td></tr><tr><td>43904</td><td>43936</td><td>AB80</td><td>ABA0</td><td>33</td><td>Kayah Li</td><td>Kayah Li</td></tr><tr><td>44032</td><td>55215</td><td>AC00</td><td>D7AF</td><td>11184</td><td>æœé²œæ–‡éŸ³èŠ‚</td><td>Hangul Syllables</td></tr><tr><td>55296</td><td>56319</td><td>D800</td><td>DBFF</td><td>1024</td><td>High-half zone of UTF-16</td><td>High-half zone of UTF-16</td></tr><tr><td>56320</td><td>57343</td><td>DC00</td><td>DFFF</td><td>1024</td><td>Low-half zone of UTF-16</td><td>Low-half zone of UTF-16</td></tr><tr><td>57344</td><td>63743</td><td>E000</td><td>F8FF</td><td>6400</td><td>è‡ªè¡Œä½¿ç”¨å€åŸŸ</td><td>Private Use Zone</td></tr><tr><td>63744</td><td>64255</td><td>F900</td><td>FAFF</td><td>512</td><td>CJK å…¼å®¹è±¡å½¢æ–‡å­—</td><td>CJK Compatibility Ideographs</td></tr><tr><td>64256</td><td>64335</td><td>FB00</td><td>FB4F</td><td>80</td><td>å­—æ¯è¡¨é”å½¢å¼</td><td>Alphabetic Presentation Form</td></tr><tr><td>64336</td><td>65023</td><td>FB50</td><td>FDFF</td><td>688</td><td>é˜¿æ‹‰ä¼¯è¡¨é”å½¢å¼A</td><td>Arabic Presentation Form-A</td></tr><tr><td>65024</td><td>65039</td><td>FE00</td><td>FE0F</td><td>16</td><td>å˜é‡é€‰æ‹©ç¬¦</td><td>Variation Selector</td></tr><tr><td>65040</td><td>65055</td><td>FE10</td><td>FE1F</td><td>16</td><td>ç«–æ’å½¢å¼</td><td>Vertical Forms</td></tr><tr><td>65056</td><td>65071</td><td>FE20</td><td>FE2F</td><td>16</td><td>ç»„åˆç”¨åŠç¬¦å·</td><td>Combining Half Marks</td></tr><tr><td>65072</td><td>65103</td><td>FE30</td><td>FE4F</td><td>32</td><td>CJK å…¼å®¹å½¢å¼</td><td>CJK Compatibility Forms</td></tr><tr><td>65104</td><td>65135</td><td>FE50</td><td>FE6F</td><td>32</td><td>å°å‹å˜ä½“å½¢å¼</td><td>Small Form Variants</td></tr><tr><td>65136</td><td>65279</td><td>FE70</td><td>FEFF</td><td>144</td><td>é˜¿æ‹‰ä¼¯è¡¨é”å½¢å¼B</td><td>Arabic Presentation Form-B</td></tr><tr><td>65280</td><td>65519</td><td>FF00</td><td>FFEF</td><td>240</td><td>åŠå‹åŠå…¨å‹å½¢å¼</td><td>Halfwidth and Fullwidth Form</td></tr><tr><td>65520</td><td>65535</td><td>FFF0</td><td>FFFF</td><td>16</td><td>ç‰¹æ®Š</td><td>Specials</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> Unicode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtç¼–ç çš„ä¸€ä¸ªå‘</title>
      <link href="/2020/06/27/qt-bian-ma-de-yi-ge-keng/"/>
      <url>/2020/06/27/qt-bian-ma-de-yi-ge-keng/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼–ç ç¼–ç "><a href="#ç¼–ç ç¼–ç " class="headerlink" title="ç¼–ç ç¼–ç "></a>ç¼–ç ç¼–ç </h1><p>è™½è¯´ä¸Šç­è¿™ä¹ˆå¤šå¹´äº†ï¼Œæ˜¨å¤©ä¿®å¤ä¸€ä¸ªbugçš„æ—¶å€™è¿˜æ˜¯è¢«å±ä¸€æ ·çš„ä»£ç ç»™å‘äº†</p><p>å…ˆè¯´é€»è¾‘<br>ä¸šåŠ¡æœ¬è´¨æ˜¯æƒ³æŠŠ Unicodeç¼–ç è½¬æˆGBKç¼–ç </p><pre class=" language-cpp"><code class="language-cpp">    QTextCodec<span class="token operator">*</span> codec <span class="token operator">=</span> QTextCodec<span class="token operator">::</span><span class="token function">codecForName</span><span class="token punctuation">(</span><span class="token string">"GBK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ushort ss <span class="token operator">=</span> <span class="token number">23435</span><span class="token punctuation">;</span>    QString strUn <span class="token operator">=</span> QString<span class="token operator">::</span><span class="token function">fromUtf16</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ss<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>codec <span class="token operator">&amp;&amp;</span> codec<span class="token operator">-</span><span class="token operator">></span><span class="token function">canEncode</span><span class="token punctuation">(</span>strUn<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        QString gStr <span class="token operator">=</span> codec<span class="token operator">-</span><span class="token operator">></span><span class="token function">fromUnicode</span><span class="token punctuation">(</span>strUn<span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string <span class="token operator">=</span> gStr<span class="token punctuation">.</span><span class="token function">toStdString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>åœ¨æŸäº›unixç¯å¢ƒä¸­ï¼Œè¿™ä¸ªgStrå°±å·²ç»æ˜¯ç©ºçš„äº†ã€‚<br>åŸå› æ˜¯ codec-&gt;fromUnicode(strUn); è¿”å›çš„æ˜¯QByteArrayã€‚</p><p>QByteArrayè½¬QStringæ˜¯è°ƒç”¨çš„Qtçš„fromAscii_helperè¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æœ¬æ¬¡æ˜¯gdkåˆå¼ºè½¬äº†ä¸€æ¬¡latinçš„ç¼–ç ï¼Œå¯¼è‡´ä¸¢æ•°æ®ã€‚</p><p>Qtä¸­çš„è½¬åŒ–ä»£ç æ˜¯èµ°çš„è¿™é‡Œã€‚ æ•²é‡ç‚¹ï¼Œç›®å‰QByteArrayæ˜¯gbkç¼–ç ï¼Œä½†æ˜¯è¿™æ ·å¼ºè½¬ä¼šå½“åšAsciiæ¥è§£æï¼Œæ‰€ä»¥å‡ºç°äº†ä¸¢æ•°æ®ã€‚<br>Qtæºç </p><pre class=" language-cpp"><code class="language-cpp">QString<span class="token operator">::</span>Data <span class="token operator">*</span>QString<span class="token operator">::</span><span class="token function">fromAscii_helper</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span></code></pre><p>å…·ä½“åˆ°WPSçš„æŸä¸ªåŠŸèƒ½çš„è¯æˆ‘å°±æ‡’å¾—åæ§½äº†ï¼Œåæ­£è¿™ä¹ˆå¤šå¹´windowsä¹Ÿä¸€ç›´æ²¡äº‹å„¿ã€‚é€ƒ)</p><h1 id="toStdString"><a href="#toStdString" class="headerlink" title="toStdString"></a>toStdString</h1><p>è¿™ä¸ªå‡½æ•°ä¹Ÿæ…ç”¨ï¼Œä¸ç®¡ä½ æ˜¯å•¥ç¼–ç çš„QStringï¼Œè¿™æ ·å¯¼å‡ºæœ€åä¹Ÿæ˜¯ä¼šå½“åšasciiæ¥è½¬ï¼Œä¹Ÿä¼šå‡ºç°ä¹±ç æˆ–è€…ä¸¢æ•°æ®ï¼Œæ…ç”¨æ…ç”¨ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> ç¼–ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowså¿«é€Ÿæ·»åŠ æ–‡ä»¶å¤¹</title>
      <link href="/2020/06/27/windows-kuai-su-tian-jia-wen-jian-jia/"/>
      <url>/2020/06/27/windows-kuai-su-tian-jia-wen-jian-jia/</url>
      
        <content type="html"><![CDATA[<pre class=" language-shell"><code class="language-shell">for /l %i in (1,1,1000) do mkdir %i</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> windows </tag>
            
            <tag> bat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtåœ¨Linuxä¸‹Waylandæ¡Œé¢ä¸ŠæŠ“å–æ¡Œé¢çš„ä¸€ä¸ªå‘</title>
      <link href="/2020/06/27/qt-zai-linux-xia-wayland-zhuo-mian-shang-zhua-qu-zhuo-mian-de-yi-ge-keng/"/>
      <url>/2020/06/27/qt-zai-linux-xia-wayland-zhuo-mian-shang-zhua-qu-zhuo-mian-de-yi-ge-keng/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘WPSåœ¨é€‚é…äº†ä¸‹Waylandçš„æ¡Œé¢ç¯å¢ƒï¼Œä¸å¾—ä¸è¯´Gnomeä¸‹çš„waylandæ¯”KDEçš„waylandçš„è¦ç¨³å®šçš„å¤šï¼Œç„¶è€Œï¼Œè¿˜æ˜¯é‡åˆ°äº†ä¸€äº›å°å‘ï¼Œè¿™é‡Œè®°å½•ä¸‹ã€‚</p><blockquote><p>Waylandåªæ˜¯ä¸€ä¸ªåè®®ï¼ˆProtocolï¼‰ï¼Œå°±åƒX Windowå½“å‰çš„åè®®â€”â€”X11ä¸€æ ·ï¼Œå®ƒåªå®šä¹‰äº†å¦‚ä½•ä¸å†…æ ¸é€šè®¯ã€å¦‚ä½•ä¸Clienté€šè®¯ï¼Œå…·ä½“çš„ç­–ç•¥ï¼Œä¾ç„¶æ˜¯äº¤ç»™å¼€å‘è€…è‡ªå·±ã€‚æ‰€ä»¥Waylandä¾ç„¶ æ˜¯è´¯å½»â€œæä¾›æœºåˆ¶ï¼Œè€Œéç­–ç•¥â€çš„Unixç¨‹åºã€‚</p></blockquote><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>å…ˆè¯´é—®é¢˜ï¼Œæˆ‘è¿™è¾¹å‘ç°è°ƒç”¨Qtçš„æŠ“å±å‡½æ•°<code>screen-&gt;grabWindow</code>ï¼Œå‘ç°æˆªå›¾å‡ºæ¥æ˜¯é»‘çš„ã€‚å…·ä½“è¡¨ç°å°±æ˜¯WPSçš„æˆªå›¾åŠŸèƒ½æ— æ•ˆï¼›</p><h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p>ç”±äºå®‰å…¨åŸå› ï¼ŒWaylandä¸‹ä¸æ”¯æŒéç³»ç»Ÿçš„è½¯ä»¶æˆªæ¡Œé¢çš„å›¾</p><h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><p>ä½†æ˜¯æˆ‘è¿™è¾¹çœ‹è¿‡ä¸€ä¸ªå¼€æºçš„æˆªå›¾å·¥å…·ï¼Œåœ¨waylandä¸‹çš„è§£å†³æ–¹æ¡ˆæ˜¯è°ƒç”¨ç³»ç»Ÿçš„<br><a href="https://github.com/lupoDharkael/flameshot/blob/b0326bcb6cb5ed5048e5574c682fce75cbfa7bbe/src/utils/screengrabber.cpp#L47" target="_blank" rel="noopener">https://github.com/lupoDharkael/flameshot/blob/b0326bcb6cb5ed5048e5574c682fce75cbfa7bbe/src/utils/screengrabber.cpp#L47</a></p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">ifdef</span> Q_OS_LINUX</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>m_info<span class="token punctuation">.</span><span class="token function">waylandDectected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QPixmap res<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// handle screenshot based on DE</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>m_info<span class="token punctuation">.</span><span class="token function">windowManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> DesktopInfo<span class="token operator">::</span>GNOME<span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// https://github.com/GNOME/gnome-shell/blob/695bfb96160033be55cfb5ac41c121998f98c328/data/org.gnome.Shell.Screenshot.xml</span>            QString path <span class="token operator">=</span> <span class="token function">FileNameHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generateAbsolutePath</span><span class="token punctuation">(</span>QDir<span class="token operator">::</span><span class="token function">tempPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".png"</span><span class="token punctuation">;</span>            QDBusInterface <span class="token function">gnomeInterface</span><span class="token punctuation">(</span><span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"org.gnome.Shell"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                          <span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"/org/gnome/Shell/Screenshot"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                          <span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"org.gnome.Shell.Screenshot"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            QDBusReply<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> reply <span class="token operator">=</span> gnomeInterface<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"Screenshot"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>reply<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                res <span class="token operator">=</span> <span class="token function">QPixmap</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                ok <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">case</span> DesktopInfo<span class="token operator">::</span>KDE<span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// https://github.com/KDE/spectacle/blob/517a7baf46a4ca0a45f32fd3f2b1b7210b180134/src/PlatformBackends/KWinWaylandImageGrabber.cpp#L145</span>            QDBusInterface <span class="token function">kwinInterface</span><span class="token punctuation">(</span><span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"org.kde.KWin"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                         <span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"/Screenshot"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                         <span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"org.kde.kwin.Screenshot"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            QDBusReply<span class="token operator">&lt;</span>QString<span class="token operator">></span> reply <span class="token operator">=</span> kwinInterface<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"screenshotFullscreen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            res <span class="token operator">=</span> <span class="token function">QPixmap</span><span class="token punctuation">(</span>reply<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">default</span><span class="token operator">:</span>            ok <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">SystemNotification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"Unable to capture screen"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Linux </tag>
            
            <tag> Wayland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtæºç å‰–æç»˜åˆ¶æ–‡å­—åŸç†(Linux)</title>
      <link href="/2020/06/27/qt-yuan-ma-pou-xi-hui-zhi-wen-zi-yuan-li-linux/"/>
      <url>/2020/06/27/qt-yuan-ma-pou-xi-hui-zhi-wen-zi-yuan-li-linux/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Qtåœ¨Linuxç»˜åˆ¶å­—ä½“æ˜¯ä½¿ç”¨çš„FreeTypeã€‚</p><blockquote><p>FreeTypeæ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€å®ç°çš„ä¸€ä¸ªå­—ä½“å…‰æ …åŒ–åº“ã€‚å®ƒå¯ä»¥ç”¨æ¥å°†å­—ç¬¦æ …æ ¼åŒ–å¹¶æ˜ å°„æˆä½å›¾ä»¥åŠæä¾›å…¶ä»–å­—ä½“ç›¸å…³ä¸šåŠ¡çš„æ”¯æŒã€‚<br>FreeTypeå¹¶ä¸æä¾›APIä»¥è¿è¡Œæ›´é«˜çº§çš„åŠŸèƒ½ï¼Œå¦‚æ–‡å­—å¸ƒå±€æˆ–å›¾å½¢å¤„ç†ï¼ˆä¾‹å¦‚å½©è‰²æ–‡æœ¬æ¸²æŸ“ã€â€œç©ºæ´åŒ–â€ç­‰ï¼‰ã€‚ç„¶è€Œï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€å•ã€æ˜“ç”¨å¹¶ç»Ÿä¸€çš„æ¥å£æ¥è®¿é—®å­—ä½“æ–‡ä»¶çš„å†…å®¹ï¼Œä»è€Œæå¤§åœ°ç®€åŒ–äº†è¿™äº›ä»»åŠ¡ã€‚å®ƒæ”¯æŒå„ç§å­—ä½“æ ¼å¼ï¼ŒåŒ…æ‹¬TrueTypeã€Type 1ã€ä»¥åŠOpenTypeã€‚<br>FreeTypeåœ¨ä¸¤ä¸ªè‡ªç”±è½¯ä»¶è®¸å¯è¯çš„è®¸å¯ä¸‹å‘å¸ƒï¼šGNUé€šç”¨å…¬å…±è®¸å¯è¯æˆ–è€…ä»¥åŠä¸€ä¸ªç±»BSDè®¸å¯è¯ã€‚å› æ­¤è¿™ä¸ªåº“èƒ½å¤Ÿä½¿ç”¨äºä»»ä½•ç±»å‹çš„é¡¹ç›®ä¸­ï¼Œæ— è®ºå…¶æ˜¯å¦æ˜¯ä¸“æœ‰è½¯ä»¶ã€‚åŒæ—¶ä¹ŸåŒ…æ‹¬æ­£åœ¨ä½¿ç”¨çš„ä¸»è¦è‡ªç”±æ¡Œé¢ç³»ç»Ÿè½¯ä»¶ã€‚ </p></blockquote><p>æµç¨‹å¾ˆç®€å•ï¼ŒQtåœ¨ç»˜åˆ¶å­—ä½“æ—¶ï¼Œé¦–å…ˆå°†å­—ä½“ä¸­çš„æè¿°ç‚¹ä»¥åŠå­—å½¢ä¿¡æ¯ä¿å­˜åˆ°QPainterPathä¸­ã€‚ç„¶åå†ç»˜åˆ¶å‡ºæ¥ã€‚</p><p>ä¸‹é¢çš„ä»£ç æ˜¯æˆ‘ä»Qtä¸­æ‰£å‡ºæ¥äº†ï¼Œè¿™æ˜¯Qtå…·ä½“æç‚¹åˆ°Pathçš„è¿‡ç¨‹ï¼ŒQtåœ¨ç»˜åˆ¶å¤§å·å­—ä½“çš„æ—¶å€™ä¼šè°ƒç”¨ä¸‹é¢çš„é€»è¾‘</p><p>ä¸‹é¢ä¸Šä»£ç </p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>proæ–‡ä»¶ä¸­åŠ </p><pre class=" language-cpp"><code class="language-cpp">LIBS <span class="token operator">+</span><span class="token operator">=</span> <span class="token operator">-</span>lfreetypeINCLUDEPATH <span class="token operator">+</span><span class="token operator">=</span> <span class="token operator">/</span>usr<span class="token operator">/</span>include<span class="token operator">/</span>freetype2</code></pre><p>å¤´æ–‡ä»¶</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;freetype2/ft2build.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;freetype2/freetype/freetype.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;freetype/freetype.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;freetype/ftoutln.h></span></span></code></pre><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">scaleOutline</span><span class="token punctuation">(</span>FT_Face face<span class="token punctuation">,</span> FT_GlyphSlot g<span class="token punctuation">,</span> FT_Fixed x_scale<span class="token punctuation">,</span> FT_Fixed y_scale<span class="token punctuation">,</span> QVector<span class="token operator">&lt;</span>QPoint<span class="token operator">></span><span class="token operator">&amp;</span> vectors<span class="token punctuation">)</span><span class="token punctuation">{</span>    x_scale <span class="token operator">=</span> <span class="token function">FT_MulDiv</span><span class="token punctuation">(</span>x_scale<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> face<span class="token operator">-</span><span class="token operator">></span>units_per_EM<span class="token punctuation">)</span><span class="token punctuation">;</span>    y_scale <span class="token operator">=</span> <span class="token function">FT_MulDiv</span><span class="token punctuation">(</span>y_scale<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> face<span class="token operator">-</span><span class="token operator">></span>units_per_EM<span class="token punctuation">)</span><span class="token punctuation">;</span>    FT_Vector <span class="token operator">*</span>p <span class="token operator">=</span> g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">;</span>    <span class="token keyword">const</span> FT_Vector <span class="token operator">*</span>e <span class="token operator">=</span> p <span class="token operator">+</span> g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>n_points<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        p<span class="token operator">-</span><span class="token operator">></span>x <span class="token operator">=</span> <span class="token function">FT_MulFix</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token operator">></span>x<span class="token punctuation">,</span> x_scale<span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token operator">-</span><span class="token operator">></span>y <span class="token operator">=</span> <span class="token function">FT_MulFix</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token operator">></span>y<span class="token punctuation">,</span> y_scale<span class="token punctuation">)</span><span class="token punctuation">;</span>        vectors<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">QPoint</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token operator">></span>x<span class="token punctuation">,</span> p<span class="token operator">-</span><span class="token operator">></span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>p<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// å°†å­—å½¢ä¸­çš„</span><span class="token macro property">#<span class="token directive keyword">define</span> GLYPH2PATH_DEBUG QT_NO_QDEBUG_MACRO </span><span class="token comment" spellcheck="true">// qDebug</span><span class="token keyword">void</span> <span class="token function">addGlyphToPath</span><span class="token punctuation">(</span>FT_Face face<span class="token punctuation">,</span> FT_GlyphSlot g<span class="token punctuation">,</span> <span class="token keyword">const</span> QFixedPoint <span class="token operator">&amp;</span>point<span class="token punctuation">,</span> QPainterPath <span class="token operator">*</span>path<span class="token punctuation">,</span> FT_Fixed x_scale<span class="token punctuation">,</span> FT_Fixed y_scale<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">const</span> qreal factor <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">64</span><span class="token punctuation">.</span><span class="token punctuation">;</span>    QVector<span class="token operator">&lt;</span>QPoint<span class="token operator">></span> vectors<span class="token punctuation">;</span>    <span class="token function">scaleOutline</span><span class="token punctuation">(</span>face<span class="token punctuation">,</span> g<span class="token punctuation">,</span> x_scale<span class="token punctuation">,</span> y_scale<span class="token punctuation">,</span> vectors<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//</span>    <span class="token keyword">int</span> xMin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> xMax <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">foreach</span> <span class="token punctuation">(</span>QPoint point<span class="token punctuation">,</span> vectors<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> xMax<span class="token punctuation">)</span>            xMax <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> xMin<span class="token punctuation">)</span>            xMin <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">int</span> glyphWidth <span class="token operator">=</span> xMax <span class="token operator">-</span> xMin<span class="token punctuation">;</span>    QPointF cp <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">toPointF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// convert the outline to a painter path</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>n_contours<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> last_point <span class="token operator">=</span> g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>contours<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"contour:"</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">"to"</span> <span class="token operator">&lt;&lt;</span> last_point<span class="token punctuation">;</span>        QPointF start <span class="token operator">=</span> <span class="token function">QPointF</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token operator">*</span>factor<span class="token punctuation">,</span> <span class="token operator">-</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token operator">*</span>factor<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>tags<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// start point is not on curve:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>tags<span class="token punctuation">[</span>last_point<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// end point is not on curve:</span>                <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" start and end point are not on curve"</span><span class="token punctuation">;</span>                start <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">QPointF</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>last_point<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token operator">*</span>factor<span class="token punctuation">,</span>                                <span class="token operator">-</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>last_point<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token operator">*</span>factor<span class="token punctuation">)</span> <span class="token operator">+</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" end point is on curve, start is not"</span><span class="token punctuation">;</span>                start <span class="token operator">=</span> <span class="token function">QPointF</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>last_point<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token operator">*</span>factor<span class="token punctuation">,</span>                               <span class="token operator">-</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>last_point<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token operator">*</span>factor<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token operator">--</span>i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// to use original start point as control point below</span>        <span class="token punctuation">}</span>        start <span class="token operator">+</span><span class="token operator">=</span> cp<span class="token punctuation">;</span>        <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" start at"</span> <span class="token operator">&lt;&lt;</span> start<span class="token punctuation">;</span>        path<span class="token operator">-</span><span class="token operator">></span><span class="token function">moveTo</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">;</span>        QPointF c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> start<span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> last_point<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token operator">++</span>i<span class="token punctuation">;</span>            c<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> cp <span class="token operator">+</span> <span class="token function">QPointF</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token operator">*</span>factor<span class="token punctuation">,</span> <span class="token operator">-</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token operator">*</span>factor<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"tag ="</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>tags<span class="token punctuation">[</span>i<span class="token punctuation">]</span>                               <span class="token operator">&lt;&lt;</span> <span class="token string">": on curve ="</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>tags<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">++</span>n<span class="token punctuation">;</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">.</span>tags<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>                <span class="token comment" spellcheck="true">// cubic bezier element</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>                <span class="token operator">--</span>i<span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>                <span class="token comment" spellcheck="true">// quadratic bezier element</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>                c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>                c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>                <span class="token operator">--</span>i<span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" lineTo"</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    path<span class="token operator">-</span><span class="token operator">></span><span class="token function">lineTo</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>                    c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" cubicTo"</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            path<span class="token operator">-</span><span class="token operator">></span><span class="token function">cubicTo</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" closeSubpath"</span><span class="token punctuation">;</span>            path<span class="token operator">-</span><span class="token operator">></span><span class="token function">closeSubpath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> start<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>                c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">GLYPH2PATH_DEBUG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" close cubicTo"</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            path<span class="token operator">-</span><span class="token operator">></span><span class="token function">cubicTo</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token operator">++</span>i<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">///////////////////</span>    <span class="token comment" spellcheck="true">//è¿™é‡Œæ˜¯è°ƒç”¨freetypeç›¸å…³çš„å‡½æ•°</span>    QPainterPath path<span class="token punctuation">;</span>    FT_Library library<span class="token punctuation">;</span>    FT_Face face<span class="token punctuation">;</span>    FT_Error error <span class="token operator">=</span> <span class="token function">FT_Init_FreeType</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>library <span class="token punctuation">)</span><span class="token punctuation">;</span>    QString strFileName <span class="token operator">=</span> QString<span class="token operator">::</span><span class="token function">fromUtf8</span><span class="token punctuation">(</span><span class="token string">"/home/zhangpf/freeType/FZXBSJW_0.TTF"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>string strFile <span class="token operator">=</span> strFileName<span class="token punctuation">.</span><span class="token function">toStdString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> fileName <span class="token operator">=</span> strFile<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    error <span class="token operator">=</span> <span class="token function">FT_New_Face</span><span class="token punctuation">(</span>library<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>face <span class="token punctuation">)</span><span class="token punctuation">;</span>    uint ch <span class="token operator">=</span> <span class="token string">'h'</span><span class="token punctuation">;</span>    FT_UInt idxGlyph <span class="token operator">=</span> <span class="token function">FT_Get_Char_Index</span><span class="token punctuation">(</span>face<span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FT_Set_Char_Size</span><span class="token punctuation">(</span>face<span class="token punctuation">,</span> face<span class="token operator">-</span><span class="token operator">></span>units_per_EM <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">,</span> face<span class="token operator">-</span><span class="token operator">></span>units_per_EM <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™æ˜¯æ–œä½“</span><span class="token comment" spellcheck="true">//    FT_Matrix matrix;</span><span class="token comment" spellcheck="true">//    double angle = ( 25.0 / 360 ) * 3.14159 * 2; // 180/12=15 åº¦</span><span class="token comment" spellcheck="true">//    matrix.xx = (FT_Fixed)(cos(angle) * 0x10000);</span><span class="token comment" spellcheck="true">//    matrix.xy = (FT_Fixed)(-sin(angle) * 0x10000);</span><span class="token comment" spellcheck="true">//    matrix.yx = (FT_Fixed)(sin(angle) * 0x10000);</span><span class="token comment" spellcheck="true">//    matrix.yy = (FT_Fixed)(cos(angle) * 0x10000);</span><span class="token comment" spellcheck="true">//    FT_Set_Transform(face, &amp;matrix, 0); // è®¾ç½®æˆ–é‡ç½®æ—‹è½¬</span>    FT_Error err <span class="token operator">=</span> <span class="token function">FT_Load_Glyph</span> <span class="token punctuation">(</span>face<span class="token punctuation">,</span> idxGlyph<span class="token punctuation">,</span> FT_LOAD_NO_BITMAP<span class="token punctuation">)</span><span class="token punctuation">;</span>    FT_BBox bbox <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">FT_Outline_Get_CBox</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>face<span class="token operator">-</span><span class="token operator">></span>glyph<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bbox<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* only oblique outline glyphs */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> face<span class="token operator">-</span><span class="token operator">></span>glyph<span class="token operator">-</span><span class="token operator">></span>format <span class="token operator">!=</span> FT_GLYPH_FORMAT_OUTLINE <span class="token punctuation">)</span>      <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç”¨è¿™ä¸ªä¹Ÿå¯ä»¥ç¼©æ”¾ä¸€åŠ</span><span class="token comment" spellcheck="true">//    FT_Outline* outline = &amp;(face->glyph->outline);</span><span class="token comment" spellcheck="true">//    FT_Matrix transform;</span><span class="token comment" spellcheck="true">//    transform.xx = 0x10000L * 0.5;</span><span class="token comment" spellcheck="true">//    transform.yx = 0x00000L;</span><span class="token comment" spellcheck="true">//    transform.xy = 0x00000L;</span><span class="token comment" spellcheck="true">//    transform.yy = 0x10000L;</span><span class="token comment" spellcheck="true">//    FT_Outline_Transform( outline, &amp;transform );</span>    QFixedPoint p<span class="token punctuation">;</span>    p<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FT_IS_SCALABLE</span><span class="token punctuation">(</span>face<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"123"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>        <span class="token function">addGlyphToPath</span><span class="token punctuation">(</span>face<span class="token punctuation">,</span> face<span class="token operator">-</span><span class="token operator">></span>glyph<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token operator">&amp;</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span>face<span class="token operator">-</span><span class="token operator">></span>units_per_EM <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> face<span class="token operator">-</span><span class="token operator">></span>units_per_EM <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//å®½åº¦ç¼©æ”¾ä¸€åŠ</span></code></pre><h2 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h2><p>æœ€ååœ¨painteventä¸­å¯ä»¥ç»˜åˆ¶å‡ºæ¥ï¼Œç”±äºå­—å½¢çš„pointä¸­æœ‰è´Ÿæ•°ï¼Œpainteréœ€è¦transformä¸€ä¸‹</p><pre class=" language-cpp"><code class="language-cpp">    QPainter <span class="token function">painter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QTransform transform<span class="token punctuation">;</span>    transform<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    painter<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    painter<span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™æ˜¯Qtç»˜åˆ¶æ–‡å­—çš„ä¸€éƒ¨åˆ†é€»è¾‘ï¼Œæˆ‘æ‰£å‡ºæ¥Demoæ¥ç»™å¤§å®¶å­¦ä¹ ã€‚ä¸»è¦æ˜¯ä½¿ç”¨äº†QPainterPathæ¥æè¿°å­—ä½“ä¸­çš„ç‚¹ï¼Œä»¥åŠä¿å­˜æˆå­—ä½“ä¸­çš„è´å¡å°”æ›²çº¿ã€‚ç”ŸæˆQPainterPathæ¥æè¿°å…·ä½“çš„å­—å½¢ã€‚ä»£ç ä¸­æˆ‘è¿˜æ·»åŠ äº†ç¼©æ”¾çš„å˜å½¢ï¼Œå®é™…ä¸Šå­—ä½“çš„ç»˜åˆ¶å˜å½¢æœ‰å¾ˆå¤šæ–¹æ³•ã€‚å°±æ‹¿ç¼©æ”¾æ¥è®²ï¼Œå°±æœ‰è¿™ä¹ˆå‡ ç§</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// ç”¨è¿™ä¸ªä¹Ÿå¯ä»¥ç¼©æ”¾ä¸€åŠ</span>FT_Outline<span class="token operator">*</span> outline <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>face<span class="token operator">-</span><span class="token operator">></span>glyph<span class="token operator">-</span><span class="token operator">></span>outline<span class="token punctuation">)</span><span class="token punctuation">;</span>FT_Matrix transform<span class="token punctuation">;</span>transform<span class="token punctuation">.</span>xx <span class="token operator">=</span> <span class="token number">0x10000L</span> <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>transform<span class="token punctuation">.</span>yx <span class="token operator">=</span> <span class="token number">0x00000L</span><span class="token punctuation">;</span>transform<span class="token punctuation">.</span>xy <span class="token operator">=</span> <span class="token number">0x00000L</span><span class="token punctuation">;</span>transform<span class="token punctuation">.</span>yy <span class="token operator">=</span> <span class="token number">0x10000L</span><span class="token punctuation">;</span> <span class="token function">FT_Outline_Transform</span><span class="token punctuation">(</span> outline<span class="token punctuation">,</span> <span class="token operator">&amp;</span>transform <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™æ˜¯æ–œä½“å®ç°ï¼Œmatrix.xx * 0.5 å¯ä»¥ç¼©æ”¾ 0.5å€</span>FT_Matrix matrix<span class="token punctuation">;</span><span class="token keyword">double</span> angle <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token number">25.0</span> <span class="token operator">/</span> <span class="token number">360</span> <span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3.14159</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 25 åº¦</span>matrix<span class="token punctuation">.</span>xx <span class="token operator">=</span> <span class="token punctuation">(</span>FT_Fixed<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>matrix<span class="token punctuation">.</span>xy <span class="token operator">=</span> <span class="token punctuation">(</span>FT_Fixed<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>matrix<span class="token punctuation">.</span>yx <span class="token operator">=</span> <span class="token punctuation">(</span>FT_Fixed<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">sin</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>matrix<span class="token punctuation">.</span>yy <span class="token operator">=</span> <span class="token punctuation">(</span>FT_Fixed<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">FT_Set_Transform</span><span class="token punctuation">(</span>face<span class="token punctuation">,</span> <span class="token operator">&amp;</span>matrix<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è®¾ç½®æˆ–é‡ç½®æ—‹è½¬</span><span class="token comment" spellcheck="true">//ç”šè‡³å¯ä»¥åœ¨ ç‚¹->pathè¿™ä¸€æ­¥æ¥åš   (face->units_per_EM &lt;&lt; 6) / 2,</span> <span class="token comment" spellcheck="true">//addGlyphToPath(face, face->glyph, p, &amp;path, (face->units_per_EM &lt;&lt; 6) / 2, face->units_per_EM &lt;&lt; 6);  //å®½åº¦ç¼©æ”¾ä¸€åŠ</span> <span class="token punctuation">(</span>face<span class="token operator">-</span><span class="token operator">></span>units_per_EM <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span></code></pre><p>æ‰€ä»¥å¤§éƒ¨åˆ†UIåº“éƒ½æœ‰è‡ªå·±çš„å®ç°æ–¹æ³•ã€‚è¿™ä¹Ÿæ˜¯freetypeçµæ´»çš„åœ°æ–¹.</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
            <tag> Qtæºç å‰–æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QFileSystemWatcheræ— æ³•é‡Šæ”¾çš„é—®é¢˜</title>
      <link href="/2020/06/27/qfilesystemwatcher-wu-fa-shi-fang-de-wen-ti/"/>
      <url>/2020/06/27/qfilesystemwatcher-wu-fa-shi-fang-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>QFileSystemWatcher åœ¨å•ä¾‹ç±»ä¸­ï¼Œä¸èƒ½æŒ‡å®šçˆ¶ç±»ï¼Œä¸èƒ½ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œå¦åˆ™ä¼šé‡Šæ”¾ä¸æ‰ï¼Œå‘ç”Ÿèµ„æºç«äº‰ã€‚<br>è¦è¿™æ ·é‡Šæ”¾ã€‚</p><pre class=" language-cpp"><code class="language-cpp">    QObject<span class="token operator">::</span><span class="token function">connect</span><span class="token punctuation">(</span>qApp<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">aboutToQuit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m_pCupsFileWatcher<span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">deleteLater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™æ˜¯æºç ä¸­çš„æ³¨æ„ç‚¹</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">/*!    Destroys the file system watcher.    \note To avoid deadlocks on shutdown, all instances of QFileSystemWatcher    need to be destroyed before QCoreApplication. Note that passing    QCoreApplication::instance() as the parent object when creating    QFileSystemWatcher is not sufficient.*/</span>QFileSystemWatcher<span class="token operator">::</span><span class="token operator">~</span><span class="token function">QFileSystemWatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QFileSystemWatcher </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç½‘é€Ÿæµ‹è¯•æ–¹æ³•</title>
      <link href="/2020/06/27/linux-wang-su-ce-shi-fang-fa/"/>
      <url>/2020/06/27/linux-wang-su-ce-shi-fang-fa/</url>
      
        <content type="html"><![CDATA[<pre class=" language-shell"><code class="language-shell">pip install speedtest-cli</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lpæŒ‡ä»¤</title>
      <link href="/2020/06/27/lp-zhi-ling/"/>
      <url>/2020/06/27/lp-zhi-ling/</url>
      
        <content type="html"><![CDATA[<h2 id="lpæŒ‡ä»¤è¯¦è§£"><a href="#lpæŒ‡ä»¤è¯¦è§£" class="headerlink" title="lpæŒ‡ä»¤è¯¦è§£"></a>lpæŒ‡ä»¤è¯¦è§£</h2><p><a href="https://www.computerhope.com/unix/ulp.htm#co" target="_blank" rel="noopener">https://www.computerhope.com/unix/ulp.htm#co</a>   </p><h2 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h2><p>æš‚æ—¶ç”¨è¿™ä¸ªæ¥</p><pre class=" language-shell"><code class="language-shell">lp -o copies=2 -o collate=false -o sides=two-sided-long-edge ~/æ¡Œé¢/1.pdf</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> lp </tag>
            
            <tag> æ‰“å°æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>proå·¥ç¨‹è½¬vså·¥ç¨‹</title>
      <link href="/2020/06/27/pro-gong-cheng-zhuan-vs-gong-cheng/"/>
      <url>/2020/06/27/pro-gong-cheng-zhuan-vs-gong-cheng/</url>
      
        <content type="html"><![CDATA[<ul><li>æ‰¾åˆ°vsçš„x86 native tool</li><li>qmakeæ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡</li><li>è¿›å…¥proæ–‡ä»¶ç›®å½•</li><li>qmake -tp vc xxxx.pro</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> qmake </tag>
            
            <tag> pro </tag>
            
            <tag> vs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QImage å¢åŠ  Format_Grayscale8 æšä¸¾å€¼</title>
      <link href="/2020/06/27/qimage-zeng-jia-format-grayscale8-mei-ju-zhi/"/>
      <url>/2020/06/27/qimage-zeng-jia-format-grayscale8-mei-ju-zhi/</url>
      
        <content type="html"><![CDATA[<p>Qt5.5ä¹‹åæ‰æ”¯æŒè¿™ä¸ªä¸œè¥¿ã€‚æ‰€ä»¥æˆ‘ä¸€ç›´æ¨èä½¿ç”¨é«˜ç‰ˆæœ¬çš„Qtã€‚</p><p>Qtä¸­çš„commitè®°å½• </p><pre class=" language-shell"><code class="language-shell">d84a6eab5129ba29951a7ba6d82820b21cc9872eAdd Grayscale8 and Alpha8 formats to QImage and drawing</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QImage </tag>
            
            <tag> Format_Grayscale8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scpçš„ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2020/06/27/scp-de-shi-yong-fang-fa/"/>
      <url>/2020/06/27/scp-de-shi-yong-fang-fa/</url>
      
        <content type="html"><![CDATA[<p>æ¯æ¬¡å¾€æœåŠ¡å™¨ä¼ patchéƒ½æœ‰ç‚¹å°å¿˜ï¼ˆä¸»è¦æ˜¯ä¼ çš„å°‘=ã€‚=ï¼‰</p><p>ä»æœåŠ¡å™¨å¾€ä¸‹</p><pre><code>scp -P ç«¯å£å· æœåŠ¡å™¨åœ°å€ æœ¬åœ°åœ°å€</code></pre><p>ä»æœ¬åœ°ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><pre><code>scp -P 26399 æœ¬åœ°åœ°å€ æœåŠ¡å™¨åœ°å€</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> scp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtå…ƒå¯¹è±¡(Meta-Object)ç³»ç»Ÿ</title>
      <link href="/2020/06/27/qt-yuan-dui-xiang-meta-object-xi-tong/"/>
      <url>/2020/06/27/qt-yuan-dui-xiang-meta-object-xi-tong/</url>
      
        <content type="html"><![CDATA[<h2 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h2><p> -åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œåå°„æ˜¯æŒ‡è®¡ç®—æœºç¨‹åºåœ¨è¿è¡Œæ—¶ï¼ˆRun timeï¼‰å¯ä»¥è®¿é—®ã€æ£€æµ‹å’Œä¿®æ”¹å®ƒæœ¬èº«çŠ¶æ€æˆ–è¡Œä¸ºçš„ä¸€ç§èƒ½åŠ›ã€‚[1]ç”¨æ¯”å–»æ¥è¯´ï¼Œåå°„å°±æ˜¯ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™èƒ½å¤Ÿâ€œè§‚å¯Ÿâ€å¹¶ä¸”ä¿®æ”¹è‡ªå·±çš„è¡Œä¸ºã€‚</p><p>è¦æ³¨æ„æœ¯è¯­â€œåå°„â€å’Œâ€œå†…çœâ€ï¼ˆtype introspectionï¼‰çš„å…³ç³»ã€‚å†…çœï¼ˆæˆ–ç§°â€œè‡ªçœâ€ï¼‰æœºåˆ¶ä»…æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶å¯¹è‡ªèº«ä¿¡æ¯ï¼ˆç§°ä¸ºå…ƒæ•°æ®ï¼‰çš„æ£€æµ‹ï¼›åå°„æœºåˆ¶ä¸ä»…åŒ…æ‹¬è¦èƒ½åœ¨è¿è¡Œæ—¶å¯¹ç¨‹åºè‡ªèº«ä¿¡æ¯è¿›è¡Œæ£€æµ‹ï¼Œè¿˜è¦æ±‚ç¨‹åºèƒ½è¿›ä¸€æ­¥æ ¹æ®è¿™äº›ä¿¡æ¯æ”¹å˜ç¨‹åºçŠ¶æ€æˆ–ç»“æ„ã€‚</p><h2 id="C-çš„åå°„"><a href="#C-çš„åå°„" class="headerlink" title="C++çš„åå°„"></a>C++çš„åå°„</h2><p>C++çš„æ ‡å‡†è¯­æ³•æ˜¯ä¸æä¾›åå°„çš„ç‰¹æ€§çš„ï¼Œä¸è¿‡éšç€C++17çš„å®šç¨¿ï¼Œä¼°è®¡è¿™ä¸ªå…³é”®è¯ä¸ä¼šåŠ åˆ°æ ‡å‡†ä¸­äº†ã€‚ä¸è¿‡è¿™ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨templateæ¥å®ç°ï¼Œè¿™æ¬¡å°±ä¸å†™templateäº†ã€‚ä»Šå¤©ä¸»è¦æ˜¯è®²çš„æ˜¯Qtã€‚</p><h2 id="Qtçš„åå°„"><a href="#Qtçš„åå°„" class="headerlink" title="Qtçš„åå°„"></a>Qtçš„åå°„</h2><p>Qtæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¢åŠ äº†mocçš„è¿‡ç¨‹ï¼Œä¸ªäººç†è§£ï¼ŒQtæ‰©å±•äº†C++çš„è¯­æ³•ï¼Œä»¥åŠå¢å¼ºäº†è‡ªå·±çš„åŸºæœ¬åº“ã€‚</p><blockquote><p>Meta Object System is a part of Qt framework core provided to support Qt extensions to C++ like signals/slots for inter-object communication, run-time type information, and the dynamic property system.[1]<br>Architecture<br>The Meta object system consists of 3 things: QObject class, Q_OBJECT macro and a tool called moc (Meta-Object Compiler). QObject is the base class for all Qt classes, Q_OBJECT macro is used to enable meta-object features in classes and finally moc is a preprocessor that changes Q_OBJECT macro instances to C++ source code to enable meta object system mechanism in the class in which it is used.[2]<br>Using the meta object system has brought some criticism. In Qt documentation, several reasons have been given for the use of the meta object system, including benefits of code generation, dynamism of GUIs, automatic binding to scripting languages, not adding limitations and also reasonable performance in signal/slot implementation with moc.[3] There are some efforts to make Qt needless of a preprocessor. These efforts include re-implementing Qt moc using libclang.[4] </p></blockquote><p>mocå¯ä»¥ç†è§£å°†Qtä¸­çš„ä¸€äº›å…³é”®è¯ï¼Œæ¯”å¦‚Q_Object ï¼ŒQ_PROPERTYç­‰è½¬åŒ–ä¸ºc++çš„åŸºæœ¬è¯­æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¼–è¯‘Qtçš„å·¥ç¨‹æ—¶ï¼Œé¦–å…ˆè¦qmake-&gt;makeã€‚</p><p>ä¸ªäººè®¤ä¸ºQtæœ‰ä¸¤ä¸ªæˆ‘æ¯”è¾ƒçœ‹é‡çš„ç‰¹ç‚¹ã€‚</p><ul><li>STLåŸºç¡€åº“çš„æ‰©å±•ã€‚</li><li>C++åŸºæœ¬è¯­æ³•ä¸ç‰¹æ€§çš„æ‰©å±•ã€‚</li></ul><p>å°¤å…¶æ˜¯åŸºæœ¬è¯­æ³•çš„æ‰©å±•ï¼Œæ¯”å¦‚ä¿¡å·æ§½ï¼Œå…ƒå¯¹è±¡ç³»ç»Ÿï¼Œè®©C++ä¸€ä¸ªé™æ€è¯­è¨€æœ‰äº†åŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨templateæ¥å®ç°ï¼Œä½†æ˜¯è¿™ç©æ„å„¿ä¸€èˆ¬äººåˆç”¨ä¸èµ·ï¼Œè€Œä¸”å†™èµ·æ¥ä¹Ÿæ¯”è¾ƒæ¶å¿ƒï¼‰ã€‚è¿™ä¸€ç‚¹æˆ‘å°±å¯ä»¥å¹çˆ†äº†ã€‚</p><p>ä¸‹è¾¹å¼€å§‹è®²Qtçš„åå°„ã€‚Qtçš„åå°„æ˜¯åŸºäºQtçš„å…ƒå¯¹è±¡ç³»ç»Ÿçš„ã€‚å½“ç„¶Qtè¿˜ä¸èƒ½åšåˆ°åƒjavaé‚£æ ·é€šè¿‡ç±»åæ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªéœ€è¦æˆ‘ä»¬è‡ªå·±å†™ä¸€ä¸ªå·¥å‚æ¨¡å¼ã€‚ä¸ªäººè®¤ä¸ºï¼Œé™¤äº†è¿™ä¸€ç‚¹ï¼Œä¸javaä¸­çš„åå°„æ²¡æœ‰å•¥åŒºåˆ«äº†ã€‚éƒ½å¯ä»¥åŠ¨æ€çš„å»è®¿é—®å…¶æˆå‘˜å˜é‡ï¼Œæˆå‘˜å‡½æ•°ï¼Œä»¥åŠè®¾ç½®å±æ€§ã€‚å½“ç„¶å¿…é¡»åŠ ä¸ŠQtè‡ªå·±çš„è¯­æ³•ã€‚</p><p>ä¸¾ä¸ªæ —å­</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//1 .ç»§æ‰¿ QObject </span><span class="token keyword">class</span> <span class="token class-name">TestObject</span> <span class="token operator">:</span> <span class="token keyword">public</span> QObject<span class="token punctuation">{</span>    Q_OBJECT <span class="token comment" spellcheck="true">// 2.å£°æ˜Q_OBJECT</span>    <span class="token function">Q_PROPERTY</span><span class="token punctuation">(</span>QString text READ text WRITE setText NOTIFY textChange<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//3. Q_PROPERTY æ³¨å†Œæˆå‘˜å˜é‡</span>    <span class="token function">Q_PROPERTY</span><span class="token punctuation">(</span>QString text MEMBER m_text NOTIFY textChange<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//4. æ³¨å†Œçš„æˆå‘˜å˜é‡èƒ½å¤Ÿå“åº”è‡ªå®šä¹‰çš„signals textChange</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">TestObject</span><span class="token punctuation">(</span>QObject<span class="token operator">*</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">TestObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//------</span>    Q_INVOKABLE QString <span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//5.æ³¨å†Œç±»çš„æˆå‘˜å‡½æ•°</span>    Q_INVOKABLE <span class="token keyword">void</span> <span class="token function">setText</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> strText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//5.æ³¨å†Œç±»çš„æˆå‘˜å‡½æ•°</span>    QString m_text<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ç±»çš„æˆå‘˜å˜é‡</span>signals<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">textChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è‡ªå®šä¹‰çš„signals</span><span class="token keyword">public</span> slots<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">textslot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"textslot"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//è‡ªå®šä¹‰çš„signalså“åº”çš„æ§½å‡½æ•°</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//cpp</span>TestObject<span class="token operator">::</span><span class="token function">TestObject</span><span class="token punctuation">(</span>QObject<span class="token operator">*</span> parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QObject</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setObjectName</span><span class="token punctuation">(</span><span class="token string">"TestObject"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">textChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">textslot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>TestObject<span class="token operator">::</span><span class="token operator">~</span><span class="token function">TestObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">void</span> TestObject<span class="token operator">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"*********************"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"init"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token punctuation">}</span>QString TestObject<span class="token operator">::</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> m_text<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> TestObject<span class="token operator">::</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> strText<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_text <span class="token operator">==</span> strText<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    m_text <span class="token operator">=</span> strText<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//    emit textChange(); //æœ‰äº†ç¬¬å››æ¡è¿™ä¸ªè¯­å¥å·²ç»ä¸éœ€è¦äº†ã€‚</span><span class="token punctuation">}</span></code></pre><p>è¿™é‡Œçœ‹è°ƒç”¨æ–¹æ³•</p><pre><code>    TestObject* obj = new TestObject(this);  // newä¸€ä¸ªå¯¹è±¡    qDebug()&lt;&lt;obj-&gt;objectName()&lt;&lt;endl; //è¾“å‡ºå¯¹è±¡çš„åå­—    // custom object property    obj-&gt;setProperty(&quot;text&quot;, &quot;hahaha&quot;);    //è®¾ç½®å¯¹è±¡çš„å±æ€§    qDebug()&lt;&lt;obj-&gt;property(&quot;text&quot;).toString()&lt;&lt;endl; //è¾“å‡ºå¯¹è±¡çš„å±æ€§    //å¾—åˆ°æ³¨å†Œçš„ç±»æˆå‘˜å‡½æ•°    qDebug()&lt;&lt;&quot;begin--------------------custom class method&quot;&lt;&lt;endl;    const QMetaObject* mobj = obj-&gt;metaObject();    qDebug()&lt;&lt;mobj-&gt;methodCount()&lt;&lt;endl;    for(int i = 0; i &lt; mobj-&gt;methodCount(); i++)    {        QMetaMethod mMethod = mobj-&gt;method(i);        QByteArray byteArray = mMethod.name();        //è¾“å‡ºå‡½æ•°ç±»å‹ä¸å‡½æ•°åç§°        qDebug()&lt;&lt;mMethod.typeName()&lt;&lt;&quot;-&gt;&quot;&lt;&lt;QString(byteArray)&lt;&lt;endl;     }    qDebug()&lt;&lt;&quot;end----------------------custom class method&quot;&lt;&lt;endl;    //è°ƒç”¨æ³¨å†Œçš„æˆå‘˜å‡½æ•°ï¼Œé€šè¿‡Q_RETURN_ARGæ¥è·å–è¿”å›å€¼    qDebug()&lt;&lt;&quot;begin    QMetaObject::invokeMethod&quot;&lt;&lt;endl;    QString invokeString;    //è°ƒç”¨ç±»çš„æˆå‘˜å‡½æ•°    QMetaObject::invokeMethod(obj, &quot;text&quot;, Qt::DirectConnection, Q_RETURN_ARG(QString, invokeString));    qDebug()&lt;&lt;invokeString&lt;&lt;endl;    qDebug()&lt;&lt;&quot;end            QMetaObject::invokeMethod&quot;&lt;&lt;endl;    // å†æ¬¡è®¾ç½®textå€¼ï¼Œå¯ä»¥å“åº”è¿™ä¸ªä¿¡å·ï¼Œå¯ä»¥å‚è€ƒ4    obj-&gt;setProperty(&quot;text&quot;, &quot;luelueluelue&quot;);</code></pre><p>çœ‹ä¸Šè¾¹çš„ä»£ç ï¼ŒC++èƒ½å¤Ÿéšæ—¶è·å–å½“å‰ç±»çš„æˆå‘˜å˜é‡ä¸æˆå‘˜å‡½æ•°ä»¥åŠè°ƒç”¨ã€‚(å¹¶ä¸æ˜¯é€šè¿‡C++çš„type id)è¿™å°±æ˜¯åå°„ã€‚åå°„åœ¨å†™GUIçš„æ—¶å€™æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥éšæ—¶è·å–å½“å‰å¯¹è±¡çš„ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„å±æ€§ä»¥åŠæƒ³è¦è°ƒç”¨çš„å‡½æ•°ã€‚é™æ€è¯­è¨€æœ‰äº†åŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ã€‚è¿™å°±æ˜¯Qtå¼ºå¤§çš„åœ°æ–¹ã€‚</p><h2 id="Qté€šè¿‡ç±»åæ¥å®ç°çœŸæ­£çš„åå°„"><a href="#Qté€šè¿‡ç±»åæ¥å®ç°çœŸæ­£çš„åå°„" class="headerlink" title="Qté€šè¿‡ç±»åæ¥å®ç°çœŸæ­£çš„åå°„"></a>Qté€šè¿‡ç±»åæ¥å®ç°çœŸæ­£çš„åå°„</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QByteArray></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QMetaObject></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QHash></span></span><span class="token macro property">#<span class="token directive keyword">ifndef</span> OBJECTFACTORY_H</span><span class="token macro property">#<span class="token directive keyword">define</span> OBJECTFACTORY_H</span><span class="token keyword">class</span> <span class="token class-name">ObjectFactory</span><span class="token punctuation">{</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> T<span class="token operator">></span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">registerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">constructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> T<span class="token operator">::</span>staticMetaObject<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>constructorHelper<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">static</span> QObject<span class="token operator">*</span> <span class="token function">createObject</span><span class="token punctuation">(</span> <span class="token keyword">const</span> QByteArray<span class="token operator">&amp;</span> className<span class="token punctuation">,</span> QObject<span class="token operator">*</span> parent <span class="token operator">=</span> <span class="token constant">NULL</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>        Constructor constructor <span class="token operator">=</span> <span class="token function">constructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span> className <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> constructor <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>constructor<span class="token punctuation">)</span><span class="token punctuation">(</span> parent <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">typedef</span> QObject<span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">*</span>Constructor<span class="token punctuation">)</span><span class="token punctuation">(</span> QObject<span class="token operator">*</span> parent <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> T<span class="token operator">></span>    <span class="token keyword">static</span> QObject<span class="token operator">*</span> <span class="token function">constructorHelper</span><span class="token punctuation">(</span> QObject<span class="token operator">*</span> parent <span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">T</span><span class="token punctuation">(</span> parent <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">static</span> QHash<span class="token operator">&lt;</span>QByteArray<span class="token punctuation">,</span> Constructor<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token function">constructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">static</span> QHash<span class="token operator">&lt;</span>QByteArray<span class="token punctuation">,</span> Constructor<span class="token operator">></span> instance<span class="token punctuation">;</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">// OBJECTFACTORY_H</span></code></pre><p>ä¸‹è¾¹æ˜¯ä½¿ç”¨æ–¹æ³•ã€‚todo ï¼Œè¿™ä¸ªä¸œè¥¿åº”è¯¥å†™æˆå•ä¾‹æ¨¡å¼çš„ã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//ä½¿ç”¨æ–¹æ³•</span>    ObjectFactory fac<span class="token punctuation">;</span>    fac<span class="token punctuation">.</span>registerClass<span class="token operator">&lt;</span>TestObject<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"begin-------------------------------"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    TestObject<span class="token operator">*</span> object <span class="token operator">=</span> qobject_cast<span class="token operator">&lt;</span>TestObject<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>fac<span class="token punctuation">.</span><span class="token function">createObject</span><span class="token punctuation">(</span> <span class="token string">"TestObject"</span> <span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    object<span class="token operator">-</span><span class="token operator">></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"template factory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>object<span class="token operator">-</span><span class="token operator">></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> å…ƒå¯¹è±¡ </tag>
            
            <tag> åå°„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CPP lambdaè¡¨è¾¾å¼</title>
      <link href="/2020/06/27/cpp-lambda-biao-da-shi/"/>
      <url>/2020/06/27/cpp-lambda-biao-da-shi/</url>
      
        <content type="html"><![CDATA[<p>å…¶å®ä¸€ç›´æœ‰ä¸ªç–‘é—®ï¼Œå°±æ˜¯lambdaè¡¨è¾¾å¼æ•è·thiså˜é‡çš„æ—¶å€™æ˜¯ä¸æ˜¯å¼•ç”¨ä¼ é€’ã€‚æƒ³ç”¨ä»£ç æµ‹è¯•ä¸‹æ˜¯ä¸æ˜¯å¼•ç”¨ä¼ é€’ã€‚ç”Ÿæ€•æœ‰æ‹·è´æ„é€ å‡½æ•°å•Šï¼</p><pre><code>    m_test1 = 1;  //æˆå‘˜ä¾¿æ¥å—¯    auto fTest = [this]()    {        this-&gt;m_test1 = 3;    };    fTest();    qDebug()&lt;&lt;this-&gt;m_test1&lt;&lt;endl;</code></pre><p>å‘ç°è¾“å‡º3ã€‚çœ‹æ¥æ˜¯å¼•ç”¨ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆä¼ é€’ã€‚</p><p>æœ¬è´¨thiså°±æ˜¯ä¸ªæŒ‡é’ˆå˜›ã€‚</p><p>stackoverflowä¸Šæœ‰ä¸ªç­”æ¡ˆæ€»ç»“çš„å¾ˆå¥½äº†</p><ul><li><a href="https://stackoverflow.com/questions/16323032/why-cant-i-capture-this-by-reference-this-in-lambda" target="_blank" rel="noopener">https://stackoverflow.com/questions/16323032/why-cant-i-capture-this-by-reference-this-in-lambda</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> cpp </tag>
            
            <tag> lambda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå®‰è£…ç³»ç»Ÿå‡ºç°é”™è¯¯failed to load ldlinux.c32</title>
      <link href="/2020/06/27/linux-an-zhuang-xi-tong-chu-xian-cuo-wu-failed-to-load-ldlinux-c32/"/>
      <url>/2020/06/27/linux-an-zhuang-xi-tong-chu-xian-cuo-wu-failed-to-load-ldlinux-c32/</url>
      
        <content type="html"><![CDATA[<p>UltraISO åˆ»å½•æ˜ åƒæ—¶å†™å…¥æ–¹å¼é€‰æ‹©â€RAWâ€</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QApplication::setGraphicsSystem</title>
      <link href="/2020/06/27/qapplication-setgraphicssystem/"/>
      <url>/2020/06/27/qapplication-setgraphicssystem/</url>
      
        <content type="html"><![CDATA[<h2 id="QApplication-setGraphicsSystem-QString"><a href="#QApplication-setGraphicsSystem-QString" class="headerlink" title="QApplication::setGraphicsSystem(QString )"></a>QApplication::setGraphicsSystem(QString )</h2><p>è¿™ä¸ªå‡½æ•°æ˜¯æ•´ä¸ªapplicationå…¨å±€çš„è®¾ç½®ï¼Œä¸»è¦æ˜¯è®¾ç½®å…¨å±€æ–‡å­—ï¼Œå›¾åƒçš„ç»˜åˆ¶å¼•æ“ã€‚</p><p>ç»˜åˆ¶å¼•æ“å¤§å®¶éƒ½çŸ¥é“ï¼Œé€‰æ‹©å¥½çš„ç»˜åˆ¶å¼•æ“å¯¹äºç¨‹åºçš„æå‡æ˜¯éå¸¸å¤§çš„ã€‚</p><p>å…¶ä¸­æœ‰ä¸‰ä¸ªå€¼å¯ä»¥è®¾ç½®</p><ul><li>native: æœ¬åœ°å¼•æ“</li><li>rasterï¼šQTè‡ªå¸¦å…‰æ …å¼•æ“</li><li>opengl: éœ€å¼€å‘æ¿æ”¯æŒ</li></ul><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><ul><li><p>è¿™ä¸ªå‡½æ•°éœ€è¦QApplicationæ„é€ å‡½æ•°ä¹‹å‰è°ƒç”¨</p></li><li><p>5.11ä¸­è¿™ä¸ªå‡½æ•°å·²ç»è¢«åºŸå¼ƒæ‰</p></li><li><p>opengléœ€è¦æœ¬åœ°æ”¯æŒ</p></li><li><p>x11ä¸‹æœ¬åœ°å¼•æ“æ¯”è¾ƒæ…¢ï¼Œæœ€å¥½ä½¿ç”¨rasterã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>oh-my-zsh git æ…¢/å¡é¡¿é—®é¢˜è§£å†³</title>
      <link href="/2020/06/27/oh-my-zsh-git-man-qia-dun-wen-ti-jie-jue/"/>
      <url>/2020/06/27/oh-my-zsh-git-man-qia-dun-wen-ti-jie-jue/</url>
      
        <content type="html"><![CDATA[<h2 id="å¿«ä¸€ç‚¹"><a href="#å¿«ä¸€ç‚¹" class="headerlink" title="å¿«ä¸€ç‚¹"></a>å¿«ä¸€ç‚¹</h2><p>è¿›å…¥gitçš„ç›®å½•</p><pre><code>git config --add oh-my-zsh.hide-dirty 1</code></pre><h2 id="å†å¿«ä¸€ç‚¹"><a href="#å†å¿«ä¸€ç‚¹" class="headerlink" title="å†å¿«ä¸€ç‚¹"></a>å†å¿«ä¸€ç‚¹</h2><pre><code>git config --add oh-my-zsh.hide-status 1</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> oh-my-zsh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtä¸­æŠ¥é”™error: allocation of incomplete type &#39;Ui::â€˜</title>
      <link href="/2020/06/27/qt-zhong-bao-cuo-error-allocation-of-incomplete-type-ui/"/>
      <url>/2020/06/27/qt-zhong-bao-cuo-error-allocation-of-incomplete-type-ui/</url>
      
        <content type="html"><![CDATA[<p>æ¯æ¬¡åœ¨Qtä¸­å•ç‹¬æ·»åŠ UIæ–‡ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚éœ€è¦æ³¨æ„è¿™ä¹ˆå‡ ç‚¹<br>åˆ‡è®°è¦ä¸ç±»åä¿æŒä¸€è‡´<br>ä¸¾ä¸ªæ —å­æˆ‘çš„ç±»åå«</p><pre><code>CMainWidget</code></pre><p>é‚£æˆ‘çš„æ–‡ä»¶åå°±å«</p><pre><code>cmainwidget.hcmainwidget.cpp</code></pre><p>é‚£éœ€è¦åœ¨cmainwidget.hå¤´æ–‡ä»¶ä¸­æ·»åŠ </p><pre><code>namespace Ui {class cmainwidget;}</code></pre><p>åœ¨cmainwidget.cppæ·»åŠ </p><pre><code>#include &quot;ui_cmainwidget.h&quot;</code></pre><p>æ·»åŠ ç§æœ‰æˆå‘˜å˜é‡</p><pre><code>private:    Ui::cmainwidget* ui;</code></pre><p>åˆå§‹åŒ–æˆå‘˜å˜é‡</p><pre><code>    ui(new Ui::cmainwidget)</code></pre><p>æ„é€ å‡½æ•°ä¸­</p><pre><code>    ui-&gt;setupUi(this);</code></pre><h2 id="æœ€é‡è¦çš„ä¸€ç‚¹"><a href="#æœ€é‡è¦çš„ä¸€ç‚¹" class="headerlink" title="æœ€é‡è¦çš„ä¸€ç‚¹"></a>æœ€é‡è¦çš„ä¸€ç‚¹</h2><p><em>æœ€åä¸€æ¡ï¼Œåˆ«å¿˜äº†æŠŠcmainwidget.uiä¸­çš„widgetåå­—æ”¹æˆcmainwidgetï¼Œè¿™ä¸ªæœ€é‡è¦ï¼</em></p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> error </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹shç»ˆç«¯å¯åŠ¨ä»£ç†</title>
      <link href="/2020/06/27/linux-xia-sh-zhong-duan-qi-dong-dai-li/"/>
      <url>/2020/06/27/linux-xia-sh-zhong-duan-qi-dong-dai-li/</url>
      
        <content type="html"><![CDATA[<pre><code>export ALL_PROXY=socks5://127.0.0.1:1080</code></pre><p>ä¸´æ—¶å¯ç”¨ä¸‹ï¼Œè€å®¶è¿™ä¸ªç ´ç½‘cloneä¸äº†githubçš„ä»£ç ã€‚</p><p>â€”-åº”è¯¥ä¹Ÿå¯ä»¥ä¸‹pdfiumçš„ç¼–è¯‘å·¥å…·é“¾äº†ï¼Œåˆç»™è‡ªå·±æŒ–äº†ä¸€ä¸ªå¤§å‘</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>manjaro18 gnome KDE xfce åŸºç¡€é…ç½®æµç¨‹</title>
      <link href="/2020/06/27/manjaro18-gnome-kde-xfce-ji-chu-pei-zhi-liu-cheng/"/>
      <url>/2020/06/27/manjaro18-gnome-kde-xfce-ji-chu-pei-zhi-liu-cheng/</url>
      
        <content type="html"><![CDATA[<h3 id="é¦–å…ˆæ›´æ¢å›½å†…æº"><a href="#é¦–å…ˆæ›´æ¢å›½å†…æº" class="headerlink" title="é¦–å…ˆæ›´æ¢å›½å†…æº"></a>é¦–å…ˆæ›´æ¢å›½å†…æº</h3><pre><code>sudo pacman -Syysudo pacman-mirrors -i -c China -m rank  #é€‰ä¸€ä¸ªæ¸…åæºå°±è¡Œsudo pacman -Syyu</code></pre><h3 id="å…ˆå®‰è£…vim"><a href="#å…ˆå®‰è£…vim" class="headerlink" title="å…ˆå®‰è£…vim"></a>å…ˆå®‰è£…vim</h3><pre><code>sudo pacman -S vim</code></pre><h3 id="æ·»åŠ archæº"><a href="#æ·»åŠ archæº" class="headerlink" title="æ·»åŠ archæº"></a>æ·»åŠ archæº</h3><pre><code>sudo vim /etc/pacman.conf</code></pre><p>æŠŠä¸‹è¾¹è¿™ä¸ªæ·»åŠ è¿›å»</p><pre><code>[archlinuxcn]SigLevel = Optional TrustedOnlyServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch</code></pre><p>ç„¶å</p><pre><code>sudo pacman -Syy &amp;&amp; sudo pacman -S archlinuxcn-keyring</code></pre><h3 id="å®‰è£…zsh"><a href="#å®‰è£…zsh" class="headerlink" title="å®‰è£…zsh"></a>å®‰è£…zsh</h3><pre><code>sudo pacman -S gitsudo pacman -S zshsh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;chsh -s /bin/zsha</code></pre><h3 id="æ›´æ¢è¾“å…¥æ³•"><a href="#æ›´æ¢è¾“å…¥æ³•" class="headerlink" title="æ›´æ¢è¾“å…¥æ³•"></a>æ›´æ¢è¾“å…¥æ³•</h3><pre><code>sudo pacman -S fcitx-sogoupinyinsudo pacman -S fcitx-im # å…¨éƒ¨å®‰è£…sudo pacman -S fcitx-configtool # å›¾å½¢åŒ–é…ç½®å·¥å…·</code></pre><p>è®¾ç½®ä¸­æ–‡è¾“å…¥æ³•ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘~/.xprofileæ–‡ä»¶ï¼Œå¢åŠ ä¸‹é¢å‡ è¡Œ(å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æ–°å»º)</p><pre><code>export GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport XMODIFIERS=&quot;@im=fcitx&quot;</code></pre><h3 id="ç„¶åå®‰è£…æˆ‘å¸¸ç”¨çš„è½¯ä»¶"><a href="#ç„¶åå®‰è£…æˆ‘å¸¸ç”¨çš„è½¯ä»¶" class="headerlink" title="ç„¶åå®‰è£…æˆ‘å¸¸ç”¨çš„è½¯ä»¶"></a>ç„¶åå®‰è£…æˆ‘å¸¸ç”¨çš„è½¯ä»¶</h3><pre><code>sudo pacman -Sy yaourtsudo pacman -S archlinuxcn-keyringsudo pacman -S wiznote #ä¸ºçŸ¥ç¬”è®°sudo pacman -S shadowsocks-qt5 # å’Œè°ä¸Šç½‘å¿…å¤‡sudo pacman -S qtcreator # ç‰›é€¼çš„IDEsudo pacman -S visual-studio-code-bin # vscodesudo pacman -S make # ç‰›é€¼çš„å·¥å…·sudo pacman -S screenfetch # æ˜¾ç¤ºLinuxç¯å¢ƒå·¥å…·sudo pacman -S deepin.com.qq.office # qqsudo pacman -S clang # ç‰›é€¼çš„ç¼–è¯‘å™¨sudo pacman -S electronic-wechat-git #å¾®ä¿¡sudo pacman -S gdb # é»˜è®¤æ²¡æœ‰sudo pacman -S flameshot-git #æˆªå›¾å·¥å…·sudo pacman -S wps-office</code></pre><p>è¿˜æœ‰ æˆ‘çš„é˜…è¯»å™¨çš„å¼€å‘åŒ…,ç¬¬ä¸€æ¬¡ç”¨archç³»çš„ç³»ç»Ÿï¼ŒæŠŠæˆ‘çš„PDFé˜…è¯»å™¨çš„ä¾èµ–ä¹Ÿæå®šäº†</p><pre><code>yaourt -S poppler-qt5</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> KDE </tag>
            
            <tag> manjaro </tag>
            
            <tag> gnome </tag>
            
            <tag> xfce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QFontDatabase: Cannot find font directory</title>
      <link href="/2020/06/27/qfontdatabase-cannot-find-font-directory/"/>
      <url>/2020/06/27/qfontdatabase-cannot-find-font-directory/</url>
      
        <content type="html"><![CDATA[<p>QFontDatabase: Cannot find font directory qt5 </p><p>æŒ‰ç…§æç¤ºï¼Œåœ¨å®‰è£…ç›®å½•ä¸­ libæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸ªfontsæ–‡ä»¶å¤¹ï¼ŒæŠŠå­—ä½“æ‹·è´è¿›å»å°±è¡Œã€‚</p><pre class=" language-cpp"><code class="language-cpp">QString fontPath <span class="token operator">=</span> <span class="token string">":/fonts/MyFont.ttf"</span><span class="token punctuation">;</span><span class="token keyword">int</span> fontId <span class="token operator">=</span> QFontDatabase<span class="token operator">::</span><span class="token function">addApplicationFont</span><span class="token punctuation">(</span>fontPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fontId <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QFont <span class="token function">font</span><span class="token punctuation">(</span><span class="token string">"MyFont"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    app<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span>font<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QFontDatabase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtæ‰“å°æœºåŸç†æºç å‰–æ_Linux</title>
      <link href="/2020/06/27/qt-da-yin-ji-yuan-li-yuan-ma-pou-xi-linux/"/>
      <url>/2020/06/27/qt-da-yin-ji-yuan-li-yuan-ma-pou-xi-linux/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>Qtåœ¨Linuxä¸‹æ‰“å°æœºçš„åŸç†ä»¥åŠæºç ç›¸å…³çŸ¥è¯†ã€‚<br>ä¸‹è¾¹æˆ‘å°±è¯¦ç»†çš„è®²ä¸€ä¸‹Linuxä¸‹çš„æ‰“å°æœºåŸç†ã€‚</p><h1 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h1><p>Linuxä¸‹ç®€å•çš„æµç¨‹å°±æ˜¯è¿™æ ·</p><div id="flowchart-0" class="flow-chart"></div><h1 id="CUPS"><a href="#CUPS" class="headerlink" title="CUPS"></a>CUPS</h1><p>ç›®å‰Linuxä¸Šæ‰“å°çš„é€šç”¨åè®®æ˜¯CUPSåè®®ã€‚ç›®å‰ç”±è‹¹æœå…¬å¸æ¥ç»´æŠ¤ã€‚ç®—äº†æˆ‘è¿˜æ˜¯ç²˜ä¸€ä¸‹wikiçš„è¯æ¡å§ã€‚</p><p>wikiè¯æ¡</p><blockquote><p>CUPS (formerly an acronym for Common UNIX Printing System) is a modular printing system for Unix-like computer operating systems which allows a computer to act as a print server. A computer running CUPS is a host that can accept print jobs from client computers, process them, and send them to the appropriate printer.<br>CUPS consists of a print spooler and scheduler, a filter system that converts the print data to a format that the printer will understand, and a backend system that sends this data to the print device. CUPS uses the Internet Printing Protocol (IPP) as the basis for managing print jobs and queues. It also provides the traditional command line interfaces for the System V and Berkeley print systems, and provides support for the Berkeley print systemâ€™s Line Printer Daemon protocol and limited support for the server message block (SMB) protocol. System administrators can configure the device drivers which CUPS supplies by editing text files in Adobeâ€™s PostScript Printer Description (PPD) format. There are a number of user interfaces for different pl#atforms that can configure CUPS, and it has a built-in web-based interface. CUPS is free software, provided under the Apache License. </p></blockquote><blockquote><p>CUPSï¼ˆå‰ä¸ºCommon Unix Printing Systemï¼Œå³UNIXé€šç”¨æ‰“å°ç³»ç»Ÿçš„ç¼©å†™ï¼Œä½†ç°æ— å®˜æ–¹å…¨å[æ¥æºè¯·æ±‚]ï¼‰æ˜¯ä¸€ä¸ªç±»Unixæ“ä½œç³»ç»Ÿçš„ç»„åˆå¼å°åˆ·ç³»ç»Ÿï¼Œå…è®¸ä¸€å°è®¡ç®—æœºä½œä¸ºæ‰“å°æœåŠ¡å™¨ã€‚CUPSæ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯çš„è®¡ç®—æœºè¿›ç¨‹ï¼Œå¹¶é€åˆ°ç›¸åº”çš„æ‰“å°æœºã€‚<br>CUPSæ˜¯è‡ªç”±è½¯ä»¶ï¼Œä½¿ç”¨GNUé€šç”¨å…¬å…±è®¸å¯è¯å’ŒGNUå®½é€šç”¨å…¬å…±è®¸å¯è¯çš„ç¬¬2ç‰ˆã€‚<br>è¿ˆå…‹å°”Â·æ–¯ç»´ç‰¹ï¼ŒEasy Software Productsçš„æ‹¥æœ‰è€…ï¼Œäº1997å¹´å¼€å§‹å¼€å‘CUPSã€‚é¦–æ¬¡å…¬å¼€æµ‹è¯•ç‰ˆäº1999å¹´å‘å¸ƒã€‚[2]åŸæœ¬è®¾è®¡çš„CUPSä½¿ç”¨è¡Œå¼æ‰“å°æœºåå°ç¨‹åºåè®®ï¼Œä½†ç”±äºLPDçš„é™åˆ¶å’Œä¾›åº”å•†ä¸å…¼å®¹ï¼Œæ‰€ä»¥ç”±äº’è”ç½‘æ‰“å°åè®®(IPP)ä»£æ›¿ã€‚CUPSè¢«è¿…é€Ÿé»˜è®¤ä¸ºä¸€äº›Linuxå‘è¡Œç‰ˆçš„æ‰“å°ç³»ç»Ÿï¼Œå¦‚Red Hat Linuxã€‚2002å¹´3æœˆï¼Œè‹¹æœå…¬å¸åœ¨Mac OS X v10.2ä¸­é‡‡ç”¨äº†CUPSã€‚[3]2007å¹´2æœˆï¼Œè‹¹æœå…¬å¸è˜è¯·äº†è¿ˆå…‹å°”Â·æ–¯ç»´ç‰¹å¹¶è´­ä¹°äº†CUPSçš„æºä»£ç ã€‚[4]</p></blockquote><p>å†æ¬¡è¯´ä¸€é <em>ç›®å‰Unixç³»åˆ—çš„æ‰“å°åŸç†éƒ½æ˜¯èµ°çš„è¯¥åè®®ã€‚</em></p><h2 id="CUPSæ˜¯å¼€æºçš„"><a href="#CUPSæ˜¯å¼€æºçš„" class="headerlink" title="CUPSæ˜¯å¼€æºçš„"></a>CUPSæ˜¯å¼€æºçš„</h2><ul><li>å®˜ç½‘ <a href="https://www.cups.org/" target="_blank" rel="noopener">https://www.cups.org/</a> </li><li>æºç  <a href="https://github.com/apple/cups" target="_blank" rel="noopener">https://github.com/apple/cups</a></li></ul><p>æˆ‘è¯»è¿‡è¿™é‡Œçš„æºç ï¼Œä¸ºäº†éªŒè¯ä¸‹è¾¹æœ‰ä¸ªçº ç»“çš„é—®é¢˜ã€‚å…¨æ˜¯cå†™çš„ï¼Œä¹Ÿä¸éš¾ã€‚</p><h2 id="Linuxä¸‹çš„é©±åŠ¨"><a href="#Linuxä¸‹çš„é©±åŠ¨" class="headerlink" title="Linuxä¸‹çš„é©±åŠ¨"></a>Linuxä¸‹çš„é©±åŠ¨</h2><p>ç§‰æ‰¿ç€Linuxä¸‹çš„åŸåˆ™ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼Œå®é™…ä¸ŠLinuxä¸‹çš„æ‰“å°æœºé©±åŠ¨ä¹Ÿæ˜¯æ–‡ä»¶ï¼Œåœ¨ç›®å½•/etc/cups/ppdæ–‡ä»¶å¤¹ä¸‹ã€‚å¯ä»¥éšæ„è£…ä¸ªè™šæ‹Ÿé©±åŠ¨æ¥çœ‹ä¸‹</p><p>ç®€å•çš„ç»™å¤§å®¶çœ‹å‡ è¡Œppdæ–‡ä»¶ï¼Œè¿™æ˜¯æˆ‘æœ¬åœ°ä¸‹çš„é©±åŠ¨æ–‡ä»¶</p><pre><code>*PPD-Adobe: &quot;4.3&quot;*%%%% PPD file for Generic Text-Only Printer with CUPS.*%%%% Created by the CUPS PPD Compiler CUPS v2.2.7.*% (c) 2014 OpenPrinting*FormatVersion: &quot;4.3&quot;*FileVersion: &quot;1.0&quot;*LanguageVersion: English*LanguageEncoding: ISOLatin1*PCFileName: &quot;textonly.ppd&quot;*Product: &quot;(Generic Text-Only Printer)&quot;*Manufacturer: &quot;Generic&quot;*ModelName: &quot;Generic Text-Only Printer&quot;*ShortNickName: &quot;Generic Text-Only Printer&quot;*NickName: &quot;Generic Text-Only Printer&quot;*PSVersion: &quot;(3010.000) 0&quot;*LanguageLevel: &quot;3&quot;*ColorDevice: False*DefaultColorSpace: Gray*FileSystem: False*Throughput: &quot;1&quot;*LandscapeOrientation: Plus90*TTRasterizer: Type42*% Driver-defined attributes...*cupsFilter2: &quot;text/plain text/plain 0 texttotext&quot;*RequiresPageRegion All: True*1284DeviceID: &quot;MFG:Generic;MDL:Text-Only Printer;DES:Generic Text-Only Printer;CLS:PRINTER;CMD:TXT;DRV:Dtextonly,R1,M0;&quot;*cupsVersion: 2.2*cupsModelNumber: 0*cupsManualCopies: True*cupsFilter: &quot;text/plain 0 texttotext&quot;*cupsLanguages: &quot;en&quot;</code></pre><p>é‡Œè¾¹ä¸»è¦æ˜¯ä¸€äº›å­—ç¬¦ä¸²ä¿¡æ¯ã€‚ä½ å¯ä»¥ç®€å•çš„ç†è§£ï¼Œcupså°±æ˜¯æ¥è§£æppdæ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ä¿¡æ¯çš„ã€‚</p><h2 id="Qtå¯¹CUPSçš„æ”¯æŒã€‚"><a href="#Qtå¯¹CUPSçš„æ”¯æŒã€‚" class="headerlink" title="Qtå¯¹CUPSçš„æ”¯æŒã€‚"></a>Qtå¯¹CUPSçš„æ”¯æŒã€‚</h2><p>å®é™…ä¸ŠQtå¯¹CUPSçš„æ”¯æŒæ˜¯ç›¸å½“å¥½çš„ï¼Œæºç çº§åˆ«çš„è¯éƒ½ä¸åˆ°åƒè¡Œï¼Œå°†cupsæä¾›çš„ä¿¡æ¯å°è£…äº†ä¸€å±‚Qtçš„APIæ¥ç»™å¤§å®¶ä½¿ç”¨ã€‚å®é™…ä¸ŠQPrinterä¹Ÿæ˜¯è°ƒç”¨çš„Qtå°è£…çš„QCUPSSupportã€‚æ³¨æ„ä¸€ä¸‹QPrinteråœ¨Linuxä¸‹çš„åˆå§‹åŒ–æ˜¯éå¸¸æ…¢çš„ã€‚ä¸è¦é¢‘ç¹è°ƒç”¨ã€‚</p><p>ä¸Šæºç QCUPSSupport</p><pre><code>//Qt4.8.7/qt-everywhere-opensource-src-4.8.7/src/gui/painting/ æºç åœ¨è¿™é‡Œ/******************************************************************************** Copyright (C) 2015 The Qt Company Ltd.** Contact: http://www.qt.io/licensing/**** This file is part of the QtGui module of the Qt Toolkit.**** $QT_BEGIN_LICENSE:LGPL$** Commercial License Usage** Licensees holding valid commercial Qt licenses may use this file in** accordance with the commercial license agreement provided with the** Software or, alternatively, in accordance with the terms contained in** a written agreement between you and The Qt Company. For licensing terms** and conditions see http://www.qt.io/terms-conditions. For further** information use the contact form at http://www.qt.io/contact-us.**** GNU Lesser General Public License Usage** Alternatively, this file may be used under the terms of the GNU Lesser** General Public License version 2.1 or version 3 as published by the Free** Software Foundation and appearing in the file LICENSE.LGPLv21 and** LICENSE.LGPLv3 included in the packaging of this file. Please review the** following information to ensure the GNU Lesser General Public License** requirements will be met: https://www.gnu.org/licenses/lgpl.html and** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.**** As a special exception, The Qt Company gives you certain additional** rights. These rights are described in The Qt Company LGPL Exception** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.**** GNU General Public License Usage** Alternatively, this file may be used under the terms of the GNU** General Public License version 3.0 as published by the Free Software** Foundation and appearing in the file LICENSE.GPL included in the** packaging of this file. Please review the following information to** ensure the GNU General Public License version 3.0 requirements will be** met: http://www.gnu.org/copyleft/gpl.html.**** $QT_END_LICENSE$******************************************************************************/#ifndef QCUPS_P_H#define QCUPS_P_H//// W A R N I N G// -------------//// This file is not part of the Qt API. It exists purely as an// implementation detail. This header file may change from version to// version without notice, or even be removed.//// We mean it.//#include &quot;QtCore/qstring.h&quot;#include &quot;QtCore/qstringlist.h&quot;#include &quot;QtGui/qprinter.h&quot;#ifndef QT_NO_CUPS#include &lt;QtCore/qlibrary.h&gt;#include &lt;cups/cups.h&gt;#include &lt;cups/ppd.h&gt;QT_BEGIN_NAMESPACEQ_DECLARE_TYPEINFO(cups_option_t, Q_MOVABLE_TYPE | Q_PRIMITIVE_TYPE);class QCUPSSupport{public:    QCUPSSupport();    ~QCUPSSupport();    static bool isAvailable();    static int cupsVersion() { return isAvailable() ? CUPS_VERSION_MAJOR*10000+CUPS_VERSION_MINOR*100+CUPS_VERSION_PATCH : 0; }    int availablePrintersCount() const;    const cups_dest_t* availablePrinters() const;    int currentPrinterIndex() const;    const ppd_file_t* setCurrentPrinter(int index);    const ppd_file_t* currentPPD() const;    const ppd_option_t* ppdOption(const char *key) const;    const cups_option_t* printerOption(const QString &amp;key) const;    const ppd_option_t* pageSizes() const;    int markOption(const char* name, const char* value);    void saveOptions(QList&lt;const ppd_option_t*&gt; options, QList&lt;const char*&gt; markedOptions);    QRect paperRect(const char *choice) const;    QRect pageRect(const char *choice) const;    QStringList options() const;    static bool printerHasPPD(const char *printerName);    QString unicodeString(const char *s);    QPair&lt;int, QString&gt; tempFd();    int printFile(const char * printerName, const char * filename, const char * title,                  int num_options, cups_option_t * options);private:    void collectMarkedOptions(QStringList&amp; list, const ppd_group_t* group = 0) const;    void collectMarkedOptionsHelper(QStringList&amp; list, const ppd_group_t* group) const;    int prnCount;    cups_dest_t *printers;    const ppd_option_t* page_sizes;    int currPrinterIndex;    ppd_file_t *currPPD;#ifndef QT_NO_TEXTCODEC    QTextCodec *codec;#endif};QT_END_NAMESPACE#endif // QT_NO_CUPS#endif</code></pre><p>cpp</p><pre><code>//Qt4.8.7/qt-everywhere-opensource-src-4.8.7/src/gui/painting/qcups.cpp/******************************************************************************** Copyright (C) 2015 The Qt Company Ltd.** Contact: http://www.qt.io/licensing/**** This file is part of the QtGui module of the Qt Toolkit.**** $QT_BEGIN_LICENSE:LGPL$** Commercial License Usage** Licensees holding valid commercial Qt licenses may use this file in** accordance with the commercial license agreement provided with the** Software or, alternatively, in accordance with the terms contained in** a written agreement between you and The Qt Company. For licensing terms** and conditions see http://www.qt.io/terms-conditions. For further** information use the contact form at http://www.qt.io/contact-us.**** GNU Lesser General Public License Usage** Alternatively, this file may be used under the terms of the GNU Lesser** General Public License version 2.1 or version 3 as published by the Free** Software Foundation and appearing in the file LICENSE.LGPLv21 and** LICENSE.LGPLv3 included in the packaging of this file. Please review the** following information to ensure the GNU Lesser General Public License** requirements will be met: https://www.gnu.org/licenses/lgpl.html and** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.**** As a special exception, The Qt Company gives you certain additional** rights. These rights are described in The Qt Company LGPL Exception** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.**** GNU General Public License Usage** Alternatively, this file may be used under the terms of the GNU** General Public License version 3.0 as published by the Free Software** Foundation and appearing in the file LICENSE.GPL included in the** packaging of this file. Please review the following information to** ensure the GNU General Public License version 3.0 requirements will be** met: http://www.gnu.org/copyleft/gpl.html.**** $QT_END_LICENSE$******************************************************************************/#include &lt;qdebug.h&gt;#include &quot;qcups_p.h&quot;#ifndef QT_NO_CUPS#ifndef QT_LINUXBASE // LSB merges everything into cups.h# include &lt;cups/language.h&gt;#endif#include &lt;qtextcodec.h&gt;QT_BEGIN_NAMESPACEtypedef int (*CupsGetDests)(cups_dest_t **dests);typedef void (*CupsFreeDests)(int num_dests, cups_dest_t *dests);typedef const char* (*CupsGetPPD)(const char *printer);typedef int (*CupsMarkOptions)(ppd_file_t *ppd, int num_options, cups_option_t *options);typedef ppd_file_t* (*PPDOpenFile)(const char *filename);typedef void (*PPDMarkDefaults)(ppd_file_t *ppd);typedef int (*PPDMarkOption)(ppd_file_t *ppd, const char *keyword, const char *option);typedef void (*PPDClose)(ppd_file_t *ppd);typedef int (*PPDMarkOption)(ppd_file_t *ppd, const char *keyword, const char *option);typedef void (*CupsFreeOptions)(int num_options, cups_option_t *options);typedef void (*CupsSetDests)(int num_dests, cups_dest_t *dests);typedef cups_lang_t* (*CupsLangGet)(const char *language);typedef const char* (*CupsLangEncoding)(cups_lang_t *language);typedef int (*CupsAddOption)(const char *name, const char *value, int num_options, cups_option_t **options);typedef int (*CupsTempFd)(char *name, int len);typedef int (*CupsPrintFile)(const char * name, const char * filename, const char * title, int num_options, cups_option_t * options);static bool cupsLoaded = false;static int qt_cups_num_printers = 0;static CupsGetDests _cupsGetDests = 0;static CupsFreeDests _cupsFreeDests = 0;static CupsGetPPD _cupsGetPPD = 0;static PPDOpenFile _ppdOpenFile = 0;static PPDMarkDefaults _ppdMarkDefaults = 0;static PPDClose _ppdClose = 0;static CupsMarkOptions _cupsMarkOptions = 0;static PPDMarkOption _ppdMarkOption = 0;static CupsFreeOptions _cupsFreeOptions = 0;static CupsSetDests _cupsSetDests = 0;static CupsLangGet _cupsLangGet = 0;static CupsLangEncoding _cupsLangEncoding = 0;static CupsAddOption _cupsAddOption = 0;static CupsTempFd _cupsTempFd = 0;static CupsPrintFile _cupsPrintFile = 0;static void resolveCups(){    QLibrary cupsLib(QLatin1String(&quot;cups&quot;), 2);    if(cupsLib.load()) {        _cupsGetDests = (CupsGetDests) cupsLib.resolve(&quot;cupsGetDests&quot;);        _cupsFreeDests = (CupsFreeDests) cupsLib.resolve(&quot;cupsFreeDests&quot;);        _cupsGetPPD = (CupsGetPPD) cupsLib.resolve(&quot;cupsGetPPD&quot;);        _cupsLangGet = (CupsLangGet) cupsLib.resolve(&quot;cupsLangGet&quot;);        _cupsLangEncoding = (CupsLangEncoding) cupsLib.resolve(&quot;cupsLangEncoding&quot;);        _ppdOpenFile = (PPDOpenFile) cupsLib.resolve(&quot;ppdOpenFile&quot;);        _ppdMarkDefaults = (PPDMarkDefaults) cupsLib.resolve(&quot;ppdMarkDefaults&quot;);        _ppdClose = (PPDClose) cupsLib.resolve(&quot;ppdClose&quot;);        _cupsMarkOptions = (CupsMarkOptions) cupsLib.resolve(&quot;cupsMarkOptions&quot;);        _ppdMarkOption = (PPDMarkOption) cupsLib.resolve(&quot;ppdMarkOption&quot;);        _cupsFreeOptions = (CupsFreeOptions) cupsLib.resolve(&quot;cupsFreeOptions&quot;);        _cupsSetDests = (CupsSetDests) cupsLib.resolve(&quot;cupsSetDests&quot;);        _cupsAddOption = (CupsAddOption) cupsLib.resolve(&quot;cupsAddOption&quot;);        _cupsTempFd = (CupsTempFd) cupsLib.resolve(&quot;cupsTempFd&quot;);        _cupsPrintFile = (CupsPrintFile) cupsLib.resolve(&quot;cupsPrintFile&quot;);        if (_cupsGetDests &amp;&amp; _cupsFreeDests) {            cups_dest_t *printers;            int num_printers = _cupsGetDests(&amp;printers);            if (num_printers)                _cupsFreeDests(num_printers, printers);            qt_cups_num_printers = num_printers;        }    }    cupsLoaded = true;}// ================ CUPS Support class ========================QCUPSSupport::QCUPSSupport()    :    prnCount(0),    printers(0),    page_sizes(0),    currPrinterIndex(0),    currPPD(0){    if (!cupsLoaded)        resolveCups();    // getting all available printers    if (!isAvailable())        return;    // Update the available printer count    qt_cups_num_printers = prnCount = _cupsGetDests(&amp;printers);    for (int i = 0; i &lt; prnCount; ++i) {        if (printers[i].is_default) {            currPrinterIndex = i;            setCurrentPrinter(i);            break;        }    }#ifndef QT_NO_TEXTCODEC    cups_lang_t *cupsLang = _cupsLangGet(0);    codec = QTextCodec::codecForName(_cupsLangEncoding(cupsLang));    if (!codec)        codec = QTextCodec::codecForLocale();#endif}QCUPSSupport::~QCUPSSupport(){     if (currPPD)        _ppdClose(currPPD);     if (prnCount)         _cupsFreeDests(prnCount, printers);}int QCUPSSupport::availablePrintersCount() const{    return prnCount;}const cups_dest_t* QCUPSSupport::availablePrinters() const{    return printers;}const ppd_file_t* QCUPSSupport::currentPPD() const{    return currPPD;}const ppd_file_t* QCUPSSupport::setCurrentPrinter(int index){    Q_ASSERT(index &gt;= 0 &amp;&amp; index &lt;= prnCount);    if (index == prnCount)        return 0;    currPrinterIndex = index;    if (currPPD)        _ppdClose(currPPD);    currPPD = 0;    page_sizes = 0;    const char *ppdFile = _cupsGetPPD(printers[index].name);    if (!ppdFile)      return 0;    currPPD = _ppdOpenFile(ppdFile);    unlink(ppdFile);    // marking default options    _ppdMarkDefaults(currPPD);    // marking options explicitly set    _cupsMarkOptions(currPPD, printers[currPrinterIndex].num_options, printers[currPrinterIndex].options);    // getting pointer to page sizes    page_sizes = ppdOption(&quot;PageSize&quot;);    return currPPD;}int QCUPSSupport::currentPrinterIndex() const{    return currPrinterIndex;}bool QCUPSSupport::isAvailable(){    if(!cupsLoaded)        resolveCups();    return _cupsGetDests &amp;&amp;        _cupsFreeDests &amp;&amp;        _cupsGetPPD &amp;&amp;        _ppdOpenFile &amp;&amp;        _ppdMarkDefaults &amp;&amp;        _ppdClose &amp;&amp;        _cupsMarkOptions &amp;&amp;        _ppdMarkOption &amp;&amp;        _cupsFreeOptions &amp;&amp;        _cupsSetDests &amp;&amp;        _cupsLangGet &amp;&amp;        _cupsLangEncoding &amp;&amp;        _cupsAddOption &amp;&amp;        (qt_cups_num_printers &gt; 0);}const ppd_option_t* QCUPSSupport::ppdOption(const char *key) const{    if (currPPD) {        for (int gr = 0; gr &lt; currPPD-&gt;num_groups; ++gr) {            for (int opt = 0; opt &lt; currPPD-&gt;groups[gr].num_options; ++opt) {                if (qstrcmp(currPPD-&gt;groups[gr].options[opt].keyword, key) == 0)                    return &amp;currPPD-&gt;groups[gr].options[opt];            }        }    }    return 0;}const cups_option_t* QCUPSSupport::printerOption(const QString &amp;key) const{    for (int i = 0; i &lt; printers[currPrinterIndex].num_options; ++i) {        if (QLatin1String(printers[currPrinterIndex].options[i].name) == key)            return &amp;printers[currPrinterIndex].options[i];    }    return 0;}const ppd_option_t* QCUPSSupport::pageSizes() const{    return page_sizes;}int QCUPSSupport::markOption(const char* name, const char* value){    return _ppdMarkOption(currPPD, name, value);}void QCUPSSupport::saveOptions(QList&lt;const ppd_option_t*&gt; options, QList&lt;const char*&gt; markedOptions){    int oldOptionCount = printers[currPrinterIndex].num_options;    cups_option_t* oldOptions = printers[currPrinterIndex].options;    int newOptionCount = 0;    cups_option_t* newOptions = 0;    // copying old options that are not on the new list    for (int i = 0; i &lt; oldOptionCount; ++i) {        bool contains = false;        for (int j = 0; j &lt; options.count(); ++j) {            if (qstrcmp(options.at(j)-&gt;keyword, oldOptions[i].name) == 0) {                contains = true;                break;            }        }        if (!contains) {            newOptionCount = _cupsAddOption(oldOptions[i].name, oldOptions[i].value, newOptionCount, &amp;newOptions);        }    }    // we can release old option list     _cupsFreeOptions(oldOptionCount, oldOptions);    // adding marked options    for (int i = 0; i &lt; markedOptions.count(); ++i) {        const char* name = markedOptions.at(i);        ++i;        newOptionCount = _cupsAddOption(name, markedOptions.at(i), newOptionCount, &amp;newOptions);    }    // placing the new option list    printers[currPrinterIndex].num_options = newOptionCount;    printers[currPrinterIndex].options = newOptions;    // saving new default values    _cupsSetDests(prnCount, printers);}QRect QCUPSSupport::paperRect(const char *choice) const{    if (!currPPD)        return QRect();    for (int i = 0; i &lt; currPPD-&gt;num_sizes; ++i) {        if (qstrcmp(currPPD-&gt;sizes[i].name, choice) == 0)            return QRect(0, 0, qRound(currPPD-&gt;sizes[i].width), qRound(currPPD-&gt;sizes[i].length));    }    return QRect();}QRect QCUPSSupport::pageRect(const char *choice) const{    if (!currPPD)        return QRect();    for (int i = 0; i &lt; currPPD-&gt;num_sizes; ++i) {        if (qstrcmp(currPPD-&gt;sizes[i].name, choice) == 0)            return QRect(qRound(currPPD-&gt;sizes[i].left),                         qRound(currPPD-&gt;sizes[i].length - currPPD-&gt;sizes[i].top),                         qRound(currPPD-&gt;sizes[i].right - currPPD-&gt;sizes[i].left),                         qRound(currPPD-&gt;sizes[i].top - currPPD-&gt;sizes[i].bottom));    }    return QRect();}QStringList QCUPSSupport::options() const{    QStringList list;    collectMarkedOptions(list);    return list;}bool QCUPSSupport::printerHasPPD(const char *printerName){    if (!isAvailable())        return false;    const char *ppdFile = _cupsGetPPD(printerName);    if (ppdFile)        unlink(ppdFile);    return (ppdFile != 0);}QString QCUPSSupport::unicodeString(const char *s){#ifndef QT_NO_TEXTCODEC    return codec-&gt;toUnicode(s);#else    return QLatin1String(s);#endif}void QCUPSSupport::collectMarkedOptions(QStringList&amp; list, const ppd_group_t* group) const{    if (group == 0) {        if (!currPPD)            return;        for (int i = 0; i &lt; currPPD-&gt;num_groups; ++i) {            collectMarkedOptions(list, &amp;currPPD-&gt;groups[i]);            collectMarkedOptionsHelper(list, &amp;currPPD-&gt;groups[i]);        }    } else {        for (int i = 0; i &lt; group-&gt;num_subgroups; ++i)            collectMarkedOptionsHelper(list, &amp;group-&gt;subgroups[i]);    }}void QCUPSSupport::collectMarkedOptionsHelper(QStringList&amp; list, const ppd_group_t* group) const{    for (int i = 0; i &lt; group-&gt;num_options; ++i) {        for (int j = 0; j &lt; group-&gt;options[i].num_choices; ++j) {            if (group-&gt;options[i].choices[j].marked == 1 &amp;&amp; qstrcmp(group-&gt;options[i].choices[j].choice, group-&gt;options[i].defchoice) != 0)                list &lt;&lt; QString::fromLocal8Bit(group-&gt;options[i].keyword) &lt;&lt; QString::fromLocal8Bit(group-&gt;options[i].choices[j].choice);        }    }}QPair&lt;int, QString&gt; QCUPSSupport::tempFd(){    char filename[512];    int fd = _cupsTempFd(filename, 512);    return QPair&lt;int, QString&gt;(fd, QString::fromLocal8Bit(filename));}// Prints the given file and returns a job id.int QCUPSSupport::printFile(const char * printerName, const char * filename, const char * title,                            int num_options, cups_option_t * options){    return _cupsPrintFile(printerName, filename, title, num_options, options);}QT_END_NAMESPACE#endif // QT_NO_CUPS</code></pre><p>æ€»ä»£ç é‡å¤§æ¦‚ä¹Ÿå°±600è¡Œï¼Œç®€å•çš„æ¥è®²ï¼ŒQté€šè¿‡å‡½æ•°resolveCups()æŠŠcupsçš„åº“å‡½æ•°å°è£…äº†èµ·æ¥ã€‚åˆ«è¯´ä¸€ä¸ªåšå£«ç”Ÿï¼Œä¼°è®¡ä¸€ä¸ªåˆšä¸Šç­çš„æœ¬ç§‘ç”Ÿçœ‹è¿™ç‚¹ä»£ç å»é€‚é…Linuxä¸‹çš„é©±åŠ¨å°åŠå¤©ä¹Ÿå°±æå®Œäº†ï¼Œæ›´ä½•å†µQtéƒ½å·²ç»å°è£…å¥½äº†ç»™å¤§å®¶ä½¿ç”¨äº†ã€‚</p><p>ä¸‹è¾¹çš„ä»£ç æ˜¯cupsæ‰€æœ‰çš„åº“å‡½æ•°ã€‚</p><pre><code>typedef int (*CupsGetDests)(cups_dest_t **dests);typedef void (*CupsFreeDests)(int num_dests, cups_dest_t *dests);typedef const char* (*CupsGetPPD)(const char *printer);typedef int (*CupsMarkOptions)(ppd_file_t *ppd, int num_options, cups_option_t *options);typedef ppd_file_t* (*PPDOpenFile)(const char *filename);typedef void (*PPDMarkDefaults)(ppd_file_t *ppd);typedef int (*PPDMarkOption)(ppd_file_t *ppd, const char *keyword, const char *option);typedef void (*PPDClose)(ppd_file_t *ppd);typedef int (*PPDMarkOption)(ppd_file_t *ppd, const char *keyword, const char *option);typedef void (*CupsFreeOptions)(int num_options, cups_option_t *options);typedef void (*CupsSetDests)(int num_dests, cups_dest_t *dests);typedef cups_lang_t* (*CupsLangGet)(const char *language);typedef const char* (*CupsLangEncoding)(cups_lang_t *language);typedef int (*CupsAddOption)(const char *name, const char *value, int num_options, cups_option_t **options);typedef int (*CupsTempFd)(char *name, int len);typedef int (*CupsPrintFile)(const char * name, const char * filename, const char * title, int num_options, cups_option_t * options);static bool cupsLoaded = false;static int qt_cups_num_printers = 0;static CupsGetDests _cupsGetDests = 0;static CupsFreeDests _cupsFreeDests = 0;static CupsGetPPD _cupsGetPPD = 0;static PPDOpenFile _ppdOpenFile = 0;static PPDMarkDefaults _ppdMarkDefaults = 0;static PPDClose _ppdClose = 0;static CupsMarkOptions _cupsMarkOptions = 0;static PPDMarkOption _ppdMarkOption = 0;static CupsFreeOptions _cupsFreeOptions = 0;static CupsSetDests _cupsSetDests = 0;static CupsLangGet _cupsLangGet = 0;static CupsLangEncoding _cupsLangEncoding = 0;static CupsAddOption _cupsAddOption = 0;static CupsTempFd _cupsTempFd = 0;static CupsPrintFile _cupsPrintFile = 0;</code></pre><p>Qtçš„QPrinteræ‰“å°å¯¹è¯æ¡†ä¸­çš„å±æ€§è®¾ç½®å®é™…ä¸Šå°±æ˜¯è°ƒç”¨çš„QCUPSSupportæ¥è®¾ç½®çš„å±æ€§ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è®²ï¼Œåªéœ€è¦å…³å¿ƒQCUPSSupportå¤–è¾¹æš´éœ²çš„æ¥å£å°±å¯ä»¥äº†ã€‚</p><h1 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h1><p>å®é™…ä¸ŠQCUPSSupportåœ¨ä½¿ç”¨ä¸­è¿˜æ˜¯æœ‰ä¸¤ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œä½†æ˜¯éƒ½ä¸æ˜¯Qtçš„é”…ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯CUPSçš„é—®é¢˜</p><h2 id="QCUPSSupportåˆå§‹åŒ–è¿‡æ…¢"><a href="#QCUPSSupportåˆå§‹åŒ–è¿‡æ…¢" class="headerlink" title="QCUPSSupportåˆå§‹åŒ–è¿‡æ…¢"></a>QCUPSSupportåˆå§‹åŒ–è¿‡æ…¢</h2><p>QCUPSSupportåˆå§‹åŒ–è¿‡æ…¢ï¼Œæ…¢åˆ°äº†è§£æppdé©±åŠ¨æ–‡ä»¶ä¸Šã€‚ç›¸åº”çš„QPrinterçš„æ„é€ å‡½æ•°ä¹Ÿæ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥å°½é‡è¦ç”³è¯·ä¸€ä¸ªQPrinterçš„å˜é‡æ¥æ§åˆ¶æ‰“å°æœºå±æ€§ï¼Œæˆ–è€…å°‘ç”¨ã€‚å½“ç„¶è¿™æ˜¯ä»£ç è®¾è®¡çš„é—®é¢˜äº†ã€‚</p><h2 id="ppdMarkOption"><a href="#ppdMarkOption" class="headerlink" title="_ppdMarkOption"></a>_ppdMarkOption</h2><p>_ppdMarkOption è¿™ä¸ªå‡½æ•°æ˜¯è®¾ç½®æ‰“å°æœºå±æ€§çš„ã€‚æˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›é0ã€‚</p><p>ppdé©±åŠ¨æ–‡ä»¶ä¸­æœ‰å¾ˆå¤šæ‰“å°æœºçš„å±æ€§è®¾ç½®ã€‚</p><p>æœ‰çš„æ‰“å°æœºæŸå‡ ä¸ªé€‰é¡¹æ˜¯å†²çªçš„ï¼Œæ¯”å¦‚æœ‰çš„æ‰“å°æœºå¯ä»¥è®¾ç½®A5çº¸å¼ ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶è®¾ç½®åŒé¢æ‰“å°ã€‚å¦‚æœåŒæ—¶è®¾ç½®ï¼Œå®é™…ä¸Šæ˜¯è®¾ç½®å¤±æ•ˆçš„ã€‚æ¯”å¦‚ï¼Œè¿™æ—¶å€™ï¼Œä½ å…ˆè®¾ç½®å¥½äº†çº¸å¼ å¤§å°A5ï¼Œè¿™æ—¶å€™å†å»è®¾ç½®æ‰“å°æœºå±æ€§åŒé¢é•¿è¾¹æ‰“å°ã€‚è¿™æ—¶å€™_ppdMarkOptionæ˜¯è¿”å›é0ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¿™ä¸ªè®¾ç½®å¤±è´¥äº†ï¼‰ã€‚ä½†æ˜¯ï¼Œæ•²é‡ç‚¹ï¼Œä½†æ˜¯ï¼Œå³ä½¿è®¾ç½®é”™è¯¯ï¼ŒåŒé¢æ‰“å°çš„å±æ€§ä¾æ—§è®¾ç½®åˆ°äº†è¯¥æ‰“å°æœºä¸­ï¼Œè¿™æ—¶å€™å†å»æ‰“å°ï¼Œå®é™…ä¸Šæ˜¯ä¸ä¼šåŒé¢æ‰“å°å‡ºæ¥çš„ã€‚</p><p>ä¸ŠGithubä¸Šçœ‹äº†çœ‹ CUPSä¸­ _ppdMarkOptionçš„å®ç°æºç ï¼Œå‘ç°è¿™ä¸ªå‡½æ•°è®¾è®¡å°±æ˜¯è¿™æ ·çš„,å³ä½¿è®¾ç½®å¤±è´¥ä¹Ÿä¸ä¼šè®¾ç½®å›å»åŸæ¥çš„å€¼ã€‚è¿™æ ·åªèƒ½ç”±æˆ‘ä»¬è°ƒç”¨è€…å»å…¼å®¹è¿™ä¸ªæ¶å¿ƒçš„å‡½æ•°æ¥å£äº†ã€‚</p><h1 id="è‡³äºä¸ºå•¥æ²¡æœ‰ä¸ŠQt5çš„æºç "><a href="#è‡³äºä¸ºå•¥æ²¡æœ‰ä¸ŠQt5çš„æºç " class="headerlink" title="è‡³äºä¸ºå•¥æ²¡æœ‰ä¸ŠQt5çš„æºç "></a>è‡³äºä¸ºå•¥æ²¡æœ‰ä¸ŠQt5çš„æºç </h1><p>Qt5çš„å·¥ç¨‹ç»“æ„å·²ç»å˜äº†cupsçš„ä»£ç ä¸€éƒ¨åˆ†å‘¢å·²ç»æ”¾åˆ°qpainteré‡Œäº†ã€‚åŸç†æ²¡å˜ã€‚</p><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">st=>start: QPrinterop=>operation: QCUPSSupportop1=>operation: CUPSe=>end: Linux Corest->op->op1->e</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
            <tag> Qtæºç å‰–æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gité…ç½®æ›´æ¢å…¨å±€ç”¨æˆ·å</title>
      <link href="/2020/06/27/git-pei-zhi-geng-huan-quan-ju-yong-hu-ming/"/>
      <url>/2020/06/27/git-pei-zhi-geng-huan-quan-ju-yong-hu-ming/</url>
      
        <content type="html"><![CDATA[<h2 id="åå˜ˆ"><a href="#åå˜ˆ" class="headerlink" title="åå˜ˆ"></a>åå˜ˆ</h2><p>æ¯æ¬¡åœ¨githubä¸Šæäº¤ä»£ç ï¼Œéƒ½å‘ç°æ˜¯é»˜è®¤æˆ‘åŸæ¥çš„gitçš„é‚£ä¸ªç”¨æˆ·åï¼ŒåŸæ¥å†™äº†globleï¼Œç°åœ¨å¾—åœ¨å½“å‰gitç›®å½•ä¸‹å†å¤šè®¾ç½®ä¸€ä¸‹ï¼Œè¦ä¸ç„¶è¿˜æ˜¯å¾—ç”¨é»˜è®¤çš„ç”¨æˆ·å</p><pre class=" language-shell"><code class="language-shell">git config user.name "xxx"git config user.email "xxx"</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gtk widget ä¸ Qt Widgetçš„ç›¸äº’åµŒå¥—</title>
      <link href="/2020/06/27/gtk-widget-yu-qt-widget-de-xiang-hu-qian-tao/"/>
      <url>/2020/06/27/gtk-widget-yu-qt-widget-de-xiang-hu-qian-tao/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h1><p>gtk qtçª—å£çš„ç›¸äº’åµŒå¥—ã€‚ä¸»è¦æ˜¯ä½¿ç”¨äº†Gtkä¸­çš„socketè·Ÿplugçš„æ¨¡å¼ï¼Œä¸Qtä¸­çš„QX11EmbedContainerã€‚è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„UIåº“çš„ç›¸äº’åµŒå¥—çš„æ–¹æ³•ã€‚googleäº†ä¸‹å‘ç°æœ‰ä¸ªè€å“¥å†™å‡ºæ¥äº†ï¼Œä½†æ˜¯gtkåµŒå…¥åˆ°Qtçš„ä»£ç ä¸­æ˜¯æœ‰ç‚¹é—®é¢˜çš„ï¼Œæ‰€ä»¥æˆ‘æ”¹äº†æ”¹ä»–çš„ä»£ç ã€‚æœ€åç»ˆäºå®Œæˆäº†ï¼Œæ¯•ç«Ÿæˆ‘å¯¹gtkä¸å¤ªç†Ÿæ‚‰=ã€‚=ä»£ç å¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸åšä»»ä½•è¯´æ˜äº†ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>proæ–‡ä»¶ä¸­æ·»åŠ </p><pre class=" language-cpp"><code class="language-cpp">unix<span class="token operator">:</span> CONFIG <span class="token operator">+</span><span class="token operator">=</span> link_pkgconfigunix<span class="token operator">:</span> PKGCONFIG <span class="token operator">+</span><span class="token operator">=</span> gtk<span class="token operator">+-</span><span class="token number">2.0</span></code></pre><p>ä»£ç </p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;gtk/gtk.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QApplication></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QPushButton></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QX11EmbedContainer></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QX11EmbedWidget></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;gdk/gdkx.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> MAINWINDOW_IS_QT true</span><span class="token macro property">#<span class="token directive keyword">define</span> EMBEDDED_IS_QT false</span><span class="token keyword">void</span> <span class="token function">create_qt_embed</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>    QX11EmbedWidget<span class="token operator">*</span> plug <span class="token operator">=</span> <span class="token keyword">new</span> QX11EmbedWidget<span class="token punctuation">;</span>    plug<span class="token operator">-</span><span class="token operator">></span><span class="token function">embedInto</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    QPushButton<span class="token operator">*</span> button <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QPushButton</span><span class="token punctuation">(</span><span class="token string">"My Label"</span><span class="token punctuation">,</span> plug<span class="token punctuation">)</span><span class="token punctuation">;</span>    plug<span class="token operator">-</span><span class="token operator">></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">create_gtk_plug</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//    GtkWidget* plug = gtk_plug_new(id);</span><span class="token comment" spellcheck="true">//    gtk_widget_show(plug);</span><span class="token comment" spellcheck="true">//    GtkWidget* button = gtk_button_new_with_label("My Label");</span><span class="token comment" spellcheck="true">//    gtk_widget_show(button);</span><span class="token comment" spellcheck="true">//    GDK_WINDOW_XID(button);</span><span class="token comment" spellcheck="true">//    gdk_x11_window_get_xid()</span><span class="token comment" spellcheck="true">//    gtk_container_add(GTK_CONTAINER(plug), button);</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">gtk_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>argc<span class="token punctuation">,</span> <span class="token operator">&amp;</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>    QApplication <span class="token function">app</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>MAINWINDOW_IS_QT<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        QMainWindow<span class="token operator">*</span> main_window <span class="token operator">=</span> <span class="token keyword">new</span> QMainWindow<span class="token punctuation">;</span>        QX11EmbedContainer<span class="token operator">*</span> container <span class="token operator">=</span> <span class="token keyword">new</span> QX11EmbedContainer<span class="token punctuation">;</span>        main_window<span class="token operator">-</span><span class="token operator">></span><span class="token function">setCentralWidget</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>        container<span class="token operator">-</span><span class="token operator">></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"background-color:red;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>EMBEDDED_IS_QT<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">create_qt_embed</span><span class="token punctuation">(</span>container<span class="token operator">-</span><span class="token operator">></span><span class="token function">winId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//            gtk_widget_get_window(GTK_WIDGET(button));</span>            GtkWidget<span class="token operator">*</span> window<span class="token punctuation">;</span>            GtkWidget<span class="token operator">*</span> button<span class="token punctuation">;</span>            window <span class="token operator">=</span> <span class="token function">gtk_window_new</span><span class="token punctuation">(</span>GTK_WINDOW_TOPLEVEL<span class="token punctuation">)</span><span class="token punctuation">;</span>            button <span class="token operator">=</span> <span class="token function">gtk_button_new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">gtk_widget_show</span> <span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">gtk_container_add</span> <span class="token punctuation">(</span><span class="token function">GTK_CONTAINER</span> <span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">,</span> button<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">gtk_widget_show</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>            XID id <span class="token operator">=</span> <span class="token function">GDK_WINDOW_XWINDOW</span> <span class="token punctuation">(</span><span class="token function">GTK_WIDGET</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>            container<span class="token operator">-</span><span class="token operator">></span><span class="token function">embedClient</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        main_window<span class="token operator">-</span><span class="token operator">></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QApplication<span class="token operator">::</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span>    <span class="token punctuation">{</span>        GtkWidget <span class="token operator">*</span>window <span class="token operator">=</span> <span class="token function">gtk_window_new</span><span class="token punctuation">(</span>GTK_WINDOW_TOPLEVEL<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">g_signal_connect</span><span class="token punctuation">(</span><span class="token function">G_OBJECT</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"destroy"</span><span class="token punctuation">,</span>                         <span class="token function">G_CALLBACK</span><span class="token punctuation">(</span>gtk_main_quit<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">gtk_widget_show</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>        GtkWidget<span class="token operator">*</span> container <span class="token operator">=</span> <span class="token function">gtk_socket_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">gtk_widget_show</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">gtk_container_add</span><span class="token punctuation">(</span><span class="token function">GTK_CONTAINER</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>EMBEDDED_IS_QT<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">create_qt_embed</span><span class="token punctuation">(</span><span class="token function">gtk_socket_get_id</span><span class="token punctuation">(</span><span class="token function">GTK_SOCKET</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token function">create_gtk_plug</span><span class="token punctuation">(</span><span class="token function">gtk_socket_get_id</span><span class="token punctuation">(</span><span class="token function">GTK_SOCKET</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">gtk_main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> GTK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu18.04ç¼–è¯‘KDE dolphinæ–‡ä»¶ç®¡ç†å™¨</title>
      <link href="/2020/06/27/ubuntu18-04-bian-yi-kde-dolphin-wen-jian-guan-li-qi/"/>
      <url>/2020/06/27/ubuntu18-04-bian-yi-kde-dolphin-wen-jian-guan-li-qi/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>é¦–å…ˆæœ€è¿‘åœ¨ç ”ç©¶ï¼ˆå¡«å‘ï¼‰æ–‡ä»¶ç®¡ç†å™¨ï¼Œå…¶ä¸­Qtå®ç°çš„æ–‡ä»¶ç®¡ç†å™¨åšçš„æœ€å¥½çš„å°±æ˜¯KDEå®ç°çš„dolphin.æ‰€ä»¥ç‰¹æ„è£…äº†ä¸ªUbuntu18.04çš„æ“ä½œç³»ç»Ÿè£…äº†KDEçš„ç¯å¢ƒã€‚æ¥ç¼–è¯‘ä¸€ä¸‹dolphinã€‚</p><h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>ubuntuçš„kdeç¯å¢ƒ</p><pre class=" language-shell"><code class="language-shell">sudo apt-get install kubuntu-desktop</code></pre><h2 id="å‡†å¤‡ä¾èµ–"><a href="#å‡†å¤‡ä¾èµ–" class="headerlink" title="å‡†å¤‡ä¾èµ–"></a>å‡†å¤‡ä¾èµ–</h2><p>é¦–å…ˆè¦å®‰è£…dolphinçš„ä¾èµ–ã€‚è¿™é‡Œå®‰è£…çš„å…¨éƒ¨éƒ½æ˜¯kdeçš„ä¾èµ–</p><pre class=" language-shell"><code class="language-shell">sudo apt install kinit-dev libkf5crash-dev libkf5notifications-dev libkf5notifyconfig-dev libkf5parts-dev libkf5kcmutils-dev libkf5newstuff-dev libkf5coreaddons-dev libkf5i18n-dev libkf5dbusaddons-dev libkf5config-devsudo apt install libkf5activities-dev libphonon4qt5-devsudo apt install libkf5baloowidgets-dev libkf5filemetadata-dev libkf5kdelibs4support-devsudo apt install baloo-kf5-devsudo apt-get install git build-essential cmake qt5-default qtscript5-dev libssl-dev qttools5-dev qttools5-dev-tools qtmultimedia5-dev libqt5svg5-dev libqt5webkit5-dev libsdl2-dev libasound2 libxmu-dev libxi-dev freeglut3-dev libasound2-dev libjack-jackd2-dev libxrandr-dev</code></pre><p>ç”±äºæ˜¯æ–°çš„ç¯å¢ƒï¼Œè¿˜è¦å®‰è£…æ–°çš„ç¼–è¯‘å¼€å‘å·¥å…·ã€‚<br>ç„¶åå¯ä»¥å¼€å§‹ä¸‹è½½æºç </p><pre class=" language-shell"><code class="language-shell">sudo apt install git g++ build-essential qt5-qmake qt5-default cmakesudo apt-get install qtcreatorsudo apt-get install extra-cmake-modules</code></pre><p>ç„¶åä¸‹è½½æºç ï¼Œå¹¶ä¸”ç¼–è¯‘Debugç‰ˆæœ¬</p><pre class=" language-shell"><code class="language-shell">git clone git://anongit.kde.org/dolphincd dolphinmkdir buildcd buildcmake ../ -DCMAKE_BUILD_TYPE=Debugmake</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ubuntu </tag>
            
            <tag> kde </tag>
            
            <tag> dolphin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu16.04 å®‰è£… kubuntuæ¡Œé¢</title>
      <link href="/2020/06/27/ubuntu16-04-an-zhuang-kubuntu-zhuo-mian/"/>
      <url>/2020/06/27/ubuntu16-04-an-zhuang-kubuntu-zhuo-mian/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>æœ€è¿‘æƒ³çœ‹çœ‹kdeä¸‹çš„æ–‡ä»¶ç®¡ç†å™¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå› ä¸ºå‘ç°Qtè‡ªå¸¦çš„æ–‡ä»¶ç®¡ç†å™¨æ˜¯æœ‰æ€§èƒ½bugçš„,è€Œä¸”å¹¶æ²¡æœ‰uiçº¿ç¨‹ä¸Šçš„äº¤äº’å¤„ç†ï¼Œå¦‚æœæ”¹çš„è¯ï¼Œåªèƒ½å»æ›´æ”¹Qtæºç ï¼ˆä½†æ˜¯è¿™æ ·æ”¹ä¹Ÿå¤ªè›‹ç–¼äº†ï¼Œå“ªæœ‰ä¸€è¨€ä¸åˆå°±å»æ”¹Qtæºç çš„ï¼‰ã€‚æ‰€ä»¥æƒ³çœ‹çœ‹åŒæ ·æ˜¯Qtå†™çš„kdeæ¡Œé¢æ˜¯ä¸æ˜¯æœ‰è¿™ä¸ªé—®é¢˜ã€‚æ‰€ä»¥è£…äº†ä¸€ä¸ªkdeçš„ç¯å¢ƒæ¥çœ‹çœ‹ï¼Œå› ä¸ºä¹Ÿé‡åˆ°äº†ä¸€äº›å°é—®é¢˜ï¼Œè€Œä¸”ç™¾åº¦å‡ºæ¥çš„å…¨æ˜¯csdnçš„ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œåªèƒ½è‡ªå·±æ€»ç»“ä¸‹äº†ã€‚</p><h2 id="æ›´æ”¹æº"><a href="#æ›´æ”¹æº" class="headerlink" title="æ›´æ”¹æº"></a>æ›´æ”¹æº</h2><p>ubuntuè‡ªå¸¦çš„æºæ²¡æœ‰æ‰¾åˆ°ï¼Œæˆ‘å°±æ›´æ–°äº†ä¸‹æºã€‚é¦–å…ˆå¤‡ä»½æº</p><pre class=" language-shell"><code class="language-shell">cd /etc/apt/sudo cp sources.list sources.list.bak</code></pre><p>ç„¶åéƒ½åˆ æ‰é‡Œè¾¹çš„å†…å®¹ ï¼Œæ·»åŠ </p><pre class=" language-shell"><code class="language-shell"># ubuntu16.04 sourcedeb http://mirrors.ustc.edu.cn/ubuntu/ xenial main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ xenial-security main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ xenial-updates main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ xenial-proposed main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ xenial-backports main restricted universe multiversedeb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial main restricted universe multiversedeb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-security main restricted universe multiversedeb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-updates main restricted universe multiversedeb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-proposed main restricted universe multiversedeb-src http://mirrors.ustc.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse</code></pre><p>ç„¶åå†æ›´æ–°æº</p><pre class=" language-shell"><code class="language-shell">sudo apt-get update</code></pre><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æˆ‘çš„ubuntuç¯å¢ƒæ˜¯16.04æ‰€ä»¥å°±æŒ‰ç…§è¿™ä¸ªæ¥è®²äº†ã€‚</p><pre class=" language-shell"><code class="language-shell">sudo apt-get install kubuntu-desktop</code></pre><p>æˆ‘è¿™é‡Œä¸‹è½½äº†å¤§æ¦‚1.5Gçš„å®‰è£…åŒ…ï¼Œç„¶åå‘ç°æŠ¥é”™ï¼Œè®©sudo apt-get -f install ä¸‹å‘ç°è¿˜æ˜¯æŠ¥é”™</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// ç¬¬ä¸€ä¸ªé”™è¯¯</span> kde<span class="token operator">-</span>telepathy<span class="token operator">-</span>minimal <span class="token operator">:</span> ä¾èµ–<span class="token operator">:</span> kde<span class="token operator">-</span>config<span class="token operator">-</span>telepathy<span class="token operator">-</span><span class="token function">accounts</span> <span class="token punctuation">(</span><span class="token operator">>=</span> <span class="token number">15.04</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span> ä½†æ˜¯å®ƒå°†ä¸ä¼šè¢«å®‰è£…<span class="token comment" spellcheck="true">// -f install ä¹‹åè¿˜æ˜¯æŠ¥é”™ã€‚</span>dpkg<span class="token operator">:</span> å¤„ç†å½’æ¡£ <span class="token operator">/</span>var<span class="token operator">/</span>cache<span class="token operator">/</span>apt<span class="token operator">/</span>archives<span class="token operator">/</span>kde<span class="token operator">-</span>config<span class="token operator">-</span>telepathy<span class="token operator">-</span>accounts_4<span class="token operator">%</span>3a15<span class="token number">.12</span><span class="token punctuation">.</span><span class="token number">3</span><span class="token operator">-</span>0ubuntu1_amd64<span class="token punctuation">.</span><span class="token function">deb</span> <span class="token punctuation">(</span><span class="token operator">--</span>unpack<span class="token punctuation">)</span>æ—¶å‡ºé”™ï¼š æ­£è¯•å›¾è¦†ç›– <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>accounts<span class="token operator">/</span>services<span class="token operator">/</span>google<span class="token operator">-</span>im<span class="token punctuation">.</span>serviceï¼Œå®ƒåŒæ—¶è¢«åŒ…å«äºè½¯ä»¶åŒ… account<span class="token operator">-</span>plugin<span class="token operator">-</span>google <span class="token number">0.12</span><span class="token operator">+</span><span class="token number">16.04</span><span class="token punctuation">.</span><span class="token number">20160126</span><span class="token operator">-</span>0ubuntu1</code></pre><p>å‘ç°è¿™æ˜¯Ubuntuçš„ä¸€ä¸ªbugï¼ŒæŠŠæŠ¥é”™çš„è½¯ä»¶åŒ…å¹²æ‰å°±å¯ä»¥äº†ã€‚</p><pre class=" language-shell"><code class="language-shell">sudo dpkg -r account-plugin-google unity-scope-gdrive</code></pre><p>ç„¶åå†</p><pre class=" language-shell"><code class="language-shell">sudo apt-get -f install </code></pre><p>å°±okäº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> KDE </tag>
            
            <tag> kubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QFileSystemWatcheræºç å‰–æ(Linux)_1</title>
      <link href="/2020/06/27/qfilesystemwatcher-yuan-ma-pou-xi-linux-1/"/>
      <url>/2020/06/27/qfilesystemwatcher-yuan-ma-pou-xi-linux-1/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸Šä¸€ç¯‡è®²äº†QFileSystemWatcheræ¥æ£€æµ‹æ–‡ä»¶å¤¹çš„å˜åŒ–ï¼Œé‡Œè¾¹çš„å®ç°æœ‰ä¸¤ä¸ª</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// è¿™ä¸ªç”¨äºæ£€æµ‹æ–‡ä»¶ç±»å‹çš„å˜åŒ–</span><span class="token keyword">class</span> <span class="token class-name">QInotifyFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine<span class="token comment" spellcheck="true">// è¿™ä¸ªç”¨äºç›‘æ§Dirçš„å˜åŒ–</span><span class="token keyword">class</span> <span class="token class-name">QDnotifyFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine</code></pre><p>QFileSystemWatcherä¸­è¿™ä¸¤ä¸ªç±»ç›‘è§†æ–‡ä»¶å¤¹çš„å˜åŒ–è¿˜æœ‰ä¸€ä¸ªå°å°çš„ç¼ºç‚¹ï¼Œå°±æ˜¯æ— æ³•ç›‘è§†è¿æ¥åˆ°æœåŠ¡å™¨çš„ä½ç½®ï¼Œä¸€èˆ¬æŒ‚è½½åˆ°æœåŠ¡å™¨åˆ°Linuxæœ¬åœ°çš„è·¯å¾„æ˜¯è¿™é‡Œ</p><pre class=" language-shell"><code class="language-shell">/run/user/1000/gvfs</code></pre><p>è¿™ä¸ªç›®å½•ä¸‹çš„ã€‚æ²¡æœ‰åŠæ³•åªèƒ½è‡ªå·±æš‚æ—¶å®ç°äº†ã€‚</p><h2 id="å¤šçº¿ç¨‹-å®šæ—¶å™¨"><a href="#å¤šçº¿ç¨‹-å®šæ—¶å™¨" class="headerlink" title="å¤šçº¿ç¨‹ + å®šæ—¶å™¨"></a>å¤šçº¿ç¨‹ + å®šæ—¶å™¨</h2><p>å®é™…ä¸Šä¸€å¼€å§‹å‡†å¤‡è‡ªå·±å®ç°çš„ï¼Œä½†æ˜¯å‘ç°QFileSystemWatcheré‡Œè¾¹å·²ç»æœ‰ä¸€ä¸ªç±»æ˜¯å¯¹åº”çš„å®ç°äº†ã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">enum</span> <span class="token punctuation">{</span> PollingInterval <span class="token operator">=</span> <span class="token number">1000</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">QPollingFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine<span class="token punctuation">{</span>    Q_OBJECT    <span class="token keyword">class</span> <span class="token class-name">FileInfo</span>    <span class="token punctuation">{</span>        uint ownerId<span class="token punctuation">;</span>        uint groupId<span class="token punctuation">;</span>        QFile<span class="token operator">::</span>Permissions permissions<span class="token punctuation">;</span>        QDateTime lastModified<span class="token punctuation">;</span>        QStringList entries<span class="token punctuation">;</span>    <span class="token keyword">public</span><span class="token operator">:</span>        <span class="token function">FileInfo</span><span class="token punctuation">(</span><span class="token keyword">const</span> QFileInfo <span class="token operator">&amp;</span>fileInfo<span class="token punctuation">)</span>            <span class="token operator">:</span> <span class="token function">ownerId</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">ownerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              <span class="token function">groupId</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">groupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              <span class="token function">permissions</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              <span class="token function">lastModified</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">isDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                entries <span class="token operator">=</span> fileInfo<span class="token punctuation">.</span><span class="token function">absoluteDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entryList</span><span class="token punctuation">(</span>QDir<span class="token operator">::</span>AllEntries<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        FileInfo <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> QFileInfo <span class="token operator">&amp;</span>fileInfo<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">FileInfo</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> QFileInfo <span class="token operator">&amp;</span>fileInfo<span class="token punctuation">)</span> <span class="token keyword">const</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">isDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> entries <span class="token operator">!=</span> fileInfo<span class="token punctuation">.</span><span class="token function">absoluteDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entryList</span><span class="token punctuation">(</span>QDir<span class="token operator">::</span>AllEntries<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span>ownerId <span class="token operator">!=</span> fileInfo<span class="token punctuation">.</span><span class="token function">ownerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token operator">||</span> groupId <span class="token operator">!=</span> fileInfo<span class="token punctuation">.</span><span class="token function">groupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token operator">||</span> permissions <span class="token operator">!=</span> fileInfo<span class="token punctuation">.</span><span class="token function">permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token operator">||</span> lastModified <span class="token operator">!=</span> fileInfo<span class="token punctuation">.</span><span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">mutable</span> QMutex mutex<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> FileInfo<span class="token operator">></span> files<span class="token punctuation">,</span> directories<span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">QPollingFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList <span class="token function">addPaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList <span class="token function">removePaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> Q_SLOTS<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//--cpp</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"filewatcher.h"</span></span>QPollingFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">QPollingFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">ifndef</span> QT_NO_THREAD</span>    <span class="token function">moveToThread</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token punctuation">}</span><span class="token keyword">void</span> QPollingFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QTimer timer<span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>timer<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    timer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>PollingInterval<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>QStringList QPollingFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">addPaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span>                                                      QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span>                                                      QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList p <span class="token operator">=</span> paths<span class="token punctuation">;</span>    QMutableListIterator<span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">it</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QString path <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QFileInfo <span class="token function">fi</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fi<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>fi<span class="token punctuation">.</span><span class="token function">isDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">contains</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>                directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token function">QLatin1Char</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                fi <span class="token operator">=</span> <span class="token function">QFileInfo</span><span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token function">QLatin1Char</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>directories<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> fi<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>files<span class="token operator">-</span><span class="token operator">></span><span class="token function">contains</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>                files<span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>files<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> fi<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span>QStringList QPollingFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">removePaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span>                                                         QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span>                                                         QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList p <span class="token operator">=</span> paths<span class="token punctuation">;</span>    QMutableListIterator<span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">it</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QString path <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>directories<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAll</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>files<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            files<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAll</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>files<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>directories<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        locker<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QPollingFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QMetaObject<span class="token operator">::</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"quit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QPollingFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QMutableHashIterator<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> FileInfo<span class="token operator">></span> <span class="token function">fit</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>fit<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QHash<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> FileInfo<span class="token operator">></span><span class="token operator">::</span>iterator x <span class="token operator">=</span> fit<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QString path <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QFileInfo <span class="token function">fi</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fi<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            fit<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            emit <span class="token function">fileChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> fi<span class="token punctuation">)</span> <span class="token punctuation">{</span>            x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> fi<span class="token punctuation">;</span>            emit <span class="token function">fileChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    QMutableHashIterator<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> FileInfo<span class="token operator">></span> <span class="token function">dit</span><span class="token punctuation">(</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>dit<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QHash<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> FileInfo<span class="token operator">></span><span class="token operator">::</span>iterator x <span class="token operator">=</span> dit<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QString path <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QFileInfo <span class="token function">fi</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token function">QLatin1Char</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            fi <span class="token operator">=</span> <span class="token function">QFileInfo</span><span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token function">QLatin1Char</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fi<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            dit<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            emit <span class="token function">directoryChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> fi<span class="token punctuation">)</span> <span class="token punctuation">{</span>            fi<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fi<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                dit<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                emit <span class="token function">directoryChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> fi<span class="token punctuation">;</span>                emit <span class="token function">directoryChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// è¿™ä¸ªå¤–éƒ¨æ²¡æœ‰æš´éœ²å¯¹åº”çš„å˜åŒ–æ¥å£ï¼Œä½†æ˜¯æ£€æµ‹å…¶å®ƒç±»å‹çš„ç›®å½•å˜åŒ–æ—¶æˆ‘ä»¬ä¼šç”¨åˆ°</span><span class="token keyword">class</span> <span class="token class-name">QPollingFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine</code></pre><p>è¿™ä¸ªç±»Qtæ²¡æœ‰å¯¹å¤–æ¥å£æš´éœ²ï¼Œå®é™…ä¸Šçœ‹QFileSystemWatcherçš„å®ç°</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//polleråœ¨è¿™é‡Œåˆå§‹åŒ–</span><span class="token keyword">void</span> QFileSystemWatcherPrivate<span class="token operator">::</span><span class="token function">initPollerEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>poller<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token function">Q_Q</span><span class="token punctuation">(</span>QFileSystemWatcher<span class="token punctuation">)</span><span class="token punctuation">;</span>    poller <span class="token operator">=</span> <span class="token keyword">new</span> QPollingFileSystemWatcherEngine<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// that was a mouthful</span>    QObject<span class="token operator">::</span><span class="token function">connect</span><span class="token punctuation">(</span>poller<span class="token punctuation">,</span>                     <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">fileChanged</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                     q<span class="token punctuation">,</span>                     <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">_q_fileChanged</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QObject<span class="token operator">::</span><span class="token function">connect</span><span class="token punctuation">(</span>poller<span class="token punctuation">,</span>                     <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">directoryChanged</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                     q<span class="token punctuation">,</span>                     <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">_q_directoryChanged</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œè°ƒç”¨</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">objectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"_qt_autotest_force_engine_"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">//è¿™é‡Œä¹Ÿå°±æ˜¯</span>        <span class="token comment" spellcheck="true">// Normal runtime case - search intelligently for best engine</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token operator">-</span><span class="token operator">></span>native<span class="token punctuation">)</span> <span class="token punctuation">{</span>            engine <span class="token operator">=</span> d<span class="token operator">-</span><span class="token operator">></span>native<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">d_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">initPollerEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//è¿™é‡Œåˆå§‹åŒ–ï¼Œå¦åˆ™å°±èµ°ä¸Šè¾¹ä¸¤ä¸ªæ— æ³•ç›‘è§†æœåŠ¡å™¨çš„å®ç°</span>            engine <span class="token operator">=</span> d<span class="token operator">-</span><span class="token operator">></span>poller<span class="token punctuation">;</span>        <span class="token punctuation">}</span></code></pre><p>å‘ç°QFileSystemWatcherè®¾ç½®objectNameä¸º<em>qt_autotest_force_engine</em> å°±å¯ä»¥ä½¿ç”¨äº†ã€‚<br>ç„¶åæ¥ç€</p><pre class=" language-cpp"><code class="language-cpp">    QFileSystemWatcher<span class="token operator">*</span> fileSystemWatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QFileSystemWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    fileSystemWatcher<span class="token operator">-</span><span class="token operator">></span><span class="token function">setObjectName</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"_qt_autotest_force_engine_"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™æ ·å°±å¯ä»¥ç›‘è§†</p><pre class=" language-shell"><code class="language-shell">/run/user/1000/gvfs</code></pre><p>ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨æŒ‚è½½åˆ°Linuxæœ¬åœ°ä¸‹çš„æ–‡ä»¶å˜åŒ–äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
            <tag> Qtæºç å‰–æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QFileSystemWatcheræºç å‰–æ(Linux)</title>
      <link href="/2020/06/27/qfilesystemwatcher-yuan-ma-pou-xi-linux/"/>
      <url>/2020/06/27/qfilesystemwatcher-yuan-ma-pou-xi-linux/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>QFileSystemWatcherçš„ä½œç”¨æ˜¯ç›‘è§†æœ¬åœ°æ–‡ä»¶å¤¹çš„å˜åŒ–ä»¥åŠæ–‡ä»¶çš„å˜åŒ–ã€‚</p><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>QFileSystemWatcherçš„å®ç°ç±»æ˜¯QFileSystemWatcherPrivateã€‚ å…¶ä¸­QFileSystemWatcherPrivateä¸­çš„å…³é”®æˆå‘˜å˜é‡QFileSystemWatcherEngineç”¨äºç›‘è§†ç›®å½•ä»¥åŠæ–‡ä»¶çš„å˜åŒ–ï¼Œå‘é€ä¿¡å·ç»™QFileystemWatcherã€‚å…¶ä¸­QFileSystemWatcherEngineæ´¾ç”Ÿäº†ä¸‰ä¸ªç±»ã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">QFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QThread</code></pre><p>å…¶æ´¾ç”Ÿçš„å­ç±»ä¸‰ç§ç±»å‹åˆ†åˆ«ä¸º</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// è¿™ä¸ªç”¨äºç›‘æ§Dirçš„å˜åŒ–</span><span class="token keyword">class</span> <span class="token class-name">QDnotifyFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine<span class="token comment" spellcheck="true">// è¿™ä¸ªå¤–éƒ¨æ²¡æœ‰æš´éœ²å¯¹åº”çš„å˜åŒ–æ¥å£ï¼Œä½†æ˜¯æ£€æµ‹å…¶å®ƒç±»å‹çš„ç›®å½•å˜åŒ–æ—¶æˆ‘ä»¬ä¼šç”¨åˆ°</span><span class="token keyword">class</span> <span class="token class-name">QPollingFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine<span class="token comment" spellcheck="true">// è¿™ä¸ªç”¨äºæ£€æµ‹æ–‡ä»¶ç±»å‹çš„å˜åŒ–</span><span class="token keyword">class</span> <span class="token class-name">QInotifyFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine</code></pre><h2 id="QInotifyFileSystemWatcherEngine"><a href="#QInotifyFileSystemWatcherEngine" class="headerlink" title="QInotifyFileSystemWatcherEngine"></a>QInotifyFileSystemWatcherEngine</h2><p>QInotifyFileSystemWatcherEngineç”¨äºç›‘è§†æ–‡ä»¶çš„å˜åŒ–ã€‚</p><p>// å¤ªé•¿å¯ä»¥å¿½ç•¥ï¼Œè¿™æ˜¯è¯¦ç»†å®ç°</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//media/zhangpf/workspace1/Qt4.8.7/qt-everywhere-opensource-src-4.8.7/src/corelib/io/qfilesystemwatcher_inotify_p.h</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"qfilesystemwatcher_p.h"</span></span><span class="token macro property">#<span class="token directive keyword">ifndef</span> QT_NO_FILESYSTEMWATCHER</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;qhash.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;qmutex.h></span></span>QT_BEGIN_NAMESPACE<span class="token keyword">class</span> <span class="token class-name">QInotifyFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine<span class="token punctuation">{</span>    Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span>    <span class="token operator">~</span><span class="token function">QInotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> QInotifyFileSystemWatcherEngine <span class="token operator">*</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å•ä¾‹æ¨¡å¼</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList <span class="token function">addPaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList <span class="token function">removePaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> Q_SLOTS<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">readFromInotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token function">QInotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> inotifyFd<span class="token punctuation">;</span>    QMutex mutex<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> pathToID<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> QString<span class="token operator">></span> idToPath<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>QT_END_NAMESPACE<span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">// QT_NO_FILESYSTEMWATCHER</span><span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">// QFILESYSTEMWATCHER_INOTIFY_P_H</span><span class="token comment" spellcheck="true">// cpp</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/inotify.h></span></span><span class="token macro property">#<span class="token directive keyword">endif</span></span>QT_BEGIN_NAMESPACEQInotifyFileSystemWatcherEngine <span class="token operator">*</span>QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> IN_CLOEXEC</span>    fd <span class="token operator">=</span> <span class="token function">inotify_init1</span><span class="token punctuation">(</span>IN_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span></span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        fd <span class="token operator">=</span> <span class="token function">inotify_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_SETFD<span class="token punctuation">,</span> FD_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">QInotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">QInotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span>    <span class="token operator">:</span> <span class="token function">inotifyFd</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">fcntl</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> F_SETFD<span class="token punctuation">,</span> FD_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">moveToThread</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token operator">~</span><span class="token function">QInotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">foreach</span> <span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> pathToID<span class="token punctuation">)</span>        <span class="token function">inotify_rm_watch</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> id <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>id <span class="token operator">:</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">::</span><span class="token function">close</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QSocketNotifier <span class="token function">sn</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> QSocketNotifier<span class="token operator">::</span>Read<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//é€šè¿‡socketæ¥ç›‘è§†æ–‡ä»¶çš„å˜åŒ–ï¼Œæ›¿ä»£threadä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼</span>    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sn<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">activated</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">readFromInotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>QStringList QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">addPaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span>                                                      QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span>                                                      QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList p <span class="token operator">=</span> paths<span class="token punctuation">;</span>    QMutableListIterator<span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">it</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QString path <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QFileInfo <span class="token function">fi</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">bool</span> isDir <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">isDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isDir<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">contains</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token operator">-</span><span class="token operator">></span><span class="token function">contains</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> wd <span class="token operator">=</span> <span class="token function">inotify_add_watch</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span>                                   QFile<span class="token operator">::</span><span class="token function">encodeName</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>                                   <span class="token punctuation">(</span>isDir                                    <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">0</span>                                       <span class="token operator">|</span> IN_ATTRIB                                       <span class="token operator">|</span> IN_MOVE                                       <span class="token operator">|</span> IN_CREATE                                       <span class="token operator">|</span> IN_DELETE                                       <span class="token operator">|</span> IN_DELETE_SELF                                       <span class="token punctuation">)</span>                                    <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">0</span>                                       <span class="token operator">|</span> IN_ATTRIB                                       <span class="token operator">|</span> IN_MODIFY                                       <span class="token operator">|</span> IN_MOVE                                       <span class="token operator">|</span> IN_MOVE_SELF                                       <span class="token operator">|</span> IN_DELETE_SELF                                       <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>wd <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"QInotifyFileSystemWatcherEngine::addPaths: inotify_add_watch failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> id <span class="token operator">=</span> isDir <span class="token operator">?</span> <span class="token operator">-</span>wd <span class="token operator">:</span> wd<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            files<span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        pathToID<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>        idToPath<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span>QStringList QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">removePaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span>                                                         QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span>                                                         QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList p <span class="token operator">=</span> paths<span class="token punctuation">;</span>    QMutableListIterator<span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">it</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QString path <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> id <span class="token operator">=</span> pathToID<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        QString x <span class="token operator">=</span> idToPath<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> x <span class="token operator">!=</span> path<span class="token punctuation">)</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> wd <span class="token operator">=</span> id <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>id <span class="token operator">:</span> id<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// qDebug() &lt;&lt; "removing watch for path" &lt;&lt; path &lt;&lt; "wd" &lt;&lt; wd;</span>        <span class="token function">inotify_rm_watch</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> wd<span class="token punctuation">)</span><span class="token punctuation">;</span>        it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAll</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            files<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAll</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QInotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">readFromInotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ä¸»è¦æ˜¯é€šè¿‡unixåº“å‡½æ•°æ¥è·å–æ–‡ä»¶å¯¹åº”çš„è¯¦ç»†ä¿¡æ¯ã€‚å†è·Ÿaddpathå®ç°ä¸­ç¼“å­˜ä¸‹æ¥çš„ä¿¡æ¯åšå¯¹æ¯”ï¼Œæ¥æ£€æµ‹æ–‡ä»¶çš„å˜åŒ–ã€‚</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// qDebug() &lt;&lt; "QInotifyFileSystemWatcherEngine::readFromInotify";</span>    <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">ioctl</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> FIONREAD<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>buffSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    QVarLengthArray<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token operator">></span> <span class="token function">buffer</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    buffSize <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> buffer<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> buffSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>at <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span> end <span class="token operator">=</span> at <span class="token operator">+</span> buffSize<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> inotify_event <span class="token operator">*</span><span class="token operator">></span> eventForId<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>at <span class="token operator">&lt;</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>        inotify_event <span class="token operator">*</span>event <span class="token operator">=</span> <span class="token keyword">reinterpret_cast</span><span class="token operator">&lt;</span>inotify_event <span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>at<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>eventForId<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>event<span class="token operator">-</span><span class="token operator">></span>wd<span class="token punctuation">)</span><span class="token punctuation">)</span>            eventForId<span class="token punctuation">[</span>event<span class="token operator">-</span><span class="token operator">></span>wd<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>mask <span class="token operator">|</span><span class="token operator">=</span> event<span class="token operator">-</span><span class="token operator">></span>mask<span class="token punctuation">;</span>        <span class="token keyword">else</span>            eventForId<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>event<span class="token operator">-</span><span class="token operator">></span>wd<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>        at <span class="token operator">+</span><span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>inotify_event<span class="token punctuation">)</span> <span class="token operator">+</span> event<span class="token operator">-</span><span class="token operator">></span>len<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> inotify_event <span class="token operator">*</span><span class="token operator">></span><span class="token operator">::</span>const_iterator it <span class="token operator">=</span> eventForId<span class="token punctuation">.</span><span class="token function">constBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> eventForId<span class="token punctuation">.</span><span class="token function">constEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> inotify_event <span class="token operator">&amp;</span>event <span class="token operator">=</span> <span class="token operator">*</span><span class="token operator">*</span>it<span class="token punctuation">;</span>        <span class="token operator">++</span>it<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// qDebug() &lt;&lt; "inotify event, wd" &lt;&lt; event.wd &lt;&lt; "mask" &lt;&lt; hex &lt;&lt; event.mask;</span>        <span class="token keyword">int</span> id <span class="token operator">=</span> event<span class="token punctuation">.</span>wd<span class="token punctuation">;</span>        QString path <span class="token operator">=</span> idToPath<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// perhaps a directory?</span>            id <span class="token operator">=</span> <span class="token operator">-</span>id<span class="token punctuation">;</span>            path <span class="token operator">=</span> idToPath<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// qDebug() &lt;&lt; "event for path" &lt;&lt; path;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>mask <span class="token operator">&amp;</span> <span class="token punctuation">(</span>IN_DELETE_SELF <span class="token operator">|</span> IN_MOVE_SELF <span class="token operator">|</span> IN_UNMOUNT<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            pathToID<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            idToPath<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">inotify_rm_watch</span><span class="token punctuation">(</span>inotifyFd<span class="token punctuation">,</span> event<span class="token punctuation">.</span>wd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>                emit <span class="token function">directoryChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                emit <span class="token function">fileChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>                emit <span class="token function">directoryChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                emit <span class="token function">fileChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>QT_END_NAMESPACE<span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">// QT_NO_FILESYSTEMWATCHER</span></code></pre><p>è¿™æ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼Œé‡Œè¾¹çš„æ ¸å¿ƒä»£ç å…¶å®å°±æ˜¯è®²çš„æ˜¯Inotifyç›¸å…³çš„å‡½æ•°ã€‚å…¶ä¸­çš„å…³é”®çš„ç‚¹ï¼Œæˆ‘å·²ç»æ‰“ä¸Šå¤‡æ³¨ã€‚è¿™ä¸ªç±»ä¸­çš„ä¸»è¦å®ç°æ˜¯Linuxä¸‹çš„Inotifyçš„ä½¿ç”¨ç›¸å…³ã€‚</p><h2 id="Inotify"><a href="#Inotify" class="headerlink" title="Inotify"></a>Inotify</h2><p>Inotifyç®€å•çš„æ¥è®²æ˜¯åœ¨Linuxä¸‹ç›‘è§†æ–‡ä»¶ä¸æ–‡ä»¶å¤¹çš„ç›¸å…³æœºåˆ¶ï¼Œæœ¬æ¥æƒ³è‡ªå·±å†™è¿™ä¸€éƒ¨åˆ†æ•™ç¨‹çš„ï¼Œå¯æ˜¯æœ‰ä¸€ç¯‡æ–‡ç« å†™çš„å¤ªå¥½äº†ï¼Œå¿ä¸ä½ç»™å¤§å®¶åˆ†äº«äº†ã€‚<br><a href="https://www.ibm.com/developerworks/cn/linux/l-inotify/" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/l-inotify/</a> çœ‹å®Œè¿™ä¸€ç¯‡æ–‡ç« ä¹‹åæˆ‘è§‰å¾—ä½ å¯¹Linuxä¸‹å¦‚ä½•ç›‘è§†æ–‡ä»¶åº”è¯¥æœ‰äº†è§£äº†ï¼Œç”šè‡³å¯ä»¥è‡ªå·±å°è£…ä¸€ä¸ªç±»ç»™å¤§å®¶ç”¨ã€‚</p><h1 id="æ–‡ä»¶å¤¹çš„æ£€æµ‹å˜åŒ–å®ç°ç±»-QDnotifyFileSystemWatcherEngine"><a href="#æ–‡ä»¶å¤¹çš„æ£€æµ‹å˜åŒ–å®ç°ç±»-QDnotifyFileSystemWatcherEngine" class="headerlink" title="æ–‡ä»¶å¤¹çš„æ£€æµ‹å˜åŒ–å®ç°ç±» QDnotifyFileSystemWatcherEngine"></a>æ–‡ä»¶å¤¹çš„æ£€æµ‹å˜åŒ–å®ç°ç±» QDnotifyFileSystemWatcherEngine</h1><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">QDnotifyFileSystemWatcherEngine</span> <span class="token operator">:</span> <span class="token keyword">public</span> QFileSystemWatcherEngine<span class="token punctuation">{</span>    Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">QDnotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> QDnotifyFileSystemWatcherEngine <span class="token operator">*</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList <span class="token function">addPaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList <span class="token function">removePaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> Q_SLOTS<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token comment" spellcheck="true">//è¿™ä¸ªç»“æ„ä½“æ¯”è¾ƒå…³é”®</span>    <span class="token keyword">struct</span> Directory <span class="token punctuation">{</span>        <span class="token function">Directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">fd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">parentFd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isMonitored</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token function">Directory</span><span class="token punctuation">(</span><span class="token keyword">const</span> Directory <span class="token operator">&amp;</span>o<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">path</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">fd</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">parentFd</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>parentFd<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">isMonitored</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>isMonitored<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">files</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        QString path<span class="token punctuation">;</span>        <span class="token keyword">int</span> fd<span class="token punctuation">;</span>        <span class="token keyword">int</span> parentFd<span class="token punctuation">;</span>        <span class="token keyword">bool</span> isMonitored<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//è¿™ä¸ªç»“æ„ä½“ä¹Ÿæ¯”è¾ƒå…³é”®</span>        <span class="token keyword">struct</span> File <span class="token punctuation">{</span>            <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ownerId</span><span class="token punctuation">(</span><span class="token number">0u</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">groupId</span><span class="token punctuation">(</span><span class="token number">0u</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">permissions</span><span class="token punctuation">(</span><span class="token number">0u</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>            <span class="token function">File</span><span class="token punctuation">(</span><span class="token keyword">const</span> File <span class="token operator">&amp;</span>o<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">path</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">ownerId</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>ownerId<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">groupId</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>groupId<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">permissions</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>permissions<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">lastWrite</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>lastWrite<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>            QString path<span class="token punctuation">;</span>            <span class="token keyword">bool</span> <span class="token function">updateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            uint ownerId<span class="token punctuation">;</span>            uint groupId<span class="token punctuation">;</span>            QFile<span class="token operator">::</span>Permissions permissions<span class="token punctuation">;</span>            QDateTime lastWrite<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        QList<span class="token operator">&lt;</span>File<span class="token operator">></span> files<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">QDnotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QMutex mutex<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span>QString<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> pathToFD<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Directory<span class="token operator">></span> fdToDirectory<span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> parentToFD<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//cpp</span>QDnotifySignalThread<span class="token operator">::</span><span class="token function">QDnotifySignalThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">isExecing</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">moveToThread</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">qt_safe_pipe</span><span class="token punctuation">(</span>qfswd_fileChanged_pipe<span class="token punctuation">,</span> O_NONBLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">struct</span> sigaction oldAction<span class="token punctuation">;</span>    <span class="token keyword">struct</span> sigaction action<span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>action<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    action<span class="token punctuation">.</span>sa_sigaction <span class="token operator">=</span> qfswd_sigio_monitor<span class="token punctuation">;</span>    action<span class="token punctuation">.</span>sa_flags <span class="token operator">=</span> SA_SIGINFO<span class="token punctuation">;</span>    <span class="token operator">::</span><span class="token function">sigaction</span><span class="token punctuation">(</span>SIGIO<span class="token punctuation">,</span> <span class="token operator">&amp;</span>action<span class="token punctuation">,</span> <span class="token operator">&amp;</span>oldAction<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>oldAction<span class="token punctuation">.</span>sa_flags <span class="token operator">&amp;</span> SA_SIGINFO<span class="token punctuation">)</span><span class="token punctuation">)</span>        qfswd_old_sigio_handler <span class="token operator">=</span> oldAction<span class="token punctuation">.</span>sa_handler<span class="token punctuation">;</span>    <span class="token keyword">else</span>        qfswd_old_sigio_action <span class="token operator">=</span> oldAction<span class="token punctuation">.</span>sa_sigaction<span class="token punctuation">;</span><span class="token punctuation">}</span>QDnotifySignalThread<span class="token operator">::</span><span class="token operator">~</span><span class="token function">QDnotifySignalThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QThread<span class="token operator">::</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">bool</span> QDnotifySignalThread<span class="token operator">::</span><span class="token function">event</span><span class="token punctuation">(</span>QEvent <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token operator">-</span><span class="token operator">></span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QEvent<span class="token operator">::</span>User<span class="token punctuation">)</span> <span class="token punctuation">{</span>        QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>        isExecing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        wait<span class="token punctuation">.</span><span class="token function">wakeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> QThread<span class="token operator">::</span><span class="token function">event</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> QDnotifySignalThread<span class="token operator">::</span><span class="token function">startNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// Note: All this fancy waiting for the thread to enter its event</span>    <span class="token comment" spellcheck="true">// loop is to avoid nasty messages at app shutdown when the</span>    <span class="token comment" spellcheck="true">// QDnotifySignalThread singleton is deleted</span>    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>isExecing<span class="token punctuation">)</span>        wait<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    mutex<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QDnotifySignalThread<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QSocketNotifier <span class="token function">sn</span><span class="token punctuation">(</span>qfswd_fileChanged_pipe<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> QSocketNotifier<span class="token operator">::</span>Read<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sn<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">activated</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">readFromDnotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QCoreApplication<span class="token operator">::</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">postEvent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QEvent</span><span class="token punctuation">(</span>QEvent<span class="token operator">::</span>User<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QDnotifySignalThread<span class="token operator">::</span><span class="token function">readFromDnotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>    <span class="token keyword">int</span> readrv <span class="token operator">=</span> <span class="token function">qt_safe_read</span><span class="token punctuation">(</span>qfswd_fileChanged_pipe<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">reinterpret_cast</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Only expect EAGAIN or EINTR. Other errors are assumed to be impossible.</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>readrv <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">Q_ASSERT</span><span class="token punctuation">(</span>readrv <span class="token operator">==</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Q_UNUSED</span><span class="token punctuation">(</span>readrv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> fd<span class="token punctuation">)</span>            <span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            emit <span class="token function">fdChanged</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">QDnotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QObject<span class="token operator">::</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token function">dnotifySignal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">fdChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                     <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token operator">::</span>DirectConnection<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token operator">~</span><span class="token function">QDnotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Directory<span class="token operator">></span><span class="token operator">::</span>ConstIterator iter <span class="token operator">=</span> fdToDirectory<span class="token punctuation">.</span><span class="token function">constBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            iter <span class="token operator">!=</span> fdToDirectory<span class="token punctuation">.</span><span class="token function">constEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">++</span>iter<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">qt_safe_close</span><span class="token punctuation">(</span>iter<span class="token operator">-</span><span class="token operator">></span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>iter<span class="token operator">-</span><span class="token operator">></span>parentFd<span class="token punctuation">)</span>            <span class="token function">qt_safe_close</span><span class="token punctuation">(</span>iter<span class="token operator">-</span><span class="token operator">></span>parentFd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>QDnotifyFileSystemWatcherEngine <span class="token operator">*</span>QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">QDnotifyFileSystemWatcherEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">qFatal</span><span class="token punctuation">(</span><span class="token string">"QDnotifyFileSystemWatcherEngine thread should not be run"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>QStringList QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">addPaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList p <span class="token operator">=</span> paths<span class="token punctuation">;</span>    QMutableListIterator<span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">it</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QString path <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QFileInfo <span class="token function">fi</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fi<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">bool</span> isDir <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">isDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isDir <span class="token operator">&amp;&amp;</span> directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">contains</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Skip monitored directories</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDir <span class="token operator">&amp;&amp;</span> files<span class="token operator">-</span><span class="token operator">></span><span class="token function">contains</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Skip monitored files</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDir<span class="token punctuation">)</span>            path <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">canonicalPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Locate the directory entry (creating if needed)</span>        <span class="token keyword">int</span> fd <span class="token operator">=</span> pathToFD<span class="token punctuation">[</span>path<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            QT_DIR <span class="token operator">*</span>d <span class="token operator">=</span> <span class="token function">QT_OPENDIR</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">constData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>d<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Could not open directory</span>            QT_DIR <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            QDir <span class="token function">parentDir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parentDir<span class="token punctuation">.</span><span class="token function">isRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                parentDir<span class="token punctuation">.</span><span class="token function">cdUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                parent <span class="token operator">=</span> <span class="token function">QT_OPENDIR</span><span class="token punctuation">(</span>parentDir<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">constData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">QT_CLOSEDIR</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            fd <span class="token operator">=</span> <span class="token function">qt_safe_dup</span><span class="token punctuation">(</span><span class="token operator">::</span><span class="token function">dirfd</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> parentFd <span class="token operator">=</span> parent <span class="token operator">?</span> <span class="token function">qt_safe_dup</span><span class="token punctuation">(</span><span class="token operator">::</span><span class="token function">dirfd</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token function">QT_CLOSEDIR</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token function">QT_CLOSEDIR</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">Q_ASSERT</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_SETSIG<span class="token punctuation">,</span> SIGIO<span class="token punctuation">)</span> <span class="token operator">||</span>               <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_NOTIFY<span class="token punctuation">,</span> DN_MODIFY <span class="token operator">|</span> DN_CREATE <span class="token operator">|</span> DN_DELETE <span class="token operator">|</span>                                     DN_RENAME <span class="token operator">|</span> DN_ATTRIB <span class="token operator">|</span> DN_MULTISHOT<span class="token punctuation">)</span> <span class="token operator">||</span>               <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>parentFd<span class="token punctuation">,</span> F_SETSIG<span class="token punctuation">,</span> SIGIO<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>               <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>parentFd<span class="token punctuation">,</span> F_NOTIFY<span class="token punctuation">,</span> DN_DELETE <span class="token operator">|</span> DN_RENAME <span class="token operator">|</span>                                            DN_MULTISHOT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Could not set appropriate flags</span>            <span class="token punctuation">}</span>            Directory dir<span class="token punctuation">;</span>            dir<span class="token punctuation">.</span>path <span class="token operator">=</span> path<span class="token punctuation">;</span>            dir<span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">;</span>            dir<span class="token punctuation">.</span>parentFd <span class="token operator">=</span> parentFd<span class="token punctuation">;</span>            fdToDirectory<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>            pathToFD<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>parentFd<span class="token punctuation">)</span>                parentToFD<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>parentFd<span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        Directory <span class="token operator">&amp;</span>directory <span class="token operator">=</span> fdToDirectory<span class="token punctuation">[</span>fd<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isDir<span class="token punctuation">)</span> <span class="token punctuation">{</span>            directory<span class="token punctuation">.</span>isMonitored <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            Directory<span class="token operator">::</span>File file<span class="token punctuation">;</span>            file<span class="token punctuation">.</span>path <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">filePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            file<span class="token punctuation">.</span>lastWrite <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>            pathToFD<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>fi<span class="token punctuation">.</span><span class="token function">filePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isDir<span class="token punctuation">)</span> <span class="token punctuation">{</span>            directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            files<span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span>fi<span class="token punctuation">.</span><span class="token function">filePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">dnotifySignal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">startNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span>QStringList QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">removePaths</span><span class="token punctuation">(</span><span class="token keyword">const</span> QStringList <span class="token operator">&amp;</span>paths<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>files<span class="token punctuation">,</span> QStringList <span class="token operator">*</span>directories<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    QStringList p <span class="token operator">=</span> paths<span class="token punctuation">;</span>    QMutableListIterator<span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">it</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QString path <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> fd <span class="token operator">=</span> pathToFD<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fd<span class="token punctuation">)</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        Directory <span class="token operator">&amp;</span>directory <span class="token operator">=</span> fdToDirectory<span class="token punctuation">[</span>fd<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">bool</span> isDir <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>path <span class="token operator">==</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>            isDir <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            directory<span class="token punctuation">.</span>isMonitored <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ii <span class="token operator">&lt;</span> directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>ii<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">.</span>path <span class="token operator">==</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>directory<span class="token punctuation">.</span>isMonitored <span class="token operator">&amp;&amp;</span> directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// No longer needed</span>            <span class="token function">qt_safe_close</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>            pathToFD<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            fdToDirectory<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isDir<span class="token punctuation">)</span> <span class="token punctuation">{</span>            directories<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAll</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            files<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAll</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">{</span>    QMutexLocker <span class="token function">locker</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> wasParent <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Directory<span class="token operator">></span><span class="token operator">::</span>Iterator iter <span class="token operator">=</span> fdToDirectory<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>iter <span class="token operator">==</span> fdToDirectory<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>Iterator pIter <span class="token operator">=</span> parentToFD<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>pIter <span class="token operator">==</span> parentToFD<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        iter <span class="token operator">=</span> fdToDirectory<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token operator">*</span>pIter<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>iter <span class="token operator">==</span> fdToDirectory<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        wasParent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    Directory <span class="token operator">&amp;</span>directory <span class="token operator">=</span> <span class="token operator">*</span>iter<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>wasParent<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ii <span class="token operator">&lt;</span> directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>ii<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Directory<span class="token operator">::</span>File <span class="token operator">&amp;</span>file <span class="token operator">=</span> directory<span class="token punctuation">.</span>files<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">updateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// Emit signal</span>                QString filePath <span class="token operator">=</span> file<span class="token punctuation">.</span>path<span class="token punctuation">;</span>                <span class="token keyword">bool</span> removed <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">QFileInfo</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token operator">--</span>ii<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                emit <span class="token function">fileChanged</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> removed<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>isMonitored<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// Emit signal</span>        <span class="token keyword">bool</span> removed <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">QFileInfo</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        QString path <span class="token operator">=</span> directory<span class="token punctuation">.</span>path<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span>            directory<span class="token punctuation">.</span>isMonitored <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        emit <span class="token function">directoryChanged</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> removed<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>directory<span class="token punctuation">.</span>isMonitored <span class="token operator">&amp;&amp;</span> directory<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">qt_safe_close</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>parentFd<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">qt_safe_close</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>parentFd<span class="token punctuation">)</span><span class="token punctuation">;</span>            parentToFD<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>directory<span class="token punctuation">.</span>parentFd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        fdToDirectory<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>iter<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> QDnotifyFileSystemWatcherEngine<span class="token operator">::</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">bool</span> QDnotifyFileSystemWatcherEngine<span class="token operator">::</span>Directory<span class="token operator">::</span>File<span class="token operator">::</span><span class="token function">updateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QFileInfo <span class="token function">fi</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>    QDateTime nLastWrite <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    uint nOwnerId <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">ownerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    uint nGroupId <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">groupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QFile<span class="token operator">::</span>Permissions nPermissions <span class="token operator">=</span> fi<span class="token punctuation">.</span><span class="token function">permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>nLastWrite <span class="token operator">!=</span> lastWrite <span class="token operator">||</span>       nOwnerId <span class="token operator">!=</span> ownerId <span class="token operator">||</span>       nGroupId <span class="token operator">!=</span> groupId <span class="token operator">||</span>       nPermissions <span class="token operator">!=</span> permissions<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ownerId <span class="token operator">=</span> nOwnerId<span class="token punctuation">;</span>        groupId <span class="token operator">=</span> nGroupId<span class="token punctuation">;</span>        permissions <span class="token operator">=</span> nPermissions<span class="token punctuation">;</span>        lastWrite <span class="token operator">=</span> nLastWrite<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="Dnotify"><a href="#Dnotify" class="headerlink" title="Dnotify"></a>Dnotify</h2><p>DnotifyåŒç†ï¼Œä¹Ÿæ˜¯ä½¿ç”¨çš„Linuxçš„ç³»ç»Ÿå‡½æ•° /usr/include/unistd.h  ä¸»è¦æ˜¯è¿™ä¸ªå¤´æ–‡ä»¶ä¸­çš„å‡½æ•°ã€‚æœ‰ä¸€äº›å…³äºæ–‡ä»¶æè¿°ç¬¦ç›¸å…³çš„å‡½æ•°</p><p>é‡Œè¾¹ä¸»è¦ç›‘æ§çš„æ˜¯å…¶å†…éƒ¨ç±»çš„ç›¸å…³çš„ä¿¡æ¯</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token keyword">struct</span> Directory <span class="token punctuation">{</span>        <span class="token function">Directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">fd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">parentFd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isMonitored</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token function">Directory</span><span class="token punctuation">(</span><span class="token keyword">const</span> Directory <span class="token operator">&amp;</span>o<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">path</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">fd</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">parentFd</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>parentFd<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">isMonitored</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>isMonitored<span class="token punctuation">)</span><span class="token punctuation">,</span>                                        <span class="token function">files</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        QString path<span class="token punctuation">;</span>        <span class="token keyword">int</span> fd<span class="token punctuation">;</span>        <span class="token keyword">int</span> parentFd<span class="token punctuation">;</span>        <span class="token keyword">bool</span> isMonitored<span class="token punctuation">;</span>        <span class="token keyword">struct</span> File <span class="token punctuation">{</span>            <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ownerId</span><span class="token punctuation">(</span><span class="token number">0u</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">groupId</span><span class="token punctuation">(</span><span class="token number">0u</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">permissions</span><span class="token punctuation">(</span><span class="token number">0u</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>            <span class="token function">File</span><span class="token punctuation">(</span><span class="token keyword">const</span> File <span class="token operator">&amp;</span>o<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">path</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">ownerId</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>ownerId<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">groupId</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>groupId<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">permissions</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>permissions<span class="token punctuation">)</span><span class="token punctuation">,</span>                                  <span class="token function">lastWrite</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>lastWrite<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>            QString path<span class="token punctuation">;</span>            <span class="token keyword">bool</span> <span class="token function">updateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            uint ownerId<span class="token punctuation">;</span>            uint groupId<span class="token punctuation">;</span>            QFile<span class="token operator">::</span>Permissions permissions<span class="token punctuation">;</span>            QDateTime lastWrite<span class="token punctuation">;</span></code></pre><p>å¯ä»¥ç›´æ¥çœ‹è¿™ä¸ªç»“æ„Déœ€è¦è¿™å››ä¸ªæè¿°ä¿¡æ¯</p><pre class=" language-cpp"><code class="language-cpp">        QString path<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//è·¯å¾„</span>        <span class="token keyword">int</span> fd<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//æ–‡ä»¶çš„æè¿°ç¬¦</span>        <span class="token keyword">int</span> parentFd<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//çˆ¶äº²çš„æè¿°ç¬¦å·</span>        <span class="token keyword">bool</span> isMonitored<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ˜¯å¦æ­£åœ¨ç›‘æ§</span></code></pre><p>å…¶ä¸­è¿™å››ä¸ªä¿¡æ¯éƒ½æ˜¯é€šè¿‡<em>Linuxçš„åº“å‡½æ•°</em>ä¸ç»“æ„ä½“æ¥è·å–çš„ã€‚ å…¶ä¸­éå†æ–‡ä»¶å¤¹åˆ™æ˜¯ä½¿ç”¨Qtçš„QFileInfoæ¥éå†æ·»åŠ pathsçš„ä¿¡æ¯ï¼Œå­˜å‚¨åˆ°å…¶ç±»çš„æˆå‘˜å˜é‡ä¸­ã€‚</p><pre><code>// Directory iteration#define QT_DIR DIR#define QT_OPENDIR ::opendir#define QT_CLOSEDIR ::closedir</code></pre><p>Dirä¸‹çš„fileéœ€è¦è¿™äº›ä¿¡æ¯</p><pre class=" language-cpp"><code class="language-cpp">            QString path<span class="token punctuation">;</span>            uint ownerId<span class="token punctuation">;</span>            uint groupId<span class="token punctuation">;</span>            QFile<span class="token operator">::</span>Permissions permissions<span class="token punctuation">;</span>            QDateTime lastWrite<span class="token punctuation">;</span></code></pre><p>ç°åœ¨è¯´ä¸€ä¸‹å…³é”®ä»£ç </p><pre class=" language-cpp"><code class="language-cpp">    ret <span class="token operator">=</span> <span class="token operator">::</span><span class="token function">pipe</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F_SETFD<span class="token punctuation">,</span> FD_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F_SETFD<span class="token punctuation">,</span> FD_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// set non-block too?</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> O_NONBLOCK<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F_SETFL<span class="token punctuation">,</span> <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F_GETFL<span class="token punctuation">)</span> <span class="token operator">|</span> O_NONBLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F_SETFL<span class="token punctuation">,</span> <span class="token operator">::</span><span class="token function">fcntl</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F_GETFL<span class="token punctuation">)</span> <span class="token operator">|</span> O_NONBLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>å…¶ä¸­ pipefd[0]è¡¨ç¤ºè¯»ï¼Œpipefd[1]è¡¨ç¤ºå†™ï¼Œå®é™…ä¸Š<br>å…³é”®ä»£ç åœ¨è¿™é‡Œã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">void</span> QDnotifySignalThread<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QSocketNotifier <span class="token function">sn</span><span class="token punctuation">(</span>qfswd_fileChanged_pipe<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> QSocketNotifier<span class="token operator">::</span>Read<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sn<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">activated</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">readFromDnotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QCoreApplication<span class="token operator">::</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">postEvent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QEvent</span><span class="token punctuation">(</span>QEvent<span class="token operator">::</span>User<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™æ®µä»£ç å®é™…ä¸Šæ˜¯ä½¿ç”¨QSocketNotifierå®æ—¶æ£€æµ‹å‡ºä»pipç®¡é“ä¸­è¯»å–æœ‰å…³äºæ–‡ä»¶ä¿¡æ¯çš„å˜åŒ–ï¼ŒåŠ åˆ°äº†Qtåœ¨Linuxä¸‹çš„äº‹ä»¶å¾ªç¯ä¸­ï¼ˆè¿˜è®°ä¸Šä»¥å‰æœ‰ä¸ªè€å“¥å†™çš„é‚£ä¸ªuç›˜æ£€æµ‹å·¥å…·ä¹ˆï¼Ÿå®é™…ä¸ŠåŸç†è·Ÿè¿™ä¸ªä¸€æ ·ï¼Œéƒ½æ˜¯é€šè¿‡socketæ¥è¯»å–æ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€æ¥æ£€æµ‹å…¶å˜åŒ–ï¼‰ã€‚ç„¶åç­‰å¾…å…¶æ¶ˆæ¯é€šçŸ¥å˜åŒ–ã€‚è¿™æ ·æ¥å®æ—¶ç›‘æ§æ–‡ä»¶å¤¹ä¸æ–‡ä»¶çš„å˜åŒ–ã€‚å…¶ä¸­QDnotifyå¤§é‡ä½¿ç”¨äº†Unixçš„åº“å‡½æ•°ï¼Œå»ºè®®æœ‰å…´è¶£çš„å¯ä»¥å¤šè¯»è¯»Unixé«˜çº§ç¯å¢ƒç¼–ç¨‹è¿™æœ¬ä¹¦ï¼Œå¯ä»¥å½“ä¸ªå­—å…¸æ¥çœ‹ã€‚æˆ‘ä¹Ÿä¸ä¸€ä¸ªä¸ªè§£é‡Šäº†ã€‚å®é™…ä¸Šè¿™ä¸ªç±»ï¼Œæˆ‘è¯»èµ·æ¥ä¹Ÿæ˜¯æœ‰ç‚¹åƒåŠ›ï¼Œå› ä¸ºå¤§éƒ¨åˆ†éƒ½æ˜¯Linuxçš„åº“å‡½æ•°ï¼Œè¿˜æ˜¯å¾—è¡¥è¡¥è¯¾å»çœ‹çœ‹ã€ŠUnixç¯å¢ƒé«˜çº§ç¼–ç¨‹ã€‹äº†</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™ä¸¤ä¸ªç±»çš„ä¸»è¦åŸç†æ˜¯å…ˆç¼“å­˜å½“å‰addpathçš„æ–‡ä»¶oræ–‡ä»¶å¤¹çš„ä¿¡æ¯ï¼Œç„¶åå†é€šè¿‡socketæ¥å®æ—¶æ£€æµ‹å…¶å˜åŒ–ã€‚è·å–å½“å‰çš„ä¿¡æ¯ä¸ç¼“å­˜çš„ä¿¡æ¯åšå¯¹æ¯”ï¼Œå¦‚æœæœ‰å˜åŒ–ï¼Œå°±å‘é€å¯¹åº”çš„ä¿¡å·ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ£€æµ‹åˆ°æ–‡ä»¶oræ–‡ä»¶å¤¹çš„å˜åŒ–äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
            <tag> Qtæºç å‰–æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtæºç ä¹‹é­”æ”¹QFileDialogä¹‹è·¯-2 ç§»åŠ¨ä»‹è´¨çš„å¤„ç†</title>
      <link href="/2020/06/26/qt-yuan-ma-zhi-mo-gai-qfiledialog-zhi-lu-2-yi-dong-jie-zhi-de-chu-li/"/>
      <url>/2020/06/26/qt-yuan-ma-zhi-mo-gai-qfiledialog-zhi-lu-2-yi-dong-jie-zhi-de-chu-li/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç§»åŠ¨ä»‹è´¨ï¼Œä¸€èˆ¬å°±æ˜¯æŒ‡å½“å‰Linuxç³»ç»Ÿä¸‹çš„ <strong>U ç›˜ / æŒ‚è½½ç¡¬ç›˜</strong>ã€‚ è¿™ä¸¤ä¸ªç§»åŠ¨ä»‹è´¨éƒ½æ˜¯æŒ‚è½½åœ¨<strong>/media/yourusername</strong>ä¸‹æ¥åšçš„å¤„ç†ã€‚ï¼ˆfhs2.4ï¼‰ï¼ˆå®é™…ä¸Šfhs3.0çš„æ ‡å‡†å·²ç»æ”¹åˆ°/run/media/usernameä¸‹äº†ï¼‰</p><h2 id="å‰æœŸè°ƒç ”"><a href="#å‰æœŸè°ƒç ”" class="headerlink" title="å‰æœŸè°ƒç ”"></a>å‰æœŸè°ƒç ”</h2><p>ä»ç½‘ä¸Šæ‰¾åˆ°å…³äºuç›˜æ£€æµ‹çš„æ’æ‹”æœ‰ä¸¤ç§æ–¹æ¡ˆï¼ˆè¿™ä¸¤ç§æ–¹æ¡ˆç¡¬ç›˜æŒ‚è½½æ˜¯æ£€æµ‹ä¸åˆ°çš„ï¼‰ï¼š</p><h3 id="Uç›˜æ’æ‹”æ£€æµ‹"><a href="#Uç›˜æ’æ‹”æ£€æµ‹" class="headerlink" title="Uç›˜æ’æ‹”æ£€æµ‹"></a>Uç›˜æ’æ‹”æ£€æµ‹</h3><h4 id="QDbusçš„æ–¹æ¡ˆ"><a href="#QDbusçš„æ–¹æ¡ˆ" class="headerlink" title="QDbusçš„æ–¹æ¡ˆ"></a>QDbusçš„æ–¹æ¡ˆ</h4><blockquote><ul><li>ä½¿ç”¨QDbusæ¥æ£€æµ‹Uç›˜çš„æ’æ‹”çš„å¤„ç†ï¼ŒåŸæ–‡é“¾æ¥ <a href="http://www.qtcn.org/bbs/read-htm-tid-14535.html" target="_blank" rel="noopener">http://www.qtcn.org/bbs/read-htm-tid-14535.html</a></li></ul></blockquote><p>é˜²æ­¢ç½‘å€è¢«åè¿™é‡ŒæŠŠä»£ç ä¸Šä¸Š</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//åœ¨proæ–‡ä»¶ä¸­åº”è¯¥åŠ å…¥</span>QT <span class="token operator">+</span><span class="token operator">=</span>dbus<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QtDBus/QDBusConnection></span></span><span class="token comment" spellcheck="true">//ä»¥ä¸‹ä¸ºæ£€æµ‹è®¾å¤‡çš„æ’å…¥</span>QDBusConnection<span class="token operator">::</span><span class="token function">systemBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span> <span class="token string">"org.freedesktop.Hal"</span><span class="token punctuation">,</span>                        <span class="token string">"/org/freedesktop/Hal/Manager"</span><span class="token punctuation">,</span>                        <span class="token string">"org.freedesktop.Hal.Manager"</span><span class="token punctuation">,</span>                        <span class="token string">"DeviceAdded"</span><span class="token punctuation">,</span>                        <span class="token keyword">this</span><span class="token punctuation">,</span>                        <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">slotDeviceAdded</span><span class="token punctuation">(</span>QString <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä»¥ä¸‹ä¸ºæ£€æŸ¥è®¾å¤‡çš„æ‹¨å‡º</span>QDBusConnection<span class="token operator">::</span><span class="token function">systemBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span> <span class="token string">"org.freedesktop.Hal"</span><span class="token punctuation">,</span>                        <span class="token string">"/org/freedesktop/Hal/Manager"</span><span class="token punctuation">,</span>                        <span class="token string">"org.freedesktop.Hal.Manager"</span><span class="token punctuation">,</span>                        <span class="token string">"DeviceRemoved"</span><span class="token punctuation">,</span>                        <span class="token keyword">this</span><span class="token punctuation">,</span>                        <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">slotDeviceRemoved</span><span class="token punctuation">(</span>QString <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨slotDeviceAdded(QString udi)å‡½æ•°ä¸­ï¼Œè¦ä½¿ç”¨åˆ°</span>QDBusInterface <span class="token function">device</span><span class="token punctuation">(</span><span class="token string">"org.freedesktop.Hal"</span><span class="token punctuation">,</span> udi<span class="token punctuation">,</span> <span class="token string">"org.freedesktop.Hal.Device"</span> <span class="token punctuation">,</span> QDBusConnection<span class="token operator">::</span><span class="token function">systemBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//é€šè¿‡HALå¯ä»¥æŸ¥è¯¢åˆ°è®¾å¤‡ä¸ºvolumeçš„è®¾å¤‡ï¼Œç„¶åé€šè¿‡åˆ¤æ–­æ˜¯å¦ä¸º/dev/sd*çš„è®¾å¤‡ï¼Œå°±å¯ä»¥åˆ¤æ–­å‡ºæ˜¯å¦ä¸ºUç›˜ï¼Œç„¶åè°ƒç”¨mountå°±å¯ä»¥äº†ã€‚</span><span class="token comment" spellcheck="true">//è¿™æ—¶è®°å½•ä¸‹Uç›˜çš„UDIï¼Œåœ¨æ£€æµ‹åˆ°è®¾å¤‡æ‹¨å‡ºæ—¶ï¼Œå†æŸ¥è¯¢ä¸€ä¸‹Uç›˜çš„UDIæ˜¯å¦è¿˜åœ¨ï¼Œå°±çŸ¥é“Uç›˜æ˜¯å¦è¢«æ‹¨å‡ºäº†ã€‚</span></code></pre><h4 id="QSocketNotifieræ¥å®ç°"><a href="#QSocketNotifieræ¥å®ç°" class="headerlink" title="QSocketNotifieræ¥å®ç°"></a>QSocketNotifieræ¥å®ç°</h4><p>è¿™ä¸ªæ˜¯æŸä¸ªè€å“¥ä½¿ç”¨socketæ¥å®ç°æ–‡ä»¶ç›‘æ§çš„ï¼Œå®é™…ä¸Šè¿™ä¸ªæ–¹æ¡ˆå®Œå…¨å¯ä»¥ä½¿ç”¨QFileSystemWatcheræ¥æ£€æµ‹<strong>/proc/mounts</strong>ï¼ˆå®é™…ä¸ŠQtæºç QSystemWatcherï¼Œé‡Œè¾¹çš„ç›‘æ§æ–‡ä»¶çš„å®ç°å°±æ˜¯ä½¿ç”¨çš„QSocketNotifier=ã€‚=ï¼Œæ—¢ç„¶è¿™ä¸ªè€å“¥è‡ªå·±æƒ³å‡ºæ¥äº†ï¼Œè¿˜æ˜¯æŠŠä»–çš„é“¾æ¥è´´ä¸Šå»å§ï¼Œ<a href="https://blog.csdn.net/penghuilater/article/details/53410646" target="_blank" rel="noopener">https://blog.csdn.net/penghuilater/article/details/53410646</a> æ¥ä¸‹æ¥æˆ‘ä¼šè®²QFileSystemWatcherçš„å®ç°åŸç†çš„ï¼‰ï¼Œä»£ç æˆ‘è¿˜æ˜¯ç…§æ ·è´´ä¸Šï¼Œé˜²æ­¢ç½‘é¡µè¢«åã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">ifndef</span> VOLUMEMONITOR_H</span><span class="token macro property">#<span class="token directive keyword">define</span> VOLUMEMONITOR_H</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QObject></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QSet></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QSocketNotifier></span></span><span class="token keyword">class</span> <span class="token class-name">VolumeMonitor</span> <span class="token operator">:</span> <span class="token keyword">public</span> QObject<span class="token punctuation">{</span>    Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">VolumeMonitor</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">VolumeMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>signals<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">deviceAdded</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> addDev<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">deviceRemoved</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> removeDe<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> slots<span class="token operator">:</span>    <span class="token keyword">bool</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">onFileChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">int</span> m_fileKde <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    QSocketNotifier<span class="token operator">*</span> m_socketNotifier<span class="token punctuation">;</span>    QSet<span class="token operator">&lt;</span>QString<span class="token operator">></span> m_fileContentSet<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">// VOLUMEMONITOR_H </span><span class="token comment" spellcheck="true">//-------------------------------------------------------</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"volumemonitor.h"</span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QFile></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QSet></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QTextStream></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;QDebug></span></span><span class="token keyword">namespace</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> mountFile<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/proc/mounts"</span><span class="token punctuation">;</span>    QSet <span class="token operator">&lt;</span>QString<span class="token operator">></span> <span class="token function">getMountFileContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        QFile <span class="token function">file</span><span class="token punctuation">(</span>mountFile<span class="token punctuation">)</span><span class="token punctuation">;</span>        QSet <span class="token operator">&lt;</span>QString<span class="token operator">></span> fileContentSet<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>QIODevice<span class="token operator">::</span>ReadOnly <span class="token operator">|</span> QIODevice<span class="token operator">::</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                QTextStream <span class="token function">textStream</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>                QString fileContent <span class="token operator">=</span> textStream<span class="token punctuation">.</span><span class="token function">readAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                QStringList items <span class="token operator">=</span> fileContent<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">foreach</span> <span class="token punctuation">(</span>QString item<span class="token punctuation">,</span> items<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        fileContentSet <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> fileContentSet<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    QString <span class="token function">getMountPoint</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> record<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> QStringList items <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>items<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> items<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>VolumeMonitor<span class="token operator">::</span><span class="token function">VolumeMonitor</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent<span class="token punctuation">)</span>    <span class="token operator">:</span> <span class="token function">QObject</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">bool</span> VolumeMonitor<span class="token operator">::</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//get the set of mounted device's info;</span>    m_fileContentSet <span class="token operator">=</span> <span class="token function">getMountFileContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    m_fileKde <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>mountFile<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_fileKde <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">qWarning</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"open /proc/mounts failed!"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    m_socketNotifier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QSocketNotifier</span><span class="token punctuation">(</span>m_fileKde<span class="token punctuation">,</span>                                           QSocketNotifier<span class="token operator">::</span>Write<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>m_socketNotifier<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QSocketNotifier<span class="token operator">::</span>activated<span class="token punctuation">,</span>            <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>VolumeMonitor<span class="token operator">::</span>onFileChanged<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">bool</span> VolumeMonitor<span class="token operator">::</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_fileKde<span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> m_socketNotifier<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">bool</span> VolumeMonitor<span class="token operator">::</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">close</span><span class="token punctuation">(</span>m_fileKde<span class="token punctuation">)</span><span class="token punctuation">;</span>        m_fileKde <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">delete</span> m_socketNotifier<span class="token punctuation">;</span>        m_socketNotifier <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> VolumeMonitor<span class="token operator">::</span><span class="token function">onFileChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    QSet <span class="token operator">&lt;</span>QString<span class="token operator">></span> changedItemSet <span class="token operator">=</span> <span class="token function">getMountFileContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> item<span class="token operator">:</span> changedItemSet <span class="token operator">-</span> m_fileContentSet<span class="token punctuation">)</span>        emit <span class="token function">deviceAdded</span><span class="token punctuation">(</span><span class="token function">getMountPoint</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> item<span class="token operator">:</span> m_fileContentSet <span class="token operator">-</span> changedItemSet<span class="token punctuation">)</span>        emit <span class="token function">deviceRemoved</span><span class="token punctuation">(</span><span class="token function">getMountPoint</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    m_fileContentSet <span class="token operator">=</span> changedItemSet<span class="token punctuation">;</span><span class="token punctuation">}</span>VolumeMonitor<span class="token operator">::</span><span class="token operator">~</span><span class="token function">VolumeMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="QStorageInfo"><a href="#QStorageInfo" class="headerlink" title="QStorageInfo"></a>QStorageInfo</h4><p>å®é™…ä¸ŠQt 5.4ä¹‹ååœ¨QtCoreä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç±»å«åšQStorageInfoï¼Œè¿™ä¸ªç±»å¯ä»¥è·å–åˆ°ç›¸å…³çš„ç£ç›˜ä¿¡æ¯ã€‚è¿™ä¸ªå¹¶ä¸æ˜¯å…³é”®çš„ï¼Œå› ä¸ºæœ¬æ¬¡æˆ‘ä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªç±»ï¼Œå°±æ˜¯åœ¨è¿™é‡Œç®€å•çš„æä¸€ä¸‹ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>å®é™…ä¸Šè¿™ä¸€ç¯‡çš„å…³é”®æŠ€æœ¯æ˜¯QFileSystemWatcherï¼ŒæŠŠ<strong>/media/yourusername</strong>æ·»åŠ åˆ°ç›‘è§†ç›®å½•ä¸­ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡QFileInfo and QDiræ¥è·å–åˆ°ç›¸å…³çš„ä¿¡æ¯ï¼Œå…¶ä¸­QFileDialogä¸­çš„QFileSystemModelä¹Ÿå¯ä»¥è·Ÿéšå®æ—¶æ›´æ–°ã€‚è¿™æ ·ä¾æ—§å¯ä»¥ä¾æ—§è·å–åˆ°ç§»åŠ¨ä»‹è´¨çš„ä¿¡æ¯ä»¥åŠæ’æ‹”ä¿¡æ¯ã€‚è¿™ä¸ªæ‰æ˜¯æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆã€‚æ¥ä¸‹æ¥è¦è®²ä¸€ä¸‹QFileSystemWatcherçš„æºç ã€‚å¯èƒ½ä½ çœ‹åˆ°çš„æºç ç‰ˆæœ¬ä¸æˆ‘çš„ç‰ˆæœ¬ä¸åŒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtæºç ä¹‹é­”æ”¹QFileDialogä¹‹è·¯-1</title>
      <link href="/2020/06/26/qt-yuan-ma-zhi-mo-gai-qfiledialog-zhi-lu-1/"/>
      <url>/2020/06/26/qt-yuan-ma-zhi-mo-gai-qfiledialog-zhi-lu-1/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹å‰ç€æ€¥å‘Linuxç¤¾åŒºç‰ˆæœ¬çš„WPSï¼Œæ‰€ä»¥è¿™é‡Œéƒ½æ²¡æœ‰å¥½å¥½çš„å»æ›´æ”¹æ‰“å¼€æœ¬åœ°æ–‡ä»¶å¯¹è¯æ¡†é‚£é‡Œçš„é€»è¾‘ã€‚ç”±äºè¿™é‡Œçš„ä»£ç æ˜¯ä»å…¶å®ƒå¹³å°è¿ç§»è¿‡æ¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œçš„é€»è¾‘å°±æ²¡æœ‰åŠ¨ã€‚å¯¹äºç”¨æˆ·äº¤äº’æ¥è®²å¯ä»¥è¯´æ˜¯éå¸¸æ¶å¿ƒå¿ƒäº†ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯åšäº§å“çš„ï¼Œäº§å“é©±åŠ¨æŠ€æœ¯ã€‚è¿™æ¬¡å‘¢ï¼Œå‰å‰ååå¤§æ¦‚èŠ±äº†ä¸¤å‘¨çš„æ—¶é—´ç»ˆäºæŠŠè¿™ä¸ªäº§å“ç¨³å®šä¸‹æ¥äº†ã€‚é‡Œè¾¹ç¢°åˆ°äº†ä¸€äº›æŠ€æœ¯è¦ç‚¹ä¸éš¾ç‚¹ã€‚è¿™é‡Œç®€å•çš„æ€»ç»“ä¸‹ã€‚</p><p>å›¾1. åŸæ¥æ²¡æœ‰</p><h2 id="è‡ªå·±é€ è½®å­"><a href="#è‡ªå·±é€ è½®å­" class="headerlink" title="è‡ªå·±é€ è½®å­"></a>è‡ªå·±é€ è½®å­</h2><p>å®é™…ä¸Šè¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ–¹æ¡ˆï¼Œä¸€å¼€å§‹æƒ³å¾—å¤ªç®€å•ï¼Œç”¨äº†ä¸ªé€’å½’çš„æ–¹å¼å»è¯»å–QFileInfoçš„ä¿¡æ¯ï¼Œå‘ç°æ ˆçˆ†äº†ï¼Œç„¶åç”¨QFileSystQFileemModelæ¥è¯»å–å½“å‰æ–‡ä»¶å¤¹çš„ä¿¡æ¯ã€‚æ€»ç»“ä¸‹å°±æ˜¯ä½¿ç”¨QFileSystQFileemModel +QFileSystemWatcher +  QAbstractItemDelegateçš„æ–¹å¼å»åšï¼Œåšäº†ä¸€ä¸ªæ˜ŸæœŸï¼Œå®Œæˆäº†ä¸ƒå…«æˆï¼Œä½†æ˜¯å‘ç°ç»†èŠ‚çœŸçš„å¤ªå¤šäº†ï¼Œå†ç»™æˆ‘ä¸¤ä¸ªæ˜ŸæœŸæˆ‘å¯èƒ½éƒ½åšä¸å®Œï¼Œäºæ˜¯æ”¾å¼ƒè¿™ä¸ªæ–¹æ¡ˆã€‚çªç„¶æƒ³èµ·æ¥Qtè¿˜æœ‰ä¸ªè‡ªå¸¦çš„QFileDialogã€‚äºæ˜¯æ‰å¼€å§‹æˆ‘çš„ç¬¬äºŒä¸ªæ–¹æ¡ˆã€‚</p><h2 id="ä½¿ç”¨QFileDialogç±»"><a href="#ä½¿ç”¨QFileDialogç±»" class="headerlink" title="ä½¿ç”¨QFileDialogç±»"></a>ä½¿ç”¨QFileDialogç±»</h2><p>è¿™ä¸ªæ–¹æ¡ˆæˆ‘ä¸€å¼€å§‹è¿æƒ³éƒ½æ²¡æœ‰æƒ³ï¼Œåªæ˜¯æƒ³å°è¯•ä¸‹çœ‹çœ‹èƒ½ä¸èƒ½æ”¹é€ ä¸‹ï¼Œå‘ç°æœ€ç»ˆç»è¿‡äº†ä¸€ä¸ªæ˜ŸæœŸçš„æ”¹é€ +é€‚é…ä¹Ÿæ˜¯æŠŠè¿™ä¸ªåŠŸèƒ½å®Œæˆäº†ã€‚ç„¶ååŠ åˆ°WPSä¸­äº†ã€‚ä¸‹è¾¹å¼€å§‹è®²æˆ‘åœ¨å¼€å‘ä¸­é‡åˆ°çš„ä¸€äº›æŠ€æœ¯è¦ç‚¹ã€‚</p><h3 id="QFileDialogç®€å•ä»‹ç»"><a href="#QFileDialogç®€å•ä»‹ç»" class="headerlink" title="QFileDialogç®€å•ä»‹ç»"></a>QFileDialogç®€å•ä»‹ç»</h3><p>QFileDialogå®ç°åŸºæœ¬ä¸Šæ˜¯æˆ‘è‡ªå·±å®ç°çš„å¤æ‚ç‰ˆæœ¬ï¼ŒåŸºæœ¬è¦ç‚¹ä¹Ÿæ˜¯QFileSystemModelç±»æ¥æ˜¾ç¤ºå½“å‰çš„ç›®å½•ä¿¡æ¯ï¼Œä½¿ç”¨QFileInfoGatherer çº¿ç¨‹ç±»ä¸“é—¨ç›‘è§†ç›®å½•çš„å˜åŒ–ã€‚QFileInfoGathererçº¿ç¨‹ç±»åŸºæœ¬å®ç°æ ¸å¿ƒä¹Ÿæ˜¯QFileSystemWatcherï¼Œä½¿ç”¨äº† æ¡ä»¶å˜é‡ + é”æ¥åšåŒæ­¥ã€‚å…·ä½“çš„å®ç°è¿˜æ˜¯ç›¸å½“å¤šçš„ï¼Œ å¤§å®¶æœ‰å…´è¶£å¯ä»¥å»é˜…è¯»ä¸‹Qtçš„æºç ã€‚</p><h3 id="å¦‚ä½•æ”¹é€ QFileDialogç±»"><a href="#å¦‚ä½•æ”¹é€ QFileDialogç±»" class="headerlink" title="å¦‚ä½•æ”¹é€ QFileDialogç±»"></a>å¦‚ä½•æ”¹é€ QFileDialogç±»</h3><h4 id="æ”¹é€ åˆ©å™¨"><a href="#æ”¹é€ åˆ©å™¨" class="headerlink" title="æ”¹é€ åˆ©å™¨"></a>æ”¹é€ åˆ©å™¨</h4><p>ä¸å…¶è¯´æ˜¯å¦‚ä½•æ”¹é€ QFileDialogç±»ï¼Œä¸å¦‚è¯´æ˜¯å¦‚ä½•æ”¹é€ Qtå®˜æ–¹æä¾›çš„æ§ä»¶ï¼Œè¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ä¸¥é‡ä¾èµ–Qtå®˜æ–¹æºç ï¼ˆpsï¼Œæœ‰å…´è¶£çš„å¯ä»¥æŠŠè¿™ä¸ªç±»çš„ä»£ç æå–å‡ºæ¥ï¼Œæˆ‘å»forkï¼Œé€ƒï¼‰ï¼‰ã€‚åƒWPSè‡ªå·±ç»´æŠ¤çš„Qtåˆ†æ”¯ï¼Œè¿™ä¸ªæ–¹å¼æˆ‘æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºæºç å°±åœ¨æˆ‘è¿™é‡Œï¼Œå“ˆå“ˆã€‚è·‘åäº†ï¼ŒåŸºæœ¬ä¸Šè¿™æ ·æ”¹é€ æ˜¯æ²¡æœ‰å¤šå¤§é—®é¢˜çš„ï¼Œå®˜æ–¹ç°åœ¨å¯¹äºQWidgetè¿™å¥—ä»£ç æ”¹åŠ¨å®é™…ä¸Šæ˜¯å¾ˆå°‘çš„ã€‚ç°åœ¨è¯´ä¸€ä¸‹æ”¹é€ QFileDialogçš„åˆ©å™¨</p><ul><li>findChild()</li><li>findChildren()</li><li>metaObject()-&gt;className() (å®é™…ä¸Šè¿™ä¸ªåŸºæœ¬æ²¡ç”¨åˆ°ï¼Œäº†è§£ä¸‹ä¹Ÿæ˜¯å¾ˆå¥½çš„)</li></ul><h4 id="æ”¹é€ åŸç†"><a href="#æ”¹é€ åŸç†" class="headerlink" title="æ”¹é€ åŸç†"></a>æ”¹é€ åŸç†</h4><p>todo findchildä¸findchildrençš„æ–‡ç« ã€‚<br>findChild&lt;QLineEdit*&gt;(â€œfileNameEditâ€);</p><ul><li>è®¾ç½®QFileDialogçš„setOption</li><li>ä½¿ç”¨fildChildé€šè¿‡æ§ä»¶å æˆ–è€…é€šè¿‡findChildren æ‰¾åˆ° éœ€è¦éšè—çš„å·¦è¾¹åˆ—è¡¨ï¼Œç„¶åsetVisible(false);</li></ul><p>è¿™æ ·æœ€å…³é”®çš„é—®é¢˜è§£å†³äº†ï¼Œå¯ä»¥æŠŠè¿™ä¸ªä¸œè¥¿è®¾ç½®æˆæ— è¾¹æ¡†ç„¶ååµŒå…¥åˆ°å³è¾¹çš„æ§ä»¶ä¸­ã€‚ç„¶ååœ¨å¯¹è¯æ¡†ä¸­å·¦è¾¹åŠ ä¸Šå‡ ä¸ªä¾§è¾¹æ ï¼Œç„¶åä¸»è¦é—®é¢˜å°±è§£å†³äº†ã€‚</p><h4 id="æ”¹é€ ç»†èŠ‚ï¼Œå…¶å®ƒçš„ç›¸å…³ç»†èŠ‚ï¼Œæ¯”å¦‚è¿‡æ»¤å™¨ç›¸å…³çš„å±æ€§è®¾ç½®QFileDialogéƒ½æœ‰ç›¸å…³çš„æ¥å£å»è®¾ç½®ï¼ˆè¿™ä¸ªè‡ªå·±å»é˜…è¯»APIæ–‡æ¡£å»ï¼‰ï¼Œå”¯ä¸€ä¸€ä¸ªéœ€è¦æˆ‘å»è§£å†³çš„å°±æ˜¯ä¿å­˜æ—¶è¦å°†åç¼€åå–å‡ºæ¥ï¼Œç„¶åç”¨åˆ°äº†QtFileDialogä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ‘å·²ç»æå–å‡ºæ¥äº†ã€‚"><a href="#æ”¹é€ ç»†èŠ‚ï¼Œå…¶å®ƒçš„ç›¸å…³ç»†èŠ‚ï¼Œæ¯”å¦‚è¿‡æ»¤å™¨ç›¸å…³çš„å±æ€§è®¾ç½®QFileDialogéƒ½æœ‰ç›¸å…³çš„æ¥å£å»è®¾ç½®ï¼ˆè¿™ä¸ªè‡ªå·±å»é˜…è¯»APIæ–‡æ¡£å»ï¼‰ï¼Œå”¯ä¸€ä¸€ä¸ªéœ€è¦æˆ‘å»è§£å†³çš„å°±æ˜¯ä¿å­˜æ—¶è¦å°†åç¼€åå–å‡ºæ¥ï¼Œç„¶åç”¨åˆ°äº†QtFileDialogä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ‘å·²ç»æå–å‡ºæ¥äº†ã€‚" class="headerlink" title="æ”¹é€ ç»†èŠ‚ï¼Œå…¶å®ƒçš„ç›¸å…³ç»†èŠ‚ï¼Œæ¯”å¦‚è¿‡æ»¤å™¨ç›¸å…³çš„å±æ€§è®¾ç½®QFileDialogéƒ½æœ‰ç›¸å…³çš„æ¥å£å»è®¾ç½®ï¼ˆè¿™ä¸ªè‡ªå·±å»é˜…è¯»APIæ–‡æ¡£å»ï¼‰ï¼Œå”¯ä¸€ä¸€ä¸ªéœ€è¦æˆ‘å»è§£å†³çš„å°±æ˜¯ä¿å­˜æ—¶è¦å°†åç¼€åå–å‡ºæ¥ï¼Œç„¶åç”¨åˆ°äº†QtFileDialogä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ‘å·²ç»æå–å‡ºæ¥äº†ã€‚"></a>æ”¹é€ ç»†èŠ‚ï¼Œå…¶å®ƒçš„ç›¸å…³ç»†èŠ‚ï¼Œæ¯”å¦‚è¿‡æ»¤å™¨ç›¸å…³çš„å±æ€§è®¾ç½®QFileDialogéƒ½æœ‰ç›¸å…³çš„æ¥å£å»è®¾ç½®ï¼ˆè¿™ä¸ªè‡ªå·±å»é˜…è¯»APIæ–‡æ¡£å»ï¼‰ï¼Œå”¯ä¸€ä¸€ä¸ªéœ€è¦æˆ‘å»è§£å†³çš„å°±æ˜¯ä¿å­˜æ—¶è¦å°†åç¼€åå–å‡ºæ¥ï¼Œç„¶åç”¨åˆ°äº†QtFileDialogä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ‘å·²ç»æå–å‡ºæ¥äº†ã€‚</h4><h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><p>ä»¥ä¸ºè¿™å°±å®Œäº†ï¼Ÿå›¾æ ·å›¾å†…åŠ¡ã€‚è¿˜æœ‰ç§»åŠ¨ä»‹è´¨å‘¢ï¼Ÿï¼</p><h1 id="NOW"><a href="#NOW" class="headerlink" title="NOW"></a>NOW</h1><p>è¿™æ˜¯æˆ‘18å¹´çš„è§£å†³æ–¹æ¡ˆäº†ã€‚ç°åœ¨å‡†å¤‡è‡ªå·±é‡å†™è¿™ä¸ªä¸œè¥¿ï¼Œæ„Ÿè§‰ä¹Ÿæ²¡æœ‰ä»€ä¹ˆéš¾å¾—åœ°æ–¹ã€‚è¿™é‡Œå‡†å¤‡é‡å†™äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>error: &#39;this&#39; cannot be implicitly captured in this context</title>
      <link href="/2020/06/26/error-this-cannot-be-implicitly-captured-in-this-context/"/>
      <url>/2020/06/26/error-this-cannot-be-implicitly-captured-in-this-context/</url>
      
        <content type="html"><![CDATA[<p>è®²çœŸï¼Œä½¿ç”¨Qtåå°„ + å…ƒå¯¹è±¡ + C++11 çš„ç‰¹æ€§ï¼Œå†™c++ä»£ç ç®€ç›´ä¸è¦å¤ªçˆ½ï¼Œä»£ç ä¼˜é›…çš„ä¸æ˜¯ä¸€ä¸åŠç‚¹ã€‚</p><p>ä»Šå¤©ä½¿ç”¨lambdaè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå‘ç°æŠ¥äº†ä¸ªç¼–è¯‘é”™è¯¯</p><pre class=" language-cpp"><code class="language-cpp">error<span class="token operator">:</span> <span class="token string">'this'</span> cannot be implicitly captured in <span class="token keyword">this</span> context</code></pre><p>çº å…¶åŸå› ï¼Œåœ¨äºæˆ‘åœ¨lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†æŸä¸ªæˆå‘˜å˜é‡ï¼Œä½†æ˜¯æ²¡æœ‰æ•è·this</p><p>æŠŠä»£ç </p><pre class=" language-cpp"><code class="language-cpp"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><p>åŠ ä¸Šthiså°±å¯ä»¥äº†</p><pre class=" language-cpp"><code class="language-cpp"><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> cpp </tag>
            
            <tag> lambda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QFileDialogä¸­çš„tips</title>
      <link href="/2020/06/26/qfiledialog-zhong-de-tips/"/>
      <url>/2020/06/26/qfiledialog-zhong-de-tips/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>æœ€è¿‘çœ‹QFileDialogçš„å®ç°æ¯”è¾ƒå¤šï¼Œä¹Ÿå¯¹æ¯”äº†å‡ å®¶æ“ä½œç³»ç»Ÿå‚å•†è·ŸQtçš„QFileDialogä¸­çš„å®ç°ï¼Œä¹Ÿè‡ªå·±é€ äº†ä¸ªå°è½®å­ã€‚ä¹Ÿå­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œç‰¹æ„æ¥åˆ†äº«ä¸‹ã€‚</p><h3 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h3><p>å¯ä»¥å°†ç±»å‹è¯¸å¦‚è¿™ç§çš„æ ¼å¼</p><pre><code>WPSæ–‡å­— æ–‡ä»¶(*.wps)  æå–æˆè¿™ç§ *.wps</code></pre><p>æœ¬æ¥æ‰“ç®—è‡ªå·±å†™æ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œç”Ÿæ€•è‡ªå·±å†™çš„æ•ˆç‡æ¯”è¾ƒä½ï¼Œå°±ä»QFileDialogçš„æºç ä¸­æ‰£å–å‡ºæ¥äº†ã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//from QFileDialog</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>qt_file_dialog_filter_reg_exp <span class="token operator">=</span><span class="token string">"^(.*)\\(([a-zA-Z0-9_.*? +;#\\-\\[\\]@\\{\\}/!&lt;>\\$%&amp;=^~:\\|]*)\\)$"</span><span class="token punctuation">;</span>QStringList <span class="token function">qt_clean_filter_list</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>filter<span class="token punctuation">)</span><span class="token punctuation">{</span>    QRegExp <span class="token function">regexp</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">fromLatin1</span><span class="token punctuation">(</span>qt_file_dialog_filter_reg_exp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QString f <span class="token operator">=</span> filter<span class="token punctuation">;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> regexp<span class="token punctuation">.</span><span class="token function">indexIn</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span>        f <span class="token operator">=</span> regexp<span class="token punctuation">.</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> f<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token function">QLatin1Char</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span> QString<span class="token operator">::</span>SkipEmptyParts<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="QFileInfoçš„æ–°å¥‡ä½¿ç”¨æ–¹æ³•"><a href="#QFileInfoçš„æ–°å¥‡ä½¿ç”¨æ–¹æ³•" class="headerlink" title="QFileInfoçš„æ–°å¥‡ä½¿ç”¨æ–¹æ³•"></a>QFileInfoçš„æ–°å¥‡ä½¿ç”¨æ–¹æ³•</h3><p>å®é™…ä¸Šæˆ‘åˆé‡åˆ°äº†ä¸€ä¸ªæºç ä¸­å…³äºQFileInfoä¸€ä¸ªåŸæ¥æ²¡æœ‰ç”¨è¿‡çš„ç”¨æ³•ã€‚</p><p>ç›´æ¥å°†</p><pre class=" language-cpp"><code class="language-cpp"><span class="token operator">*</span><span class="token punctuation">.</span>wps </code></pre><p>è¿™ç§å­—ç¬¦å½“åšQStringæ”¾è¿›äº†QFileInfoæ¥è·å–å…¶basenameï¼ˆæ–‡ä»¶åï¼‰è·Ÿ suffixï¼ˆåç¼€ï¼‰ï¼Œæˆ–è€…ä½¿ç”¨å…¶å®ƒçš„å‡½æ•°ã€‚ä¸€èˆ¬æˆ‘éƒ½æ˜¯ä¼ ä¸ªæ–‡ä»¶è·¯å¾„çš„ï¼Œæ²¡æƒ³åˆ°è¿˜èƒ½ç”¨è¿™ç§æ–¹æ³•è§£æå­—ç¬¦ä¸²ã€‚</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//è¿™æ—¶å€™å¯ä»¥ç”¨QFileInfoæŠŠä¸€äº›å¤æ‚çš„å­—ç¬¦ä¸²çš„ä»€ä¹ˆå‰ç¼€ï¼Œåç¼€åå…¨éƒ½è§£æå‡ºæ¥äº†ï¼ŒåŒ…æ‹¬*.tar.gzè¿™ç§å¤æ‚çš„ï¼ŒQFileInfoéƒ½æœ‰å‡½æ•°æ¥æå–</span>QFileInfo <span class="token function">fileInfo</span><span class="token punctuation">(</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"*.wps"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ‘æœ¬æ¥æƒ³è‡ªå·±è§£æè¿™ä¸ªå­—ç¬¦ä¸²çš„ï¼Œå‘ç°QFileDialogçš„æºç ä¸­è¿˜æœ‰è¿™ç§ç”¨æ³•ï¼ŒçœŸçš„å¾ˆç¥å¥‡ã€‚</p><h3 id="æ–‡ä»¶ç®¡ç†å™¨çš„åæ§½"><a href="#æ–‡ä»¶ç®¡ç†å™¨çš„åæ§½" class="headerlink" title="æ–‡ä»¶ç®¡ç†å™¨çš„åæ§½"></a>æ–‡ä»¶ç®¡ç†å™¨çš„åæ§½</h3><p>æœ€è¿‘çœ‹äº†çœ‹KDEçš„dolphinæ–‡ä»¶ç®¡ç†å™¨ä»£ç çš„å®ç°ï¼Œè¿˜æœ‰æ·±åº¦çš„æ–‡ä»¶ç®¡ç†å™¨çš„å®ç°ï¼Œè¿˜æœ‰ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿç¬¬ä¸‰æ–¹çš„ï¼Œè¿˜æœ‰Qtè‡ªå¸¦çš„QFileDialogã€‚å°±å±KDEçš„dolphinåšçš„æœ€å‰å®³ï¼Œäº¤äº’æœ€å¥½ï¼Œä¼˜åŒ–çš„æœ€å¥½ã€‚</p><p>æ·±åº¦çš„æ–‡ä»¶ç®¡ç†å™¨è·ŸQtè‡ªå¸¦QFileDialogé‡åˆ°å¤æ‚çš„ç½‘ç»œæ–‡ä»¶ä»¥åŠå»¶è¿Ÿéƒ½ä¼šå¡æ­»ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•äº¤äº’ã€‚QFileDialogæˆ‘ç†è§£è¿™ä¸ªä¸œè¥¿ä¸€å¼€å§‹å°±ä¸æ˜¯ç»™ç½‘ç»œæ–‡ä»¶ç”¨çš„ï¼Œå¡æ­»æˆ‘è¿˜æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†æ˜¯æ·±åº¦ä½œä¸ºæ“ä½œç³»ç»Ÿå‚å•†åšæˆè¿™æ ·å°±æœ‰ç‚¹ä¸å¤ªåˆé€‚äº†ã€‚å¤§æ¦‚æ‰«äº†ä¸‹æºç ï¼Œä¹Ÿè·ŸQFileDialogä¸€æ ·é‡å†™äº†modelï¼Œmodelè¿™é‡Œäº¤äº’è¿˜æ˜¯å¾—å¥½å¥½ä¼˜åŒ–ä¸‹å•Šã€‚è¿™å°±æ˜¯è‡ªå·±é€ è½®å­çš„åå¤„ã€‚</p><p>ä»ä¸€ä¸ªå¼€å‘çš„è§’åº¦ï¼Œç®€å•çš„åæ§½ä¸€ä¸‹ï¼Œåæ­£ç»™ä»–ä»¬å®˜æ–¹åé¦ˆäº†ã€‚å› ä¸ºdeepinçš„æ–‡ä»¶ç®¡ç†å™¨çš„bugå®åœ¨å¤ªå¤šäº†=ã€‚=ã€‚</p><p>å—¯ï¼ŒKDEå¤§æ³•å¥½ï¼è¯è¯´ï¼Œä¸€å¼€å§‹çš„è®¾è®¡å¯ä»¥ä»å€Ÿé‰´ï¼ˆcopyï¼‰KDEçš„å®ç°å˜›ï¼Œéƒ½è¿™ä¹ˆå¤šå¹´äº†â€¦</p><p>é€ è½®å­ä¸è¦å¯¹è‡ªå·±å¤ªè‡ªä¿¡â€¦å®æ—¶ä¸Šæˆ‘è‡ªå·±é€ çš„å°è½®å­ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜=ã€‚=ã€‚</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>è¿™æ˜¯æˆ‘å‰å¹´çš„æ—¶å€™çœ‹å„ä¸ªå‚å•†ä»¥åŠè°ƒç ”QFileDialogæ€»ç»“å‡ºæ¥ä¸€ç‚¹å°ç»“è®ºã€‚å»å¹´å¹´åº•æˆ‘åˆæŠŠè¿™éƒ¨åˆ†æ¡èµ·æ¥äº†ã€‚ç°åœ¨å·²ç»ä¼˜åŒ–åˆ°åŠ è½½åƒä¸‡çº§åˆ«çš„æ•°æ®ï¼Œç•Œé¢ä¸ä¼šå¡ä½çš„åœ°æ­¥äº†ã€‚æœ‰æ—¶é—´æŠŠè¿™éƒ¨åˆ†ä¸œè¥¿å†™å‡ºæ¥</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtæºç  </tag>
            
            <tag> QFileDialog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ›´æ¢difftoolä¸ºmeld</title>
      <link href="/2020/06/26/linux-geng-huan-difftool-wei-meld/"/>
      <url>/2020/06/26/linux-geng-huan-difftool-wei-meld/</url>
      
        <content type="html"><![CDATA[<h3 id="meld"><a href="#meld" class="headerlink" title="meld"></a>meld</h3><pre class=" language-shell"><code class="language-shell">#è®¾ç½®é»˜è®¤çš„git diffçš„æ¯”è¾ƒå·¥å…·#é…ç½®æ¯”è¾ƒå·¥å…·.å¯ä»¥ç”¨git difftool è°ƒç”¨.git config --global diff.tool meldgit config --global difftool.prompt false</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> git </tag>
            
            <tag> meld </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨QtCteatorç¼–è¯‘QtCreator</title>
      <link href="/2020/06/26/shi-yong-qtcteator-bian-yi-qtcreator/"/>
      <url>/2020/06/26/shi-yong-qtcteator-bian-yi-qtcreator/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åŸè°…æˆ‘æ ‡é¢˜å…šäº†ï¼Œæœ¬æ–‡æ ‡é¢˜åº”è¯¥æ˜¯ä½¿ç”¨Clangä¾èµ–Qtç¼–è¯‘QtCreatorã€‚</p><p>ç›®å‰åœ¨Linuxä¸Šåšå¼€å‘ï¼Œä¸€ç›´ä½¿ç”¨çš„IDEå°±æ˜¯QtCreatorã€‚ å®é™…ä¸Šä¸€ç›´æœ‰æƒ³åšä¸€ä¸ªç¼–è¾‘å™¨çš„æƒ³æ³•ï¼ˆå› ä¸ºæˆ‘è§‰å¾—QtCreatoræœ‰ç‚¹ç¬¨é‡ï¼Œè€Œæˆ‘åªæ˜¯æƒ³è¦ä¸€ä¸ªå•çº¯çš„ç¼–è¾‘å™¨çš„åŠŸèƒ½ã€‚ç›®å‰å¼€æºçš„ä¼˜ç§€çš„ä½¿ç”¨Qtåˆ¶ä½œçš„ç¼–è¾‘å™¨å¥½è±¡æ˜¯æ²¡æœ‰ã€‚æˆ‘ä¹Ÿä¸€ç›´å–œæ¬¢ä½¿ç”¨vimï¼Œè€Œä¸”QtCreatorä¹Ÿæœ‰fakevimçš„æ’ä»¶ã€‚QtCreatoræˆ‘ä¹Ÿç”¨ç€æ¯”è¾ƒèˆ’æœï¼Œè¿˜æ˜¯Qtå†™çš„ï¼Œæˆ‘ä¹Ÿæ¯”è¾ƒç†Ÿæ‚‰Qtçš„ä»£ç ï¼Œæ‰€ä»¥æƒ³è¦é­”æ”¹è¿™ä¸ªé¡¹ç›®äº†ã€‚è€Œä¸”ä»å®˜æ–¹forkçš„è¯ï¼Œä»¥åæœ‰å•¥bugå¯ä»¥ç›´æ¥cherry-pickè¿‡æ¥ï¼Œé€ƒï¼‰ã€‚è¶ç€è¿™ä¸ªæœºä¼šï¼Œé˜…è¯»ä¸‹è¿™ä¸ªIDEçš„æ¶æ„æ˜¯å¦‚ä½•è®¾è®¡çš„ã€‚</p><p>æˆ‘ä¸ªäººä¸€ç›´å¾ˆå–œæ¬¢QtCreatorè¿™ä¸ªIDEï¼Œå½“ç„¶æ²¡æœ‰vså¼ºå¤§ï¼ˆå®‡å®™ç¬¬ä¸€IDEå¯ä¸æ˜¯å¹çš„ï¼‰ï¼Œæ˜¯ä¸å¯å¤šå¾—çš„ä¼˜ç§€çš„IDEã€‚é…ç½®ç¯å¢ƒä»€ä¹ˆçš„ä¹Ÿæ¯”è¾ƒç®€å•æ–¹ä¾¿ã€‚ç›®å‰æˆ‘çš„å¼€å‘æœºå™¨ç¯å¢ƒä¸ºUbuntu16.04,å°±æš‚æ—¶ä»¥è¿™ä¸ªç¯å¢ƒæ¥è®²å§ã€‚</p><h2 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h2><p>å¦‚æœç¼–è¯‘QtCreatorï¼Œå®é™…ä¸Šå®˜æ–¹çš„wikiæ˜¯æœ‰çš„ï¼Œé“¾æ¥åœ¨è¿™é‡Œ <a href="https://wiki.qt.io/Building_Qt_Creator_from_Git" target="_blank" rel="noopener">https://wiki.qt.io/Building_Qt_Creator_from_Git</a> ç®€å•çš„è®²ï¼Œå°±æ˜¯å¦‚ä¸‹å‡ ä¸ªæ¡ä»¶</p><blockquote><ul><li>Qt5.6.2åŠä»¥åç‰ˆæœ¬ä»¥åç‰ˆæœ¬çš„Qtåº“</li><li>clang5.0åŠä¹‹åç‰ˆæœ¬çš„ç¼–è¯‘å™¨</li></ul></blockquote><h3 id="Qtç¼–è¯‘"><a href="#Qtç¼–è¯‘" class="headerlink" title="Qtç¼–è¯‘"></a>Qtç¼–è¯‘</h3><p>æˆªæ­¢2018å¹´10æœˆ13æ—¥ã€‚ç›®å‰æœ€æ–°çš„Qtç‰ˆæœ¬æ˜¯Qt5.11.2ã€‚ï¼ˆ5.12è¿˜åœ¨æµ‹è¯•ä¸­ï¼‰é‚£å°±ä»¥æœ€æ–°çš„Qtç‰ˆæœ¬æ¥ç¼–è¯‘QtCreatorå§ã€‚å»å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„Qtæºç <a href="http://download.qt.io/archive/qt/5.11/5.11.2/single/" target="_blank" rel="noopener">http://download.qt.io/archive/qt/5.11/5.11.2/single/</a><br>æ¯”å¦‚æˆ‘å°±ä¸‹è½½åˆ°äº† /home/zhangpf/Qt/Qt5.11ä¸‹ï¼Œè§£å‹åˆ°å½“å‰æ–‡ä»¶å¤¹ï¼Œç„¶åæ–°å»ºä¸ªæ–°çš„ç›®å½•ç”¨äºæ”¾ç¼–è¯‘å¥½çš„Qtã€‚</p><pre class=" language-shell"><code class="language-shell">mkdir qt5.11.2cd /home/zhangpf/Qt/Qt5.11/qt-everywhere-src-5.11.2</code></pre><p>å‡†å¤‡ç¼–è¯‘Qtã€‚ï¼ˆåœ¨è¿™é‡Œæˆ‘ä¸€å¼€å§‹ä¸‹è½½çš„Qt5.10çš„ç‰ˆæœ¬ï¼Œå› ä¸ºæˆ‘è¿˜æ€•5.11ä¸ç¨³å®šï¼Œä½†æ˜¯å‘ç°ç¼–è¯‘çš„æ—¶å€™QtScriptæ¨¡å—ç¼–è¯‘ä¸è¿‡ï¼ŒQtCreatorå·¥ç¨‹åˆä¾èµ–QtScriptï¼Œgoogleäº†ä¸‹å‘ç°ä¸åªæ˜¯æˆ‘æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯è¿˜æœªè§£å†³ï¼Œå·²ç»æŠ¥äº†QTBUGã€‚æ‰€ä»¥æˆ‘æ‰åˆä¸‹è½½çš„Qt5.11çš„ç‰ˆæœ¬æ¥ç¼–è¯‘çš„ã€‚ï¼‰</p><p>ç„¶åç»§ç»­</p><pre class=" language-shell"><code class="language-shell">./configure -prefix /home/zhangpf/Qt/Qt5.11/qt5.11.2 -debug -opensource -confirm-licensecd /home/zhangpf/Qt/Qt5.11/qt5.11.2make && make install</code></pre><p>æ¯”å¦‚æˆ‘çš„ç”µè„‘cpuæ˜¯i7-7700,4æ ¸8çº¿ç¨‹ï¼Œæˆ‘å°±å¯ä»¥make -j8ã€‚è¿˜æ˜¯çœ‹è‡ªå·±ç”µè„‘çš„æ€§èƒ½äº†ã€‚<br>æ©ï¼Œè¿™æ—¶å€™Qt5.11.2çš„åº“å°±å‡†å¤‡å¥½äº†ã€‚</p><h2 id="clangå‡†å¤‡ã€‚"><a href="#clangå‡†å¤‡ã€‚" class="headerlink" title="clangå‡†å¤‡ã€‚"></a>clangå‡†å¤‡ã€‚</h2><p>ä¸‹è½½é“¾æ¥<a href="http://releases.llvm.org/download.html" target="_blank" rel="noopener">http://releases.llvm.org/download.html</a> ä¸‹è½½clang clang++ 5.0ä»¥åé¢„ç¼–è¯‘å¥½çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚æˆ‘å°±æ˜¯ä¸‹è½½clang6.0çš„Ubuntu16.04çš„ç‰ˆæœ¬ã€‚ä¸‹è½½ä¸‹æ¥å¯ä»¥ç›´æ¥ç”¨ã€‚æ”¾åˆ°äº†/opt ä¸‹ï¼Œç„¶åæˆ‘åˆåšäº†ä¸ªè½¯é“¾åˆ°/usr/local/bin/ä¸‹ã€‚</p><h2 id="QtCreatorå‡†å¤‡"><a href="#QtCreatorå‡†å¤‡" class="headerlink" title="QtCreatorå‡†å¤‡"></a>QtCreatorå‡†å¤‡</h2><p>å®˜æ–¹å·²ç»è®²å¾—å¾ˆæ˜ç¡®äº†ï¼Œç›´æ¥</p><pre><code>git clone --recursive https://code.qt.io/qt-creator/qt-creator.git</code></pre><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><h3 id="é…ç½®QtCreator"><a href="#é…ç½®QtCreator" class="headerlink" title="é…ç½®QtCreator"></a>é…ç½®QtCreator</h3><blockquote><ul><li>å·¥å…·-é€‰é¡¹-æ„å»ºå’Œè¿è¡Œ-ç¼–è¯‘å™¨   æŠŠåˆšæ‰ä¸‹è½½å¥½çš„clangæ·»åŠ è¿›å»ï¼Œç‚¹å‡»åº”ç”¨</li><li>å·¥å…·-é€‰é¡¹-æ„å»ºå’Œè¿è¡Œ-QtVersion æ·»åŠ ä¸€ä¸ªQtVersion æŠŠç¼–è¯‘å¥½çš„Qt5.11.2 qmakeè·¯å¾„åŠ è¿›å»ï¼Œç‚¹å‡»åº”ç”¨</li><li>å·¥å…·-é€‰é¡¹-æ„å»ºå’Œè¿è¡Œ-æ„å»ºå¥—ä»¶ æ·»åŠ ä¸€ä¸ªæ„å»ºå¥—ä»¶å–åqtcreatorï¼Œç¼–è¯‘å™¨è·ŸQtVersioné€‰æ‹©æˆåˆšæ‰æ·»åŠ çš„ã€‚ç‚¹å‡»åº”ç”¨</li></ul></blockquote><h3 id="ç¼–è¯‘æºç "><a href="#ç¼–è¯‘æºç " class="headerlink" title="ç¼–è¯‘æºç "></a>ç¼–è¯‘æºç </h3><p>ç›´æ¥æ‰“å¼€QtCreatorçš„proæ–‡ä»¶ï¼Œæ„å»ºå¥—ä»¶é€‰æ‹©åˆšæ‰æ–°å»ºçš„qtcreatorã€‚ç„¶åç›´æ¥å³é”®proæ–‡ä»¶ï¼Œqmake-&gt;æ„å»º.</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>qtcreatoræºç 149mã€‚ç¼–è¯‘å‡ºæ¥çš„debugç‰ˆæœ¬çš„QtCreator 1.5Gã€‚ä¹Ÿæ˜¯ç›¸å½“å¤§çš„ä¸€ä¸ªQtå·¥ç¨‹äº†ã€‚ä»å¤´æŠ˜è…¾åˆ°å°¾ï¼ŒåŸºæœ¬æ²¡å‘ç°å•¥å¤§çš„ç¼–è¯‘é—®é¢˜ä¸ç–‘éš¾æ‚ç—‡ï¼Œä¹Ÿå°±åªæœ‰ä¸€ä¸ªQt5.10ç‰ˆæœ¬QtScriptç¼–è¯‘ä¸è¿‡çš„é—®é¢˜ï¼Œè¿˜è¢«æˆ‘è§„é¿æ‰äº†ã€‚æ¥ä¸‹æ¥å°±è¯¥é˜…è¯»è¿™ä¸ªå·¥ç¨‹çš„æºç ï¼Œå»æ›´æ”¹æˆ‘æƒ³è¦çš„ç»“æœäº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu16.04ä¸‹pip3çš„å®‰è£…ï¼Œå‡çº§ï¼Œå¸è½½</title>
      <link href="/2020/06/26/ubuntu16-04-xia-pip3-de-an-zhuang-sheng-ji-xie-zai/"/>
      <url>/2020/06/26/ubuntu16-04-xia-pip3-de-an-zhuang-sheng-ji-xie-zai/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å¼€å‘æœºæ¢äº†Ubuntu16.04ï¼Œæ¥è®°å½•ä¸‹ã€‚</p><p>Python2ä¸Python3æ˜¯å¯ä»¥å…±å­˜çš„ï¼ŒUbuntué»˜è®¤è£…å¥½äº†ã€‚<br>å‘½ä»¤pythonå°±æ˜¯Python2<br>å‘½ä»¤python3ä¸€èˆ¬æ˜¯Python3.5</p><p>ä»¥ä¸‹å‘½ä»¤é€‚ç”¨äºPython2ï¼ŒæŠŠpip3æ”¹æˆå¯¹åº”çš„pipå°±å¥½</p><p>å®‰è£…pip3</p><pre class=" language-shell"><code class="language-shell">sudo apt-get install python3-pip</code></pre><p>å‡çº§pip3</p><pre class=" language-shell"><code class="language-shell">sudo pip3 install --upgrade pip</code></pre><p>å¸è½½pip3</p><pre class=" language-shell"><code class="language-shell">sudo apt-get remove python3-pip</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Python </tag>
            
            <tag> pip3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Poppleråœ¨Windowsä¸‹ç¼–è¯‘</title>
      <link href="/2020/06/26/poppler-zai-windows-xia-bian-yi/"/>
      <url>/2020/06/26/poppler-zai-windows-xia-bian-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="windowsåº“ï¼ˆå·²ç»ç¼–è¯‘å¥½äº†ã€‚ï¼‰"><a href="#windowsåº“ï¼ˆå·²ç»ç¼–è¯‘å¥½äº†ã€‚ï¼‰" class="headerlink" title="windowsåº“ï¼ˆå·²ç»ç¼–è¯‘å¥½äº†ã€‚ï¼‰"></a>windowsåº“ï¼ˆå·²ç»ç¼–è¯‘å¥½äº†ã€‚ï¼‰</h2><p>Poppleråœ¨Windowsä¸‹ç¼–è¯‘è¿˜æ˜¯ç›¸å½“éº»çƒ¦çš„ï¼Œå®é™…ä¸Šå¾ˆå¤šåº“åœ¨windowsä¸‹ç¼–è¯‘éƒ½ä¼šæœ‰é—®é¢˜ã€‚ä½†æ˜¯æœ‰è€å“¥åœ¨Windowsä¸‹ä½¿ç”¨GCCç¼–è¯‘å¥½äº†ä¸€ä¸ªåº“ï¼Œè¿™é‡Œæ˜¯ä¸‹è½½é“¾æ¥ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æˆ‘åœ¨Windowsä¸Šä¸€ç›´ä½¿ç”¨çš„ä¸€ä¸ªåº“ã€‚<br><a href="https://sourceforge.net/projects/poppler-win32/" target="_blank" rel="noopener">https://sourceforge.net/projects/poppler-win32/</a></p><h2 id="Poppler-data"><a href="#Poppler-data" class="headerlink" title="Poppler-data"></a>Poppler-data</h2><p>æœ‰ä¸ªè€å“¥åœ¨githubä¸Šç»™æˆ‘æå‡ºäº†ä¸ªissueï¼Œå‘ç°æˆ‘çš„é˜…è¯»å™¨æ‰“å¼€äº¬ä¸œçš„pdfçš„å‘ç¥¨æœ‰çš„å­—ä½“æ˜¾ç¤ºä¸å…¨ï¼Œï¼ˆä»–è¦åŸºäºæˆ‘çš„ä»£ç åšä¸ªæ‰“å°å‘ç¥¨çš„ç³»ç»Ÿï¼Œæ”¹å°±æ”¹å§=ï¼Œ=ï¼‰ã€‚ä»–æŠŠå®˜ç½‘çš„<a href="https://poppler.freedesktop.org/" target="_blank" rel="noopener">https://poppler.freedesktop.org/</a> é‡Œè¾¹æœ‰ä¸ªpoppler-dataç¼–è¯‘å¥½äº†ï¼Œç»™æˆ‘æäº†ä¸ªpushã€‚ç„¶åä¹Ÿæ²¡æœ‰è¯´æ˜æ€ä¹ˆç¼–è¯‘ã€‚è¿™å°±æ¯”è¾ƒè›‹ç–¼äº†ã€‚ç»è¿‡éªŒè¯å‘ç°ç¡®å®æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œç„¶åæˆ‘æ€»ç»“äº†ä¸‹ç¼–è¯‘è¿‡ç¨‹ã€‚</p><p>ä½¿ç”¨QtCreaterè‡ªå¸¦çš„MinGWï¼ˆé‡Œè¾¹çš„GCCï¼‰ç¼–è¯‘</p><p>ä¸‹è½½å®˜ç½‘ç•Œé¢ä¸‹çš„poppler-dataé“¾æ¥ï¼Œè¿›å…¥ç›®å½•ï¼Œå®‰è£…åˆ°Eç›˜ï¼Œç„¶åæŠŠå®‰è£…å¥½çš„ç›®å½•ç›´æ¥æ‹·è´åˆ°é˜…è¯»å™¨ä¸­çš„3rdpartyä¸‹ï¼Œå°±æ˜¾ç¤ºæ­£å¸¸äº†ã€‚</p><pre><code>cmake . -DCMAKE_INSTALL_PREFIX=E:mingw32-makemingw32-make install</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> poppler </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Poppleråœ¨Mac OSä¸‹ç¼–è¯‘</title>
      <link href="/2020/06/26/poppler-zai-mac-os-xia-bian-yi/"/>
      <url>/2020/06/26/poppler-zai-mac-os-xia-bian-yi/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ä¼—æ‰€å‘¨çŸ¥ï¼ŒPoppler-qt5æ˜¯è·¨å¹³å°çš„ï¼Œä½†æ˜¯ç›®å‰Poppleråœ¨Mac OSä¸‹ç¼–è¯‘çš„èµ„æ–™ä¸€ç›´æ²¡æœ‰æ‰¾åˆ°ã€‚ä½†æ˜¯ç›®å‰æ‰‹å¤´ä¹Ÿæ²¡æœ‰macçš„æœºå™¨æ¥è¯•è¯•ï¼ˆæˆ‘å¯æ˜¯æLinuxçš„ï¼ä½†æ˜¯éƒ½æ˜¯ä¸€ä¸ªUnixçˆ¹å•Šï¼‰ã€‚ç›®å‰æœ‰ä¸¤ä¸ªæ–¹æ³•å»ç¼–è¯‘Macç‰ˆæœ¬çš„popplerã€‚ç°åœ¨ç‰¹æ„æ€»ç»“ä¸‹ã€‚æ¯•ç«Ÿæˆ‘è¿˜æ˜¯æƒ³æŠŠè‡ªå·±çš„é˜…è¯»å™¨æåˆ°Macä¸Šè¯•è¯•çš„ã€‚ï¼ˆè¿™å°±æ˜¯ä½ æƒ³ä¹°Macçš„ç†ç”±ï¼Ÿï¼‰</p><h2 id="MacPorts"><a href="#MacPorts" class="headerlink" title="MacPorts"></a>MacPorts</h2><p>å»Popplerçš„å®˜æ–¹ç½‘ç«™å‘ç°Poppleræ˜¯æ”¯æŒMacPortsçš„ã€‚MacPortsæ˜¯Macä¸Šæ”¯æŒçš„ç¬¬ä¸‰æ–¹çš„åŒ…ç®¡ç†å™¨ï¼ˆè·ŸUbuntuçš„ apt-getå¾ˆåƒï¼‰ã€‚å¯ä»¥é€šè¿‡è¿™ä¸ªåŒ…ç®¡ç†å™¨å®‰è£…ã€‚</p><h2 id="è‡ªå·±ç¼–è¯‘"><a href="#è‡ªå·±ç¼–è¯‘" class="headerlink" title="è‡ªå·±ç¼–è¯‘"></a>è‡ªå·±ç¼–è¯‘</h2><p>æµè§ˆäº†åŠå¤©ï¼Œå‘ç°ä¸€ä¸ªè€å¤–å†™çš„æ–‡ç« ã€‚ç‰¹æ„æŠŠé“¾æ¥æ”¾åˆ°è¿™é‡Œã€‚æœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±ç¼–è¯‘ä¸‹ã€‚<br>åŸæ–‡<a href="http://www.freebyte.fr/?p=8" target="_blank" rel="noopener">http://www.freebyte.fr/?p=8</a></p><p>è¿™æ˜¯æˆ‘ç›®å‰æ‰¾åˆ°çš„æ‰€æœ‰åœ¨MacOSä¸‹ç¼–è¯‘çš„æ–¹æ³•äº†ã€‚æœ‰æƒ³è¿‡ä½¿ç”¨googleè·Ÿç¦æ˜•åˆä½œå¼€æºçš„pdfiumï¼Œå…ˆç»™è‡ªå·±æŒ–ä¸ªå‘å§ã€‚</p><p>PS:<br>æœ€æ–°çš„Qt6é¢„è§ˆç‰ˆå·²ç»æœ‰äº†pdfæ¨¡å—ï¼Œå°±æ˜¯ä½¿ç”¨çš„webengineé‡Œçš„pdfæ¨¡å—ã€‚<br>ç­‰å‡ºæ¥ä¹‹åå°±å¯ä»¥æ›´æ–°è‡ªå·±çš„é˜…è¯»å™¨äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> poppler </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtåœ¨Linuxä¸‹è·å–å½“å‰ç³»ç»Ÿç”¨æˆ·å</title>
      <link href="/2020/06/26/qt-zai-linux-xia-huo-qu-dang-qian-xi-tong-yong-hu-ming/"/>
      <url>/2020/06/26/qt-zai-linux-xia-huo-qu-dang-qian-xi-tong-yong-hu-ming/</url>
      
        <content type="html"><![CDATA[<p> Qtæ²¡æœ‰ç›´æ¥çš„æ¥å£å»è·å–åˆ°å½“å‰ç³»ç»Ÿç”¨æˆ·åï¼Œåªèƒ½å¤Ÿé—´æ¥çš„é€šè¿‡ç°æœ‰çš„æ¥å£å»è·å–ã€‚ï¼ˆæ¯”å¦‚ä¸‹è¾¹çš„ä¾‹å­é€šè¿‡è·å–homeè·¯å¾„ï¼‰</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//Qt4 version</span>QString <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      QString userName <span class="token operator">=</span> QDesktopServices<span class="token operator">::</span><span class="token function">storageLocation</span><span class="token punctuation">(</span>QDesktopServices<span class="token operator">::</span>HomeLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>    userName <span class="token operator">=</span> userName<span class="token punctuation">.</span><span class="token function">section</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> userName<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//Qt5 version</span>QString <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    QString userPath <span class="token operator">=</span> QStandardPaths<span class="token operator">::</span><span class="token function">writableLocation</span><span class="token punctuation">(</span>QStandardPaths<span class="token operator">::</span>HomeLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>     QString userName <span class="token operator">=</span> userPath<span class="token punctuation">.</span><span class="token function">section</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> userName<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>poppler-data(Windows)ç¼–è¯‘</title>
      <link href="/2020/06/26/poppler-data-windows-bian-yi/"/>
      <url>/2020/06/26/poppler-data-windows-bian-yi/</url>
      
        <content type="html"><![CDATA[<p>ä»¥Windowså¹³å°ä¸¾ä¾‹</p><p>ä¸‹è½½ poppler-data ï¼Œè¿›å…¥ç›®å½•</p><p>ä¸‹è½½é“¾æ¥</p><p><a href="https://poppler.freedesktop.org/" target="_blank" rel="noopener">https://poppler.freedesktop.org/</a></p><pre><code>cmake . -DCMAKE_INSTALL_PREFIX=E:mingw32-makemingw32-make install</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> poppler </tag>
            
            <tag> poppler-data </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtçº¿ç¨‹åŸºç¡€</title>
      <link href="/2020/06/14/qt-xian-cheng-ji-chu/"/>
      <url>/2020/06/14/qt-xian-cheng-ji-chu/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿ç¨‹çš„æ¦‚å¿µ"><a href="#çº¿ç¨‹çš„æ¦‚å¿µ" class="headerlink" title="çº¿ç¨‹çš„æ¦‚å¿µ"></a>çº¿ç¨‹çš„æ¦‚å¿µ</h1><h2 id="WIKIï¼š"><a href="#WIKIï¼š" class="headerlink" title="WIKIï¼š"></a>WIKIï¼š</h2><blockquote><p>çº¿ç¨‹ï¼ˆè‹±è¯­ï¼šthreadï¼‰æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚å®ƒè¢«åŒ…å«åœ¨è¿›ç¨‹ä¹‹ä¸­ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€æ¡çº¿ç¨‹æŒ‡çš„æ˜¯è¿›ç¨‹ä¸­ä¸€ä¸ªå•ä¸€é¡ºåºçš„æ§åˆ¶æµï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥å¹¶å‘å¤šä¸ªçº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚åœ¨Unix System VåŠSunOSä¸­ä¹Ÿè¢«ç§°ä¸ºè½»é‡è¿›ç¨‹ï¼ˆlightweight processesï¼‰ï¼Œä½†è½»é‡è¿›ç¨‹æ›´å¤šæŒ‡å†…æ ¸çº¿ç¨‹ï¼ˆkernel threadï¼‰ï¼Œè€ŒæŠŠç”¨æˆ·çº¿ç¨‹ï¼ˆuser threadï¼‰ç§°ä¸ºçº¿ç¨‹ã€‚<br>çº¿ç¨‹æ˜¯ç‹¬ç«‹è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹å¯ä»¥ä¸ºæ“ä½œç³»ç»Ÿå†…æ ¸è°ƒåº¦çš„å†…æ ¸çº¿ç¨‹ï¼Œå¦‚Win32çº¿ç¨‹ï¼›ç”±ç”¨æˆ·è¿›ç¨‹è‡ªè¡Œè°ƒåº¦çš„ç”¨æˆ·çº¿ç¨‹ï¼Œå¦‚Linuxå¹³å°çš„POSIX Threadï¼›æˆ–è€…ç”±å†…æ ¸ä¸ç”¨æˆ·è¿›ç¨‹ï¼Œå¦‚Windows 7çš„çº¿ç¨‹ï¼Œè¿›è¡Œæ··åˆè°ƒåº¦ã€‚<br>åŒä¸€è¿›ç¨‹ä¸­çš„å¤šæ¡çº¿ç¨‹å°†å…±äº«è¯¥è¿›ç¨‹ä¸­çš„å…¨éƒ¨ç³»ç»Ÿèµ„æºï¼Œå¦‚è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ–‡ä»¶æè¿°ç¬¦å’Œä¿¡å·å¤„ç†ç­‰ç­‰ã€‚ä½†åŒä¸€è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹æœ‰å„è‡ªçš„è°ƒç”¨æ ˆï¼ˆcall stackï¼‰ï¼Œè‡ªå·±çš„å¯„å­˜å™¨ç¯å¢ƒï¼ˆregister contextï¼‰ï¼Œè‡ªå·±çš„çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆthread-local storageï¼‰ã€‚<br>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¾ˆå¤šçº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚<br>åœ¨å¤šæ ¸æˆ–å¤šCPUï¼Œæˆ–æ”¯æŒHyper-threadingçš„CPUä¸Šä½¿ç”¨å¤šçº¿ç¨‹ç¨‹åºè®¾è®¡çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§ï¼Œå³æé«˜äº†ç¨‹åºçš„æ‰§è¡Œååç‡ã€‚åœ¨å•CPUå•æ ¸çš„è®¡ç®—æœºä¸Šï¼Œä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ï¼Œä¹Ÿå¯ä»¥æŠŠè¿›ç¨‹ä¸­è´Ÿè´£I/Oå¤„ç†ã€äººæœºäº¤äº’è€Œå¸¸è¢«é˜»å¡çš„éƒ¨åˆ†ä¸å¯†é›†è®¡ç®—çš„éƒ¨åˆ†åˆ†å¼€æ¥æ‰§è¡Œï¼Œç¼–å†™ä¸“é—¨çš„workhorseçº¿ç¨‹æ‰§è¡Œå¯†é›†è®¡ç®—ï¼Œä»è€Œæé«˜äº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</p></blockquote><h1 id="Qtä¸­çš„çº¿ç¨‹"><a href="#Qtä¸­çš„çº¿ç¨‹" class="headerlink" title="Qtä¸­çš„çº¿ç¨‹"></a>Qtä¸­çš„çº¿ç¨‹</h1><p>Qtä¸­çš„çº¿ç¨‹ç±»æ˜¯QThreadã€‚</p><p>ä¸€ä¸ªQThreadå¯¹è±¡ç®¡ç†ç¨‹åºä¸­çš„ä¸€ä¸ªæ§åˆ¶çº¿ç¨‹ã€‚QThreadså¼€å§‹åœ¨run()ä¸­æ‰§è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œrun()é€šè¿‡è°ƒç”¨exec()å¯åŠ¨äº‹ä»¶å¾ªç¯ï¼Œå¹¶åœ¨çº¿ç¨‹å†…éƒ¨è¿è¡ŒQtäº‹ä»¶å¾ªç¯ã€‚</p><p>è·ŸC++æ ‡å‡†åº“ä¸­çš„threadä¸ä¸€æ ·ï¼ŒQtä¸­çš„QThreadæ˜¯é»˜è®¤è‡ªå¸¦ä¸€ä¸ªäº‹ä»¶å¾ªç¯çš„ã€‚ä¹Ÿå°±æ˜¯ä½ å¯ä»¥é€šè¿‡ä¿¡å·æ§½æ¥è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼ˆè¿™æ ·å°±ä¸éœ€è¦å†™å„ç§å›è°ƒå‡½æ•°äº†ï¼‰ã€‚è¿™å¤§å¤§çš„ç®€ä¾¿äº†çº¿ç¨‹é€šä¿¡çš„å¤æ‚é€»è¾‘ã€‚</p><h1 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h1><p>å…ˆä¸Šä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œå¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œçº¿ç¨‹ä¸­è¾“å‡ºä»1-1000,ç»“æŸä¹‹åå‘é€ä¿¡å·workfinished</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">WorkerThread</span> <span class="token operator">:</span> <span class="token keyword">public</span> QThread<span class="token punctuation">{</span>    Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">WorkerThread</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token operator">:</span> <span class="token function">QThread</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>    <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token keyword">protected</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        emit <span class="token function">workFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>signals<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">workFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>MainWindow<span class="token operator">::</span><span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span>    <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>    <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token operator">::</span>MainWindow<span class="token punctuation">)</span><span class="token punctuation">{</span>    ui<span class="token operator">-</span><span class="token operator">></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    WorkerThread<span class="token operator">*</span> workThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">WorkerThread</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-</span><span class="token operator">></span>pushButton<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QPushButton<span class="token operator">::</span>clicked<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        workThread<span class="token operator">-</span><span class="token operator">></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>workThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>WorkerThread<span class="token operator">::</span>workFinished<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"workfinished"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œçº¿ç¨‹å¯åŠ¨ã€‚ç»“æŸä¹‹åå‘é€ä¸€ä¸ªä¿¡å·å‡ºæ¥ã€‚</p><p>å®˜æ–¹å·²ç»ä¸æ¨èè¿™ç§å†™æ³•ï¼Œè¿™ç§å†™æ³•åªæœ‰run()å‡½æ•°æ‰ä¼šåœ¨æ–°çš„çº¿ç¨‹ä¸­ã€‚è‡ªå·±çº¿ç¨‹å‘çš„ä¿¡å·æ§½å¦‚æœä¸æ³¨æ„çš„è¯ï¼Œçº¿ç¨‹çš„æ§½å‡½æ•°ä¹Ÿä¸ä¼šå“åº”çš„ã€‚</p><p>ä¸‹é¢ä»‹ç»æ–°çš„å†™æ³•ï¼Œé‡å†™QObjectï¼Œmoveåˆ°æ–°çš„çº¿ç¨‹ä¸­ã€‚</p><p>æ ·ä¾‹ä»£ç  </p><p><a href="https://github.com/CryFeiFei/Qt_Teach/tree/master/Qt_Teach/Thread1" target="_blank" rel="noopener" title="https://github.com/CryFeiFei/Qt_Teach/tree/master/Qt_Teach/Thread1">https://github.com/CryFeiFei/Qt_Teach/tree/master/Qt_Teach/Thread1</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Qtå¤šçº¿ç¨‹ </tag>
            
            <tag> QtåŸºç¡€æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QtåŸºç¡€æ•™ç¨‹</title>
      <link href="/2020/05/30/qt-ji-chu-jiao-cheng/"/>
      <url>/2020/05/30/qt-ji-chu-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç£•ç£•ç»Šç»Šï¼Œè‡ªå·±ä¹Ÿå­¦Qtå¾ˆä¹…äº†ã€‚æœ¬æ„æƒ³å¼„ä¸ªè§†é¢‘æ•™ç¨‹æ¥æ•™å¤§å®¶å¦‚ä½•å…¥é—¨Qtï¼Œç„¶åè‡ªå·±è¿˜æ˜¯æ‡’ç™ŒçŠ¯äº†ï¼Œæˆ‘è¿˜æ˜¯å–œæ¬¢è®²è§£Qtçš„æºç ã€‚</p><p>ç›®å‰Qtçš„åŸºç¡€æ•™ç¨‹è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œä½†æ˜¯è´¨é‡å ªå¿§ã€‚åˆšå…¥é—¨æ—¶æˆ‘çœ‹çš„æ—¶è±†å­å›çš„å­¦ä¹ ä¹‹è·¯ï¼Œç„¶åè¿˜æ˜¯å­¦åˆ°äº†ä¸å°‘çš„ä¸œè¥¿ï¼Œä¹Ÿæ…¢æ…¢çš„å¯¹Qtæœ‰äº†è‡ªå·±çš„çœ‹æ³•ã€‚å›å¤´çœ‹è±†å­å›çš„æ•™ç¨‹è¿˜æ˜¯æœ‰ä¸€äº›å¯ä»¥è¡¥å……çš„ã€‚</p><p>è¿™æ¬¡æQtçš„åŸºç¡€æ•™ç¨‹ï¼Œæˆ‘å‡†å¤‡æŠŠæˆ‘è®¤ä¸ºè¯¥è¡¥å……çš„æ–‡ç« ç»“åˆè±†å­å¤§ä½¬çš„æ•™ç¨‹æä¸€ä»½æ–°çš„æ•™ç¨‹å‡ºæ¥ã€‚ç»™è±†å­å›å‘é‚®ä»¶ä¹Ÿå·²ç»å¾—åˆ°äº†ä»–çš„å…è®¸ã€‚<a href="https://www.cryfeifei.cn/532.html" target="_blank" rel="noopener" title="å¾€æ¥é‚®ä»¶">å¾€æ¥é‚®ä»¶</a></p><p>è¿˜æœ‰äºŒä¸‰é‡Œçš„æ•™ç¨‹-Qtä¸€äºŒä¸‰ï¼Œæˆ‘çœ‹å·²ç»åœæ›´äº†ï¼Œæˆ‘ä¹Ÿå‡†å¤‡æŠŠä»–çš„åœæ›´çš„æ–‡ç« ä»¥åŠæ¨¡å—è¡¥å……ä¸€äº›ã€‚ï¼ˆçœ‹æ¥é«˜çº§éƒ¨åˆ†å·²ç»æ”¶è´¹äº†</p><p>ç›®å‰åŸºæœ¬å°±æ˜¯è¿™æ ·çš„æƒ³æ³•ã€‚å‡†å¤‡æ•´ç†ä¸€ä»½æ–°çš„QtåŸºç¡€æ•™ç¨‹ã€‚</p><p>æˆ‘ä¼šä¸€ç‚¹ç‚¹æ•´ç†å‡ºæ¥çš„ã€‚</p><h1 id="Qt-åŸºæœ¬æ¦‚å¿µ"><a href="#Qt-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="Qt åŸºæœ¬æ¦‚å¿µ"></a>Qt åŸºæœ¬æ¦‚å¿µ</h1><ul><li><a href="https://www.cryfeifei.top/2020/06/29/qt-de-ji-ben-gai-nian-wiki/" target="_blank" rel="noopener" title="Qtçš„åŸºæœ¬æ¦‚å¿µ-WIKI">Qtçš„åŸºæœ¬æ¦‚å¿µ-WIKI</a></li></ul><p>å¼•è¯»</p><blockquote><p><a href="https://www.cryfeifei.top/2020/06/28/qt-jian-jie/" target="_blank" rel="noopener" title="Qtç®€ä»‹">Qtç®€ä»‹</a><br><a href="https://www.cryfeifei.top/2020/06/28/guan-yu-qt-de-li-shi/" target="_blank" rel="noopener" title="å…³äºQtçš„å†å²">å…³äºQtçš„å†å²</a><br><a href="https://cryfeifei.top/2020/06/28/mfc-wtl-wpf-wxwidgets-qt-gtk-ge-you-shi-me-te-dian/" title="å§šå†¬å¯¹Qtçš„çœ‹æ³•">å§šå†¬å¯¹Qtçš„çœ‹æ³•</a></p></blockquote><h1 id="å¼€å‘ç¯å¢ƒçš„æ­å»º"><a href="#å¼€å‘ç¯å¢ƒçš„æ­å»º" class="headerlink" title="å¼€å‘ç¯å¢ƒçš„æ­å»º"></a>å¼€å‘ç¯å¢ƒçš„æ­å»º</h1><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><ul><li><a href="https://www.cryfeifei.top/2020/06/28/qt-compile-windows/" target="_blank" rel="noopener" title="Windowsä¸‹VS2019ç¼–è¯‘Qt5.13.2æºç ">Windowsä¸‹VS2019ç¼–è¯‘Qt5.13.2æºç </a></li></ul><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><ul><li><a href="https://www.cryfeifei.top/2020/06/29/qt-linux-lazy/" target="_blank" rel="noopener" title="Linuxæ­å»ºQt5.14å¼€å‘ç¯å¢ƒ">Linuxæ­å»ºQt5.14å¼€å‘ç¯å¢ƒ-å‚»ç“œå¼</a>;</li><li><a href="https://www.cryfeifei.top/2020/06/28/qt-compile-linux/" target="_blank" rel="noopener" title="Linuxæ­å»ºQt5.14å¼€å‘ç¯å¢ƒ-æºç ç¼–è¯‘">Linuxæ­å»ºQt5.14å¼€å‘ç¯å¢ƒ-æºç ç¼–è¯‘</a></li></ul><h1 id="Qt-æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ"><a href="#Qt-æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ" class="headerlink" title="Qt æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ"></a>Qt æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ</h1><ul><li><p><a href="https://www.cryfeifei.top/2020/06/27/shen-ru-liao-jie-qt-xiao-xi-xun-huan-ji-xian-cheng-xiang-guan-xing/" target="_blank" rel="noopener" title="æ·±å…¥äº†è§£QTæ¶ˆæ¯å¾ªç¯åŠçº¿ç¨‹ç›¸å…³æ€§_Windows">æ·±å…¥äº†è§£QTæ¶ˆæ¯å¾ªç¯åŠçº¿ç¨‹ç›¸å…³æ€§_Windows</a></p></li><li><p><a href="https://www.cryfeifei.top/2020/06/27/qt-yuan-dui-xiang-meta-object-xi-tong/" target="_blank" rel="noopener" title="Qtå…ƒå¯¹è±¡ç³»ç»Ÿ">Qtå…ƒå¯¹è±¡ç³»ç»Ÿ</a></p></li></ul><h1 id="Qt-å®¹å™¨ç±»"><a href="#Qt-å®¹å™¨ç±»" class="headerlink" title="Qt å®¹å™¨ç±»"></a>Qt å®¹å™¨ç±»</h1><h1 id="Qt-MVC"><a href="#Qt-MVC" class="headerlink" title="Qt MVC"></a>Qt MVC</h1><h1 id="Qt-Widget"><a href="#Qt-Widget" class="headerlink" title="Qt Widget"></a>Qt Widget</h1><h1 id="Qt-Core"><a href="#Qt-Core" class="headerlink" title="Qt Core"></a>Qt Core</h1><h1 id="Qtå¤šçº¿ç¨‹"><a href="#Qtå¤šçº¿ç¨‹" class="headerlink" title="Qtå¤šçº¿ç¨‹"></a>Qtå¤šçº¿ç¨‹</h1><h1 id="Qtç½‘ç»œ"><a href="#Qtç½‘ç»œ" class="headerlink" title="Qtç½‘ç»œ"></a>Qtç½‘ç»œ</h1><h1 id="Qtæ‰“å°"><a href="#Qtæ‰“å°" class="headerlink" title="Qtæ‰“å°"></a>Qtæ‰“å°</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Qtä¸»ç•Œé¢å¡æ­»çš„è§£å†³æ–¹æ¡ˆ-ä¸€äº›å…·ä½“å®ç°æ–¹å¼</title>
      <link href="/2020/05/28/qt-zhu-jie-mian-qia-si-de-jie-jue-fang-an-yi-xie-ju-ti-shi-xian-fang-shi/"/>
      <url>/2020/05/28/qt-zhu-jie-mian-qia-si-de-jie-jue-fang-an-yi-xie-ju-ti-shi-xian-fang-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æˆ‘ä»¬åœ¨å†™UIæ–‡ä»¶çš„æ—¶å€™ï¼Œæœ‰å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ˜¯éœ€è¦ç•Œé¢æ¥å¤„ç†ä¸šåŠ¡ä¸­æŸäº›è€—æ—¶çš„æ“ä½œï¼Œè¿™æ—¶å€™å¦‚æœä¸å¤„ç†å¥½ç•Œé¢ç›¸å…³çš„é€»è¾‘çš„è¯ï¼Œä¸»ç•Œé¢å°±ä¼šå¡æ­»ï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¸Šå¤šçº¿ç¨‹äº†</p><h2 id="é€»è¾‘1"><a href="#é€»è¾‘1" class="headerlink" title="é€»è¾‘1"></a>é€»è¾‘1</h2><p>é¦–å…ˆä¸Šä¸šåŠ¡ä¸Šä¸€ä¸ªå¾ˆç®€å•çš„æ —å­</p><p>æ¯”å¦‚æˆ‘ä»¬çš„ä»£ç ä¸­æœ‰è¿™ä¹ˆä¸€ä¸ªè€—æ—¶çš„æ“ä½œ</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token comment" spellcheck="true">// ç¬¬ä¸€ç§è€—æ—¶çš„æ“ä½œ</span>    <span class="token keyword">auto</span> fWhile1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>æŠŠè¿™ä¸ªä»£ç ç»‘å®šåˆ°ä¸€ä¸ªæŒ‰é’®äº‹ä»¶ä¸Š</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-</span><span class="token operator">></span>pushButton1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QPushButton<span class="token operator">::</span>clicked<span class="token punctuation">,</span> fWhile1<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç„¶åç‚¹å‡»ã€‚å‘ç°ç•Œé¢å¡æ­»äº†ï¼Œå¾ˆæ­£å¸¸ï¼Œå¿…é¡»å¾—ç­‰åˆ°è¿™æ®µä»£ç è€—æ—¶å®Œæˆä¹‹åæ‰èƒ½ç»§ç»­æ“ä½œç•Œé¢ï¼Œè¿™æ®µä»£ç æ˜¯å¤ªä¸å‹å¥½äº†ï¼Œä¸æ¸…çœŸï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ”¹ä¸€ä¸‹ã€‚</p><hr><h2 id="é€»è¾‘2"><a href="#é€»è¾‘2" class="headerlink" title="é€»è¾‘2"></a>é€»è¾‘2</h2><p>å¦‚ä½•æ”¹åŠ¨ï¼Œå¯ä»¥çœ‹ä¸‹è¿™ä¸ªå‡½æ•°</p><pre class=" language-cpp"><code class="language-cpp">QCoreApplication<span class="token operator">::</span>processEvents</code></pre><p>æ¥ä¸€èµ·çœ‹ä¸‹å®˜ç½‘ä»‹ç»</p><blockquote><p>Processes all pending events for the calling thread according to the specified flags until there are no more events to process.<br>You can call this function occasionally when your program is busy performing a long operation (e.g. copying a file).<br>In the event that you are running a local loop which calls this function continuously, without an event loop, the DeferredDelete events will not be processed. This can affect the behaviour of widgets, e.g. QToolTip, that rely on DeferredDelete events to function properly. An alternative would be to call sendPostedEvents() from within that local loop.<br>Calling this function processes events only for the calling thread.<br>Note: This function is thread-safe.</p></blockquote><ul><li>You can call this function occasionally when your program is busy performing a long operation (e.g. copying a file).</li><li>å½“ç¨‹åºå¿™äºæ‰§è¡Œé•¿æ—¶é—´æ“ä½œï¼ˆä¾‹å¦‚å¤åˆ¶æ–‡ä»¶ï¼‰æ—¶ï¼Œæ‚¨å¯ä»¥å¶å°”è°ƒç”¨æ­¤åŠŸèƒ½ã€‚</li></ul><p>æˆ‘ä»¬å°±æš‚æ—¶å°±è¿™ä¸ªï¼ˆæ»‘ç¨½ã€‚<br>æ¥ä¸‹æ¥å¯ä»¥æŠŠä»£ç ææˆè¿™ç§äº†ã€‚</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token keyword">auto</span> fWhile2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>            QApplication<span class="token operator">::</span><span class="token function">processEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-</span><span class="token operator">></span>pushButton2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QPushButton<span class="token operator">::</span>clicked<span class="token punctuation">,</span> fWhile2<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™ç§ä»£ç åœ¨é…ç½®ä¸å¥½çš„æœºå™¨ä¸Šå®é™…ä¸Šè¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘çš„å°ç ´æœ¬å­ã€‚è¿˜æ˜¯ä¼šæœ‰ç‚¹å¡çš„ã€‚æˆ‘è§‰å¾—ç”¨æˆ·ä¸€èˆ¬æ˜¯å¯ä»¥æ¥å—è¿™ç§æƒ…å†µçš„ã€‚</p><hr><h2 id="é€»è¾‘3"><a href="#é€»è¾‘3" class="headerlink" title="é€»è¾‘3"></a>é€»è¾‘3</h2><p>å®é™…ä¸Šè¿™ä¸ªé€»è¾‘è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœæˆ‘çš„ä¸šåŠ¡ä»£ç ä¸æ˜¯å¾ªç¯è¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨æ–°çš„ç±»æ¥å£</p><pre class=" language-cpp"><code class="language-cpp">QtConcurrent<span class="token operator">::</span>run</code></pre><p>è¿™ä¸ªç±»ã€‚è¿™ä¸ªç±»æ˜¯å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°æ”¾åˆ°æ–°çš„çº¿ç¨‹é‡Œæ¥æ‰§è¡Œã€‚å†åŠ ä¸Š</p><pre class=" language-cpp"><code class="language-cpp">QFuture<span class="token operator">&lt;</span>T<span class="token operator">></span></code></pre><p>è¿™ä¸ªç±»ï¼Œå¯ä»¥æ§åˆ¶è¿™ä¸ªæ–°çš„çº¿ç¨‹å‡½æ•°å¼€å§‹ï¼Œæ§åˆ¶ï¼Œç»“æŸã€‚<br>å…·ä½“å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘è¿™é‡Œå°±ä¸Šä¸ªç®€å•çš„æ —å­</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//è€—æ—¶çš„æ“ä½œ</span><span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">function_needmoretime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// three</span>    <span class="token keyword">auto</span> fWhile3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">void</span>    <span class="token punctuation">{</span>        QFuture<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> future <span class="token operator">=</span> QtConcurrent<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span>function_needmoretime<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>future<span class="token punctuation">.</span><span class="token function">isFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            QApplication<span class="token operator">::</span><span class="token function">processEvents</span><span class="token punctuation">(</span>QEventLoop<span class="token operator">::</span>AllEvents<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-</span><span class="token operator">></span>pushButton3<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QPushButton<span class="token operator">::</span>clicked<span class="token punctuation">,</span> fWhile3<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>QFuture + QtConcurrentè¿™ä¸ªæ¡†æ¶éå¸¸å¼ºå¤§ï¼Œå¯ä»¥å°†çº¿ç¨‹åŒæ­¥å¼‚æ­¥çŠ¶æ€æŠ½è±¡å‡ºæ¥ï¼Œè®©ç¨‹åºå‘˜ä¸ç”¨å¤ªå…³å¿ƒè¿™äº›ã€‚è¿™åªæ˜¯ä¸€ä¸ªæœ€ç®€å•çš„æ —å­ã€‚æˆ‘çš„å°ç ´æœ¬å­æ¥è¿è¡Œè¿™ä¸ªæ˜¯ä¸€ç‚¹éƒ½ä¸å¡çš„ã€‚ç•Œé¢ä¾æ—§å¦‚ä¸æ»‘èˆ¬æµç•…ã€‚</p><hr><h2 id="é€»è¾‘4-çº¿ç¨‹"><a href="#é€»è¾‘4-çº¿ç¨‹" class="headerlink" title="é€»è¾‘4-çº¿ç¨‹"></a>é€»è¾‘4-çº¿ç¨‹</h2><p>çº¿ç¨‹åŸºç¡€é‚£ç§åºŸè¯æˆ‘å°±ä¸å¤šè¯´äº†ã€‚é“ç†å¤§å®¶éƒ½æ‡‚ï¼Œæˆ‘ç›´æ¥ä¸Šwikiã€‚</p><blockquote><p>çº¿ç¨‹ï¼ˆè‹±è¯­ï¼šthreadï¼‰æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚å®ƒè¢«åŒ…å«åœ¨è¿›ç¨‹ä¹‹ä¸­ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€æ¡çº¿ç¨‹æŒ‡çš„æ˜¯è¿›ç¨‹ä¸­ä¸€ä¸ªå•ä¸€é¡ºåºçš„æ§åˆ¶æµï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥å¹¶å‘å¤šä¸ªçº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚åœ¨Unix System VåŠSunOSä¸­ä¹Ÿè¢«ç§°ä¸ºè½»é‡è¿›ç¨‹ï¼ˆlightweight processesï¼‰ï¼Œä½†è½»é‡è¿›ç¨‹æ›´å¤šæŒ‡å†…æ ¸çº¿ç¨‹ï¼ˆkernel threadï¼‰ï¼Œè€ŒæŠŠç”¨æˆ·çº¿ç¨‹ï¼ˆuser threadï¼‰ç§°ä¸ºçº¿ç¨‹ã€‚<br>çº¿ç¨‹æ˜¯ç‹¬ç«‹è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹å¯ä»¥ä¸ºæ“ä½œç³»ç»Ÿå†…æ ¸è°ƒåº¦çš„å†…æ ¸çº¿ç¨‹ï¼Œå¦‚Win32çº¿ç¨‹ï¼›ç”±ç”¨æˆ·è¿›ç¨‹è‡ªè¡Œè°ƒåº¦çš„ç”¨æˆ·çº¿ç¨‹ï¼Œå¦‚Linuxå¹³å°çš„POSIX Threadï¼›æˆ–è€…ç”±å†…æ ¸ä¸ç”¨æˆ·è¿›ç¨‹ï¼Œå¦‚Windows 7çš„çº¿ç¨‹ï¼Œè¿›è¡Œæ··åˆè°ƒåº¦ã€‚<br>åŒä¸€è¿›ç¨‹ä¸­çš„å¤šæ¡çº¿ç¨‹å°†å…±äº«è¯¥è¿›ç¨‹ä¸­çš„å…¨éƒ¨ç³»ç»Ÿèµ„æºï¼Œå¦‚è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ–‡ä»¶æè¿°ç¬¦å’Œä¿¡å·å¤„ç†ç­‰ç­‰ã€‚ä½†åŒä¸€è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹æœ‰å„è‡ªçš„è°ƒç”¨æ ˆï¼ˆcall stackï¼‰ï¼Œè‡ªå·±çš„å¯„å­˜å™¨ç¯å¢ƒï¼ˆregister contextï¼‰ï¼Œè‡ªå·±çš„çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆthread-local storageï¼‰ã€‚<br>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¾ˆå¤šçº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚<br>åœ¨å¤šæ ¸æˆ–å¤šCPUï¼Œæˆ–æ”¯æŒHyper-threadingçš„CPUä¸Šä½¿ç”¨å¤šçº¿ç¨‹ç¨‹åºè®¾è®¡çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§ï¼Œå³æé«˜äº†ç¨‹åºçš„æ‰§è¡Œååç‡ã€‚åœ¨å•CPUå•æ ¸çš„è®¡ç®—æœºä¸Šï¼Œä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ï¼Œä¹Ÿå¯ä»¥æŠŠè¿›ç¨‹ä¸­è´Ÿè´£I/Oå¤„ç†ã€äººæœºäº¤äº’è€Œå¸¸è¢«é˜»å¡çš„éƒ¨åˆ†ä¸å¯†é›†è®¡ç®—çš„éƒ¨åˆ†åˆ†å¼€æ¥æ‰§è¡Œï¼Œç¼–å†™ä¸“é—¨çš„workhorseçº¿ç¨‹æ‰§è¡Œå¯†é›†è®¡ç®—ï¼Œä»è€Œæé«˜äº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚ </p></blockquote><p>çº¿ç¨‹çš„åˆ›å»ºæœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯ç»§æ‰¿QThreadçš„æ–¹å¼ï¼Œç„¶åé‡å†™runï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å®˜æ–¹å·²ç»ä¸æ¨èäº†ã€‚å®˜æ–¹ä¸æ¨èçš„æˆ‘ä»¬å°±ä¸è¦è¿™æ ·å†™äº†ï¼Œæˆ‘ä»¬è¿™é‡Œè®¨è®ºçš„æ˜¯ç¬¬äºŒç§æ–¹å¼ã€‚</p><p>ç»§æ‰¿QObject ï¼Œmoveåˆ°æ–°çš„çº¿ç¨‹ä¸­ã€‚</p><h3 id="é‡å†™-QObject"><a href="#é‡å†™-QObject" class="headerlink" title="é‡å†™ QObject"></a>é‡å†™ QObject</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// å¤´æ–‡ä»¶</span><span class="token keyword">class</span> <span class="token class-name">workThread</span> <span class="token operator">:</span> <span class="token keyword">public</span> QObject<span class="token punctuation">{</span>    Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">workThread</span><span class="token punctuation">(</span>QObject<span class="token operator">*</span> parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">workThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> slots<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">start1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>signals<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">workFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">workStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//cpp</span>workThread<span class="token operator">::</span><span class="token function">workThread</span><span class="token punctuation">(</span>QObject<span class="token operator">*</span> parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QObject</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>workThread<span class="token operator">::</span><span class="token operator">~</span><span class="token function">workThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">void</span> workThread<span class="token operator">::</span><span class="token function">start1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    emit <span class="token function">workStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> workThread<span class="token operator">::</span><span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    emit <span class="token function">workFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ä½¿ç”¨æ–¹æ³•</p><pre class=" language-cpp"><code class="language-cpp">    QThread<span class="token operator">*</span> m_workerThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    workThread<span class="token operator">*</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">workThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    worker<span class="token operator">-</span><span class="token operator">></span><span class="token function">moveToThread</span><span class="token punctuation">(</span>m_workerThread<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>m_workerThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>started<span class="token punctuation">,</span> worker<span class="token punctuation">,</span> <span class="token operator">&amp;</span>workThread<span class="token operator">::</span>start1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> <span class="token operator">&amp;</span>workThread<span class="token operator">::</span>workFinished<span class="token punctuation">,</span> m_workerThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>quit<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>m_workerThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>finished<span class="token punctuation">,</span> m_workerThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>deleteLater<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ä¹Ÿå¯ä»¥é€€å‡ºé‡Šæ”¾èµ„æº</span><span class="token comment" spellcheck="true">//    connect(qApp, &amp;QApplication::aboutToQuit, worker, &amp;QObject::deleteLater);</span><span class="token comment" spellcheck="true">//    connect(worker, &amp;QObject::destroyed, m_workerThread, &amp;QThread::quit);</span><span class="token comment" spellcheck="true">//    connect(m_workerThread, &amp;QThread::finished, m_workerThread, &amp;QThread::deleteLater);</span></code></pre><p>æ€»ç»“ä¸‹è¿™æ ·çš„æ“ä½œç•Œé¢æ˜¯ä¸€ç‚¹éƒ½ä¸å¡çš„ï¼Œå› ä¸ºå»¶è¿Ÿçš„æ“ä½œæˆ‘ä»¬æ”¾åˆ°æ–°çš„çº¿ç¨‹ä¸­äº†ã€‚<br>å¦‚æœéœ€è¦ä¼ é€’æ•°æ®çš„è¯ï¼Œå¯ä»¥å°†æ•°æ®é€šè¿‡ä¿¡å·æ§½çš„æ–¹å¼ä¼ é€’ã€‚</p><ul><li>ä¹‹æ‰€ä»¥å®˜æ–¹ä¸æ¨èé‡å†™QThreadä¹Ÿæ˜¯å› ä¸ºæ— æ³•ä½¿ç”¨ä¿¡å·æ§½</li><li>æƒ³ç»§æ‰¿QThreadçš„è¯ä¹Ÿå¯ä»¥ï¼Œè¿™ä¸ªç»§æ‰¿QThreadçš„ç±»ä¹Ÿéœ€è¦moveToThreadï¼Œè¿™ç§åšæ³•ä¸æ¸…çœŸï¼Œæ‰€ä»¥ä¸å¸Œæœ›å¤§å®¶ç”¨ã€‚</li></ul><hr><h2 id="é€»è¾‘5-çº¿ç¨‹-å®šæ—¶å™¨"><a href="#é€»è¾‘5-çº¿ç¨‹-å®šæ—¶å™¨" class="headerlink" title="é€»è¾‘5 çº¿ç¨‹ + å®šæ—¶å™¨"></a>é€»è¾‘5 çº¿ç¨‹ + å®šæ—¶å™¨</h2><p>å®é™…ä¸Šï¼Œå°±æ˜¯é€»è¾‘4çš„è¿›é˜¶ç‰ˆæœ¬ï¼Œå†åŠ ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”ä¸¤ç§’è¾“å‡ºå½“å‰æ—¶é—´</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">TimerThread</span> <span class="token operator">:</span> <span class="token keyword">public</span> QObject<span class="token punctuation">{</span>    Q_OBJECT<span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">TimerThread</span><span class="token punctuation">(</span>QObject<span class="token operator">*</span> parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">TimerThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>signals<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">workStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">workFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">int</span> timerCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>TimerThread<span class="token operator">::</span><span class="token function">TimerThread</span><span class="token punctuation">(</span>QObject<span class="token operator">*</span> parent<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">QObject</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>TimerThread<span class="token operator">::</span><span class="token operator">~</span><span class="token function">TimerThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">void</span> TimerThread<span class="token operator">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    emit <span class="token function">workStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QTimer <span class="token operator">*</span>timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTimer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QTimer<span class="token operator">::</span>timeout<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>TimerThread<span class="token operator">::</span>doWork<span class="token punctuation">)</span><span class="token punctuation">;</span>    timer<span class="token operator">-</span><span class="token operator">></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> TimerThread<span class="token operator">::</span><span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    timerCount <span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>timerCount <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span>        emit <span class="token function">workFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>QTime<span class="token operator">::</span><span class="token function">currentTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ä¸šåŠ¡ä»£ç åœ¨è¿™é‡Œ</p><pre class=" language-cpp"><code class="language-cpp">    <span class="token keyword">auto</span> fTimerThreadStart <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">void</span>    <span class="token punctuation">{</span>        fiveThread<span class="token operator">-</span><span class="token operator">></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-</span><span class="token operator">></span>threadButton2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QPushButton<span class="token operator">::</span>clicked<span class="token punctuation">,</span> fTimerThreadStart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>fiveThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>started<span class="token punctuation">,</span> timerObject<span class="token punctuation">,</span> <span class="token operator">&amp;</span>TimerThread<span class="token operator">::</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>timerObject<span class="token punctuation">,</span> <span class="token operator">&amp;</span>TimerThread<span class="token operator">::</span>workFinished<span class="token punctuation">,</span> fiveThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>quit<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>fiveThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>finished<span class="token punctuation">,</span> fiveThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QThread<span class="token operator">::</span>deleteLater<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç•Œé¢ä¹Ÿæ˜¯ç°å¸¸ä¸æ»‘èˆ¬æµç•…çš„ã€‚å…·ä½“çš„ä¸šåŠ¡é€»è¾‘éœ€æ±‚å¯ä»¥å†æƒ³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2020/05/28/hello-world/"/>
      <url>/2020/05/28/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class=" language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class=" language-bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class=" language-bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class=" language-bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
